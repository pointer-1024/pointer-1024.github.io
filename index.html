<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 7.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-21天学通C-学习笔记" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/12/22/21%E5%A4%A9%E5%AD%A6%E9%80%9AC-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" class="article-date">
  <time class="dt-published" datetime="2024-12-22T11:50:21.000Z" itemprop="datePublished">2024-12-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/12/22/21%E5%A4%A9%E5%AD%A6%E9%80%9AC-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">21天学通C++学习笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <!-- toc -->

<h1 id="第一章"><a href="#第一章" class="headerlink" title="第一章"></a>第一章</h1><h2 id="1-6-作业"><a href="#1-6-作业" class="headerlink" title="1.6 作业"></a>1.6 作业</h2><p><strong>1.6.1 测试</strong></p>
<ol>
<li><p><strong>解释器和编译器有什么不同？</strong></p>
<p><strong>答</strong>：解释器是一种对代码（或字节码）进行解释并执行相应的工具；编译器将代码作为输入，并生成目标文件。就C++而言，编译和链接后，将得到一个可执行文件，处理器可直接执行它，而无需做进一步解释。</p>
</li>
<li><p><strong>链接器的作用是什么？</strong></p>
<p><strong>答</strong>：链接器的作用是将多个目标文件（<code>.o</code> 或 <code>.obj</code>）和库文件组合在一起，生成一个可执行文件或库。</p>
</li>
<li><p><strong>正常的开发周期包括哪些步骤？</strong></p>
<p><strong>答</strong>：</p>
<p><strong>需求分析</strong>：明确项目目标、用户需求和功能要求。<br>​<strong>系统设计</strong>：设计架构、模块和数据库结构。<br><strong>开发实现</strong>：编写代码，完成各功能模块。<br><strong>测试</strong>：进行单元测试、集成测试、功能测试等，确保质量。<br><strong>部署上线</strong>：将产品部署到目标环境并上线运行。<br><strong>维护与迭代</strong>：修复问题、优化功能、发布新版本。</p>
</li>
</ol>
<p><strong>1.6.2 练习</strong></p>
<ol>
<li><strong>阅读下面的程序，在不运行它的情况下猜测其功能</strong></li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> x = <span class="number">8</span>;</span><br><span class="line">    <span class="type">int</span> y = <span class="number">6</span>;</span><br><span class="line">    std::cout &lt;&lt; std::endl;</span><br><span class="line">    std::cout &lt;&lt; x - y &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x * y &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; x + y &lt;&lt; std::endl;</span><br><span class="line">    std::cout &lt;&lt; std::endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	**答:**输出x与y加、乘和减三个计算结果</p>
<ol start="2">
<li><strong>输入练习1中的程序，然后编译并链接它。它做什么？与您的猜测相符吗？</strong></li>
<li><strong>下面的程序存在什么样的错误？</strong></li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">include&lt;iostream&gt;</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Hello Buggy World \n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	<strong>答</strong>:没有在include前加上#</p>
<p>4.<strong>修复练习3中的程序的错误，重新编译、链接并运行它。它做什么？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Hello Buggy World \n&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;	</span><br></pre></td></tr></table></figure>

<p>​	<strong>答</strong>:输出Hello Buggy World\n</p>
<h1 id="第二章"><a href="#第二章" class="headerlink" title="第二章"></a>第二章</h1><h2 id="2-4-C-函数"><a href="#2-4-C-函数" class="headerlink" title="2.4 C++函数"></a>2.4 C++函数</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单2.4 声明、定义和调用函数，该函数演示了std::cout的功能</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">DemoConsoleOutput</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">DemoConsoleOutput</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">DemoConsoleOutput</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;This is a simple string literal&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Writing number five:&quot;</span> &lt;&lt; <span class="number">5</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Performing division 10 / 5= &quot;</span> &lt;&lt; <span class="number">10</span>/<span class="number">5</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Pi when approximated is 22 / 7 = &quot;</span> &lt;&lt; <span class="number">22</span> / <span class="number">7</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Pi is 22 / 7 = &quot;</span> &lt;&lt; <span class="number">22.0</span> / <span class="number">7</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单2.5 使用函数的返回值</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">DemoConsoleOutput</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">DemoConsoleOutput</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">DemoConsoleOutput</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;This is a simple string literal&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Writing number five:&quot;</span> &lt;&lt; <span class="number">5</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Performing division 10 / 5= &quot;</span> &lt;&lt; <span class="number">10</span>/<span class="number">5</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Pi when approximated is 22 / 7 = &quot;</span> &lt;&lt; <span class="number">22</span> / <span class="number">7</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Pi is 22 / 7 = &quot;</span> &lt;&lt; <span class="number">22.0</span> / <span class="number">7</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-5-使用std-cin和std-cout执行基本输入输出操作"><a href="#2-5-使用std-cin和std-cout执行基本输入输出操作" class="headerlink" title="2.5 使用std::cin和std::cout执行基本输入输出操作"></a>2.5 使用std::cin和std::cout执行基本输入输出操作</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单2.6 使用cin和cout显示用户的数字输入和文本输出</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> inputNumber;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter an integer:&quot;</span>;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; inputNumber;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter your name:&quot;</span>;</span><br><span class="line">	string inputName;</span><br><span class="line">	cin &gt;&gt; inputName;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; inputName &lt;&lt; <span class="string">&quot; entered &quot;</span> &lt;&lt; inputNumber &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-8作业"><a href="#2-8作业" class="headerlink" title="2.8作业"></a>2.8作业</h2><p><strong>2.8.1 测验</strong></p>
<ol>
<li><strong>声明Int main()有何问题？</strong></li>
</ol>
<p>​		<strong>答</strong>：1.Int不是数据类型关键字不能用作返回值 </p>
<pre><code>            2.main函数只能有一个，不能重载
</code></pre>
<ol start="2">
<li><p><strong>注释可以超过一行吗？</strong></p>
<p><strong>答</strong>：可以。使用&#x2F;**&#x2F;多行注释或使用预编译指令</p>
</li>
</ol>
<p><strong>2.8.2 练习</strong></p>
<ol>
<li><p><strong>查错：输入下面的程序并编译它。为什么不能通过编译？如何修复？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::Cout &lt;&lt; Is there a bug here<span class="string">&quot;;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：1.输出对象书写错误，应改为cout</p>
<p>​		2.字符串字面值常量的双引号不全，应改为“Is there a bug here”</p>
</li>
<li><p><strong>修复练习1中的错误，然后重新编译、链接并运行它。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    std::cout &lt;&lt; <span class="string">&quot;Is there a bug here&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>修改程序清单2.4，以演示减法和乘法</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">#include&lt;iostream&gt;</span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">int DemoConsoleOutput();</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	DemoConsoleOutput();</span><br><span class="line"></span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int DemoConsoleOutput()</span><br><span class="line">&#123;</span><br><span class="line">	cout &lt;&lt; &quot;This is a simple string literal&quot; &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; &quot;Writing number five:&quot; &lt;&lt; 5 &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; &quot;Performing subtraction 10 - 5= &quot; &lt;&lt; 10 - 5 &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; &quot;Pi when approximated is 22 * 7 = &quot; &lt;&lt; 22 * 7 &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; &quot;Pi is 22 * 7 = &quot; &lt;&lt; 22.0 * 7 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第三章"><a href="#第三章" class="headerlink" title="第三章"></a>第三章</h1><h2 id="3-1-什么是变量"><a href="#3-1-什么是变量" class="headerlink" title="3.1 什么是变量"></a>3.1 什么是变量</h2><p><strong>3.1.2声明和访问变量</strong></p>
<ol>
<li><p>变量的定义</p>
<ul>
<li>VariableType VariableName;</li>
<li>VariableType VariableName &#x3D; InitialValue;</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//3.1 程序清单使用变量存储数字及其相乘结果</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;This program will help you multiply tow numbers&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter the first number:&quot;</span>;</span><br><span class="line">	<span class="type">int</span> firstNumber;</span><br><span class="line">	cin &gt;&gt; firstNumber;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter the second number:&quot;</span>;</span><br><span class="line">	<span class="type">int</span> secondNumber;</span><br><span class="line">	cin &gt;&gt; secondNumber;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> multiplicationResult = firstNumber * secondNumber;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; firstNumber &lt;&lt; <span class="string">&quot; x &quot;</span> &lt;&lt; secondNumber &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; multiplicationResult &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3.1.5 全局变量</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单3.3 使用全局变量</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> firstNumber = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> secondNumber = <span class="number">0</span>;</span><br><span class="line"><span class="type">int</span> multiplicationResult = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MultiplyNumbers</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter the first number:&quot;</span>;</span><br><span class="line"></span><br><span class="line">	cin &gt;&gt; firstNumber;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter the second number:&quot;</span>;</span><br><span class="line">	cin &gt;&gt; secondNumber;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; firstNumber &lt;&lt; <span class="string">&quot; x &quot;</span> &lt;&lt; secondNumber &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; multiplicationResult &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;This program will help you multiply tow numbers&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">MultiplyNumbers</span>();</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;DisplayNumbers()&quot;</span>;</span><br><span class="line">	cout &lt;&lt; firstNumber &lt;&lt; <span class="string">&quot; x &quot;</span> &lt;&lt; secondNumber &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; multiplicationResult &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3.1.6 命名约定</strong></p>
<ol>
<li>Pascal拼写法：每个单词首字母大写</li>
<li>驼峰拼写法：第一个单词的首字母小写，后面单词首字母大写</li>
<li>匈牙利表示法：在变量名开头包含指出变量类型的字符</li>
<li>下划线拼写法：每一个单词用下划线隔开</li>
</ol>
</li>
</ol>
<h2 id="3-2-编译器支持的常见C-变量类型"><a href="#3-2-编译器支持的常见C-变量类型" class="headerlink" title="3.2 编译器支持的常见C++变量类型"></a>3.2 编译器支持的常见C++变量类型</h2><p><strong>3.2.6 选择正确的数据类型以避免发生溢出错误</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单3.4 演示有符号整型变量和无符号中心变量溢出的负面影响</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">short</span> uShortValue = <span class="number">65535</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Incrememting unsigned short &quot;</span> &lt;&lt; uShortValue &lt;&lt; <span class="string">&quot;gives: &quot;</span>;</span><br><span class="line">	cout &lt;&lt; ++uShortValue &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">short</span> signedShort = <span class="number">32767</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Incrememting signed short &quot;</span> &lt;&lt; signedShort &lt;&lt; <span class="string">&quot;gives：&quot;</span>;</span><br><span class="line">	cout &lt;&lt; ++signedShort &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-3-使用sizeof确定变量长度"><a href="#3-3-使用sizeof确定变量长度" class="headerlink" title="3.3 使用sizeof确定变量长度"></a>3.3 使用sizeof确定变量长度</h2><p><strong>3.3.1 使用列表初始化避免缩窄转换错误</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> largeNum = <span class="number">5000000</span>;</span><br><span class="line"><span class="type">short</span> anotherNum&#123; largeNum &#125;; <span class="comment">//error! Amend types</span></span><br><span class="line"><span class="type">int</span> anoterNUm&#123; largeNum &#125;; <span class="comment">//OK</span></span><br><span class="line"><span class="type">float</span> someFloat&#123; largeNum &#125;; <span class="comment">//error! An int may be narrowed</span></span><br><span class="line"><span class="type">float</span> someFloat&#123; <span class="number">5000000</span> &#125;; <span class="comment">//OK! 5000000 can be accomodated</span></span><br></pre></td></tr></table></figure>

<h2 id="3-4使用auto自动推导类型"><a href="#3-4使用auto自动推导类型" class="headerlink" title="3.4使用auto自动推导类型"></a>3.4使用auto自动推导类型</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单3.6 使用关键字auto依靠编译器的类型推导功能</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">auto</span> coinFlippedHeads = <span class="literal">true</span>;</span><br><span class="line">	<span class="keyword">auto</span> largeNumber = <span class="number">2500000000000</span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;coinFlippedHeads = &quot;</span> &lt;&lt; coinFlippedHeads;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot; , sizeof(coinFlippedHeads) = &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(coinFlippedHeads) &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; <span class="built_in">typeid</span>(coinFlippedHeads).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;largeNumber = &quot;</span> &lt;&lt; largeNumber;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot; , sizeof(largeNumber) = &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(largeNumber) &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; <span class="built_in">typeid</span>(largeNumber).<span class="built_in">name</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="3-6-什么是常量"><a href="#3-6-什么是常量" class="headerlink" title="3.6 什么是常量"></a>3.6 什么是常量</h2><p><strong>c++中的常量</strong></p>
<ul>
<li>字面常量;</li>
<li>使用关键字const声明的常量;</li>
<li>使用关键字constexpr声明的常量表达式（C++11 新增的）;</li>
<li>使用关键字enum (class)声明的枚举常量;</li>
<li>使用#define定义的常量（不推荐）；</li>
</ul>
<p><strong>3.6.2 使用const将变量声明为常量</strong></p>
<p>​	通用的声明方法：const typeName constantName &#x3D; value;  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单3.7 声明一个名为pi的变量</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">double</span> pi = <span class="number">22.0</span> / <span class="number">7</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The value of constant pi is: &quot;</span> &lt;&lt; pi &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3.6.3 使用constexpr 定义常量表达式</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单3.8 使用常量表达式来计算pi的值</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> <span class="type">double</span> <span class="title">GetPi</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="number">22.0</span> / <span class="number">7</span>; &#125;</span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> <span class="type">double</span> <span class="title">TwicePi</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="number">2</span> * <span class="built_in">GetPi</span>(); &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">double</span> pi = <span class="number">22.0</span> / <span class="number">7</span>;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;constant pi contains value &quot;</span> &lt;&lt; pi &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;constexpr GetPi() returns value &quot;</span> &lt;&lt; <span class="built_in">GetPi</span>() &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;constexpr TwicePi() return value &quot;</span> &lt;&lt; <span class="built_in">TwicePi</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>3.6.4 枚举</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单3.9 使用枚举量指示基本方位</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">CardinalDirections</span></span><br><span class="line">&#123;</span><br><span class="line">	North = <span class="number">25</span>,</span><br><span class="line">	South,</span><br><span class="line">	West,</span><br><span class="line">	East,</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot; Displaying directions and their symbolic values&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;North: &quot;</span> &lt;&lt; North &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;South: &quot;</span> &lt;&lt; South &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;West: &quot;</span> &lt;&lt; West &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;East: &quot;</span> &lt;&lt; East &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	CardinalDirections windDirection = South;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Variable windDirection = &quot;</span> &lt;&lt; windDirection &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="作业"><a href="#作业" class="headerlink" title="作业"></a>作业</h2><p><strong>3.10.1 测验</strong></p>
<ol>
<li><p><strong>有符号整型和无符号整型有何不同?</strong></p>
<p><strong>答</strong>：它们在内存中的最高位表示不同，无符号的最高位表示数值，有符号的最高位表示符号位</p>
</li>
<li><p><strong>为何不应使用#define来声明常量？</strong></p>
<p><strong>答</strong>：#define定义的常量只是进行文本替换，不进行安全检查，这是不安全的。</p>
</li>
<li><p><strong>为何要对变量进行初始化？</strong></p>
<p><strong>答</strong>：初始化变量是一个良好的编程习惯，可以增强代码的<strong>可读性</strong>、<strong>可靠性</strong>和<strong>安全性</strong>，避免意外行为的发生。</p>
</li>
<li><p><strong>给定如下枚举类型，Quee的值是多少？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">YourCards</span> &#123;Ace, Jack, Queen, King&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：2</p>
</li>
<li><p><strong>下述变量名有何问题？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> Interger = <span class="number">0</span>;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：编译没有问题，但是变量名不能够正确表达意思。</p>
</li>
</ol>
<p><strong>3.10.2 练习</strong></p>
<ol>
<li><p><strong>修改测试题4中的枚举类型，让Queen的值为45</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">enum</span> <span class="title class_">YourCards</span> &#123;Ace, Jack, Queen = <span class="number">45</span>, King&#125;; <span class="comment">//方法一 0，1，45，46</span></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">YourCards</span> &#123;Ace = <span class="number">43</span>, Jack, Queen = <span class="number">45</span>, King&#125;; <span class="comment">//方法二 43，44，45，36</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写一个程序，证明unsigned int 和 int 变量的长度，且它们对比long变量短。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;unsigned int &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(<span class="type">unsigned</span> <span class="type">int</span>) &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;int &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(<span class="type">int</span>) &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;long &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(<span class="type">long</span>) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写一个程序，让用户输入圆的半径，并计算其面积和周长？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> pi = <span class="number">3.14</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter your radius:&quot;</span>;</span><br><span class="line">	<span class="type">double</span> radius = <span class="number">0.0</span>;</span><br><span class="line">	cin &gt;&gt; radius;</span><br><span class="line"></span><br><span class="line">	<span class="type">double</span> circumference = <span class="number">2</span> * radius * pi;</span><br><span class="line">	<span class="type">double</span> area = radius * radius * pi;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;circumference = &quot;</span> &lt;&lt; circumference &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;area = &quot;</span> &lt;&lt; area &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>在练习3中，如果将面积和周长存储在int中，输出将有何不同？</strong></p>
<p><strong>答</strong>：会损失小数的精度，输出一个整型</p>
</li>
<li><p><strong>查错：下面的语句有何错误？</strong></p>
<p><code>auto Integer</code></p>
</li>
</ol>
<p>​		<strong>答：</strong>Integer没有初值，auto无法进行推导</p>
<h1 id="第四章"><a href="#第四章" class="headerlink" title="第四章"></a>第四章</h1><h2 id="4-1-什么是数组"><a href="#4-1-什么是数组" class="headerlink" title="4.1 什么是数组"></a>4.1 什么是数组</h2><p><strong>数组具有一下特点</strong></p>
<ul>
<li>数组是一系列元素</li>
<li>数组中所有元素都是相同类型</li>
<li>这组元素形成一个完整的集合</li>
</ul>
<p><strong>4.1.2 声明和初始化静态数组</strong></p>
<p>​	数组声明如下</p>
<p>​	<code>ElementType ArrayName [constant_number of elements] = &#123;optional initial values&#125;;</code></p>
<p><strong>4.1.4 访问存储在数组中的数据</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 4.1 声明一个int数组并访问其元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> myNumbers[<span class="number">5</span>] = &#123; <span class="number">34</span>,<span class="number">56</span>,<span class="number">-21</span>,<span class="number">5002</span>,<span class="number">365</span> &#125;;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;First element at index 0:&quot;</span> &lt;&lt; myNumbers[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Second element at index 1:&quot;</span> &lt;&lt; myNumbers[<span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Third element at index 2:&quot;</span> &lt;&lt; myNumbers[<span class="number">2</span>] &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Fourth element at index 3:&quot;</span> &lt;&lt; myNumbers[<span class="number">3</span>] &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Fifth element at index 4:&quot;</span> &lt;&lt; myNumbers[<span class="number">4</span>] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>4.1.5 修改存储在数组中的数据</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 4.2 给元素赋值</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="function"><span class="keyword">constexpr</span> <span class="type">int</span> <span class="title">Square</span><span class="params">(<span class="type">int</span> number)</span> </span>&#123; <span class="keyword">return</span> number * number; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> ARRAY_LENGTH = <span class="number">5</span>;</span><br><span class="line">	<span class="type">int</span> myNumbers[ARRAY_LENGTH] = &#123; <span class="number">5</span>,<span class="number">10</span>,<span class="number">0</span>,<span class="number">-101</span>,<span class="number">20</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> moreNumbers[<span class="built_in">Square</span>(ARRAY_LENGTH)];</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter index of the element to be change:&quot;</span>;</span><br><span class="line">	<span class="type">int</span> elementIndex = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; elementIndex;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter new value&quot;</span>;</span><br><span class="line">	<span class="type">int</span> newValue;</span><br><span class="line">	cin &gt;&gt; newValue;</span><br><span class="line"></span><br><span class="line">	myNumbers[elementIndex] = newValue;</span><br><span class="line">	moreNumbers[elementIndex] = newValue;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Element &quot;</span> &lt;&lt; elementIndex &lt;&lt; <span class="string">&quot;in array myNumbers is: &quot;</span> &lt;&lt; myNumbers[elementIndex] &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Element &quot;</span> &lt;&lt; elementIndex &lt;&lt; <span class="string">&quot;in array moreNumbers is: &quot;</span> &lt;&lt; moreNumbers[elementIndex] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-2-多维数组"><a href="#4-2-多维数组" class="headerlink" title="4.2 多维数组"></a>4.2 多维数组</h2><p><strong>4.2.1 声明和初始化多维数组</strong></p>
<p>​	在C++中，要声明多维数组，可指定每维包含的元素数  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> solarPanels[<span class="number">2</span>][<span class="number">3</span>] = &#123;&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>&#125;,&#123;<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>4.2.2 访问多维数组中的元素</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 4.3 访问多维数组中的元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> threeRowsThreeColumns[<span class="number">3</span>][<span class="number">3</span>] = \</span><br><span class="line">	&#123;&#123;<span class="number">-501</span>, <span class="number">205</span>, <span class="number">2016</span>&#125;, &#123; <span class="number">989</span>,<span class="number">101</span>,<span class="number">206</span> &#125;, &#123;<span class="number">303</span>,<span class="number">456</span>,<span class="number">596</span>&#125;&#125;;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Row 0:&quot;</span> &lt;&lt; threeRowsThreeColumns[<span class="number">0</span>][<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &quot;</span>\</span><br><span class="line">		 &lt;&lt; threeRowsThreeColumns[<span class="number">0</span>][<span class="number">1</span>] &lt;&lt; <span class="string">&quot; &quot;</span>\</span><br><span class="line">		 &lt;&lt; threeRowsThreeColumns[<span class="number">0</span>][<span class="number">2</span>] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Row 1:&quot;</span> &lt;&lt; threeRowsThreeColumns[<span class="number">1</span>][<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &quot;</span>\</span><br><span class="line">		&lt;&lt; threeRowsThreeColumns[<span class="number">1</span>][<span class="number">1</span>] &lt;&lt; <span class="string">&quot; &quot;</span>\</span><br><span class="line">		&lt;&lt; threeRowsThreeColumns[<span class="number">1</span>][<span class="number">2</span>] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Row 2:&quot;</span> &lt;&lt; threeRowsThreeColumns[<span class="number">2</span>][<span class="number">0</span>] &lt;&lt; <span class="string">&quot; &quot;</span>\</span><br><span class="line">		&lt;&lt; threeRowsThreeColumns[<span class="number">2</span>][<span class="number">1</span>] &lt;&lt; <span class="string">&quot; &quot;</span>\</span><br><span class="line">		&lt;&lt; threeRowsThreeColumns[<span class="number">2</span>][<span class="number">2</span>] &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-3-动态数组"><a href="#4-3-动态数组" class="headerlink" title="4.3 动态数组"></a>4.3 动态数组</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 4.4 创建int动态数组并动态插入</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">dynArray</span><span class="params">(<span class="number">3</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	dynArray[<span class="number">0</span>] = <span class="number">365</span>;</span><br><span class="line">	dynArray[<span class="number">1</span>] = <span class="number">-421</span>;</span><br><span class="line">	dynArray[<span class="number">2</span>] = <span class="number">789</span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Number of integers in array: &quot;</span> &lt;&lt; dynArray.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter another element to insert&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="type">int</span> newValue = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; newValue;</span><br><span class="line">	dynArray.<span class="built_in">push_back</span>(newValue);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Number of integers in arry: &quot;</span> &lt;&lt; dynArray.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Last element in array: &quot;</span> &lt;&lt; dynArray[dynArray.<span class="built_in">size</span>() - <span class="number">1</span>] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-4-C风格字符串"><a href="#4-4-C风格字符串" class="headerlink" title="4.4 C风格字符串"></a>4.4 C风格字符串</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 4.5 分析C风格字符串中的终止空字符</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">char</span> sayHello[] = &#123;<span class="string">&#x27;H&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;w&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;r&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;d&#x27;</span>,<span class="string">&#x27;\0&#x27;</span>&#125;;</span><br><span class="line">	cout &lt;&lt; sayHello &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Size of array: &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(sayHello) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Replaceing space with null&quot;</span> &lt;&lt; endl;</span><br><span class="line">	sayHello[<span class="number">5</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Size of array: &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(sayHello) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-5-C-字符串：使用std-string"><a href="#4-5-C-字符串：使用std-string" class="headerlink" title="4.5 C++字符串：使用std::string"></a>4.5 C++字符串：使用std::string</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 4.7 使用std::string初始化字符串、存储用户输入、复制和拼接字符串以及字符串的长度</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">string <span class="title">greetString</span><span class="params">(<span class="string">&quot;Hello std::string!&quot;</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; greetString &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter a line of text: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	string firstLine;</span><br><span class="line">	<span class="built_in">getline</span>(cin, firstLine);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot; Enter another: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	string secondLine;</span><br><span class="line">	<span class="built_in">getline</span>(cin, secondLine);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Result of concatenation: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	string concatString = firstLine + <span class="string">&quot; &quot;</span> + secondLine;</span><br><span class="line">	cout &lt;&lt; concatString;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Copy of concatentated string: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	string aCopy;</span><br><span class="line">	aCopy = concatString;</span><br><span class="line">	cout &lt;&lt; aCopy &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Length of concatString: &quot;</span> &lt;&lt; concatString.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="4-8-作业"><a href="#4-8-作业" class="headerlink" title="4.8 作业"></a>4.8 作业</h2><p><strong>4.8.1 测验</strong></p>
<ol>
<li><p><strong>d对于程序清单4.1中的数组myNumbers,第一个和最后一个的索引元素分别是多少？</strong></p>
<p><strong>答</strong>：0和4</p>
</li>
<li><p><strong>如果需要让用户输入字符串，该使用C风格的字符串吗？</strong></p>
<p><strong>答</strong>：不推荐使用，应该使用std::string，以防止出现越界的情况</p>
</li>
<li><p><strong>在编译器看来，’\0’表示多少个字符？</strong></p>
<p><strong>答</strong>：1个</p>
</li>
<li><p><strong>如果忘记在C风格字符串末尾添加空字符，使用它的结果将会如何？</strong></p>
<p><strong>答</strong>：会出现字符串乱码</p>
</li>
<li><p><strong>根据程序清单4.4中的矢量的声明，尝试声明一个包含char元素的动态数组？</strong></p>
<p><strong>答</strong>：<code>vector&lt;char&gt; charArray;</code></p>
</li>
</ol>
<p><strong>4.8.2 练习</strong></p>
<ol>
<li><strong>声明一个国际象棋棋盘的数组；该数组的类型为枚举，该枚举定义了可能出现在棋盘方格中的棋子。</strong></li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Square</span></span><br><span class="line">&#123;</span><br><span class="line">	empty = <span class="number">0</span>,</span><br><span class="line">	Pawn,</span><br><span class="line">	Rook,</span><br><span class="line">	Knight,</span><br><span class="line">	Bishop,</span><br><span class="line">	King,</span><br><span class="line">	Queen</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Square chessBoard[<span class="number">8</span>][<span class="number">8</span>];</span><br><span class="line">	chessBoard[<span class="number">0</span>][<span class="number">0</span>] = chessBoard[<span class="number">0</span>][<span class="number">7</span>] = Rook;</span><br><span class="line">	chessBoard[<span class="number">7</span>][<span class="number">7</span>] = chessBoard[<span class="number">7</span>][<span class="number">0</span>] = Rook;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="2">
<li><strong>查错：下面的代码段有什么错误？</strong></li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> myNumbers[<span class="number">5</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">myNumbers[<span class="number">5</span>] = <span class="number">450</span>;</span><br></pre></td></tr></table></figure>

<p>​	<strong>答</strong>：越界操作</p>
<ol start="3">
<li><strong>查错：下面的代码段有什么错误？</strong></li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> myNumbers[<span class="number">5</span>];</span><br><span class="line">cout &lt;&lt; myNumbers[<span class="number">3</span>];</span><br></pre></td></tr></table></figure>

<p>​	<strong>答</strong>：访问了未初始化的内存</p>
<h1 id="第五章"><a href="#第五章" class="headerlink" title="第五章"></a>第五章</h1><h2 id="5-3-使用运算符"><a href="#5-3-使用运算符" class="headerlink" title="5.3 使用运算符"></a>5.3 使用运算符</h2><p>​	<strong>5.3.2 理解左值和右值</strong></p>
<ul>
<li>左值：通常是内存单元</li>
<li>右值：是内存单元的内容</li>
<li>所有左值可以用作右值，但并非所有右值都可以用作左值</li>
</ul>
<p>​	<strong>5.3.3 加法运算符、除法运算符、减法运算符、乘法运算符和取模运算符</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单5.1 演示如何对用户输入的整数执行算术运算</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter two integers: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="type">int</span> num1 = <span class="number">0</span>, num2 = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; num1;</span><br><span class="line">	cin &gt;&gt; num2;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; num1 &lt;&lt; <span class="string">&quot; + &quot;</span> &lt;&lt; num2 &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; num1 + num2 &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; num1 &lt;&lt; <span class="string">&quot; - &quot;</span> &lt;&lt; num2 &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; num1 - num2 &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; num1 &lt;&lt; <span class="string">&quot; * &quot;</span> &lt;&lt; num2 &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; num1 * num2 &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; num1 &lt;&lt; <span class="string">&quot; / &quot;</span> &lt;&lt; num2 &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; num1 / num2 &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; num1 &lt;&lt; <span class="string">&quot; % &quot;</span> &lt;&lt; num2 &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; num1 % num2 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>5.3.5 前缀还是后缀</strong></p>
<ul>
<li>前缀：先将右值递增或递减，再将结果赋给左值。</li>
<li>后缀：先将右值赋给左值，再将右值递减或递增</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单5.2 前缀运算符和后缀运算符之间的差别</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> startValue = <span class="number">101</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Sart value of integer being operated: &quot;</span> &lt;&lt; startValue &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> postfixIncrement = startValue++;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Result of Postfix Increment = &quot;</span> &lt;&lt; postfixIncrement &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;After Postfix Increment, startValue = &quot;</span> &lt;&lt; startValue &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	startValue = <span class="number">101</span>;</span><br><span class="line">	<span class="type">int</span> prefixIncrement = ++startValue;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Result of prefix Increment = &quot;</span> &lt;&lt; prefixIncrement &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;After prefix Increment, startValue = &quot;</span> &lt;&lt; startValue &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	startValue = <span class="number">101</span>;</span><br><span class="line">	<span class="type">int</span> postfixDecrement = startValue--;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Result of Postfix Decrement = &quot;</span> &lt;&lt; postfixDecrement &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;After Postfix Decrement, startValue = &quot;</span> &lt;&lt; startValue &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	startValue = <span class="number">101</span>;</span><br><span class="line">	<span class="type">int</span> prefixDecrement = --startValue;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Result of Postfix Decrement = &quot;</span> &lt;&lt; prefixDecrement &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;After prefix Decrement, startValue = &quot;</span> &lt;&lt; startValue &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="作业-1"><a href="#作业-1" class="headerlink" title="作业"></a>作业</h2><p><strong>5.6.1 测验</strong></p>
<ol>
<li><p><strong>编写将两个数相除的应用程序时，将变量声明为哪种数据类型更合适，int还是float？</strong></p>
<p><strong>答</strong>：float,防止精度丢失。</p>
</li>
<li><p><strong>32&#x2F;7的结果是多少？</strong></p>
<p><strong>答</strong>：4</p>
</li>
<li><p><strong>32.0&#x2F;7的结果是多少？</strong></p>
<p><strong>答</strong>：4.57143</p>
</li>
<li><p><strong>sizeof()是函数吗？</strong></p>
<p><strong>答</strong>：是关键字</p>
</li>
<li><p><strong>我需要将一个数翻倍，再加上5，然后在翻倍，下面的代码是否正确？</strong></p>
<p><code>int result = number &lt;&lt; 1 + 5 &lt;&lt; 1</code></p>
<p><strong>答</strong>：不正确</p>
</li>
<li><p><strong>如果两个操作数的值都为true,对其执行XOR的结果是什么?</strong></p>
<p><strong>答</strong>：false</p>
</li>
</ol>
<p><strong>5.6.2 练习</strong></p>
<ol>
<li><p><strong>使用括号改善测试题5中的代码，使其清晰</strong></p>
<p><strong>答</strong>：<code>int result = ((number &lt;&lt; 1) +  5) &lt;&lt; 1;</code></p>
</li>
<li><p><strong>下述代码导致result的值为多少？</strong></p>
<p><strong>答</strong>：<code>result &lt;&lt; 7</code></p>
</li>
<li><p><strong>编写一个程序，让用户输入两个布尔值，并显示其执行各种按位运算的结果。</strong></p>
</li>
</ol>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter your two bool value:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="type">bool</span> bit1 = <span class="literal">false</span>;</span><br><span class="line">	<span class="type">bool</span> bit2 = <span class="literal">false</span>;</span><br><span class="line">	cin &gt;&gt; bit1;</span><br><span class="line">	cin &gt;&gt; bit2;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;or: &quot;</span> &lt;&lt; (bit1 | bit2) &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;and: &quot;</span> &lt;&lt; (bit1 &amp; bit2) &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;xor: &quot;</span> &lt;&lt; (bit1 ^ bit2) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="第六章"><a href="#第六章" class="headerlink" title="第六章"></a>第六章</h1><h2 id="6-2-在循环中执行代码"><a href="#6-2-在循环中执行代码" class="headerlink" title="6.2 在循环中执行代码"></a>6.2 在循环中执行代码</h2><p><strong>6.2.5 基于范围的for循环</strong></p>
<p>​	for(VarType varName : sequence){</p>
<p>​			&#x2F;&#x2F;Use varName that contains an element from sequence</p>
<p>​	}</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单6.12 使用基于范围的for循环来处理数组和std::string</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> sumoNums[] = &#123; <span class="number">1</span>,<span class="number">101</span>,<span class="number">-1</span>,<span class="number">40</span>,<span class="number">2040</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">const</span> <span class="type">int</span>&amp; aNum : sumoNums) &#123;</span><br><span class="line">		cout &lt;&lt; aNum &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> anElement : &#123; <span class="number">5</span>,<span class="number">222</span>,<span class="number">110</span>,<span class="number">-45</span>,<span class="number">2017</span> &#125;) &#123;</span><br><span class="line">		cout &lt;&lt; anElement &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> charArray[] = &#123; <span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;o&#x27;</span> &#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> anElement : charArray) &#123;</span><br><span class="line">		cout &lt;&lt; anElement &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">double</span> moreNums[] = &#123; <span class="number">3.14</span>,<span class="number">-1.3</span>,<span class="number">22</span>,<span class="number">10101</span> &#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> anElement : moreNums) &#123;</span><br><span class="line">		cout &lt;&lt; anElement &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	string sayHello&#123; <span class="string">&quot;Hello world!&quot;</span> &#125;;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> anElement : sayHello) &#123;</span><br><span class="line">		cout &lt;&lt; anElement &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="6-7-作业"><a href="#6-7-作业" class="headerlink" title="6.7 作业"></a>6.7 作业</h2><hr>
<p><strong>6.7.1 测验</strong></p>
<ol>
<li><p><strong>既然不缩进也能通过编译，为什么要缩进语句块、嵌套if语句和嵌套循环？</strong></p>
<p><strong>答</strong>：缩进让代码结构更加清晰，便于阅读和理解</p>
</li>
<li><p><strong>使用goto可以快速解决问题，为何还要避免使用它？</strong></p>
<p><strong>答</strong>：goto会破坏程序的结构，容易引发逻辑错误</p>
</li>
<li><p><strong>可以编写计算器递减的for循环吗？这样的for循环是什么样的？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = value; i &gt; <span class="number">0</span>; i--)&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>下面的循环有何问题？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> counter = <span class="number">0</span>; counter == <span class="number">10</span>; ++counter)</span><br><span class="line">    cout &lt;&lt; counter &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>:判断条件存在问题，应该改为counter !&#x3D; 10</p>
</li>
</ol>
<p><strong>6.7.2 练习</strong></p>
<ol>
<li><p><strong>编写一个for循环,以倒叙的方式访问数组</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> ARRAY_LENGTH = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> arr[ARRAY_LENGTH] = &#123; <span class="number">0</span> ,<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = ARRAY_LENGTH - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">		cout &lt;&lt; arr[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>编写一个类似于程序清单6.14的嵌套for循环，但以倒序方式将一个数组的每个元素都与另一个数组的每个元素相加。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> ARRAY_LENGTH = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> arr1[ARRAY_LENGTH] = &#123; <span class="number">0</span> ,<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line">	<span class="type">int</span> arr2[ARRAY_LENGTH] = &#123; <span class="number">10</span>,<span class="number">20</span>,<span class="number">30</span>,<span class="number">40</span>,<span class="number">50</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = ARRAY_LENGTH - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; ARRAY_LENGTH; j++) &#123;</span><br><span class="line">			arr1[i] += arr2[j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ARRAY_LENGTH; i++) &#123;</span><br><span class="line">		cout &lt;&lt; arr1[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写一个程序，象清单6.16那样显示斐波那契数列，但让用户指定每次显示多少个</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Please enter the number of items to display per line.&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; num;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> n1 = <span class="number">0</span>, n2 = <span class="number">1</span>;</span><br><span class="line">	<span class="type">char</span> wantMore = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">	cout &lt;&lt; n1 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; n2 &lt;&lt; <span class="string">&quot; &quot;</span> &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">do</span>&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; num; i++) &#123;</span><br><span class="line">			cout &lt;&lt; n1 + n2 &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">			<span class="type">int</span> num2Temp = n2;</span><br><span class="line">			n2 = n1 + n2;</span><br><span class="line">			n1 = num2Temp;</span><br><span class="line">		&#125;</span><br><span class="line">		cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;Do you want more numbers(y/n)&quot;</span>;</span><br><span class="line">		cin &gt;&gt; wantMore;</span><br><span class="line">	&#125; <span class="keyword">while</span> (wantMore == <span class="string">&#x27;y&#x27;</span>);</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Goodbye&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写一个switch-case结构，指出用户选择的颜色是否出现在彩虹中。请使用枚举常量</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">Colors</span></span><br><span class="line">&#123;</span><br><span class="line">	Violet,Indigo,Blue,Green,Yellow,Orange,Red,Crimson,Beige,Brown,Peach,Pink,White</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Here are the available colors: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Violet,Indigo,Blue,Green,Yellow,Orange,Red,Crimson,Beige,Brown,Peach,Pink,White&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Corresponding to the numbers 0 to 12.&quot;</span> &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Choose one by entering  code: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> yourChoice = Blue;</span><br><span class="line">	cin &gt;&gt; yourChoice;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">switch</span> (yourChoice)</span><br><span class="line">	&#123;</span><br><span class="line">	<span class="keyword">case</span> Violet:</span><br><span class="line">	<span class="keyword">case</span> Indigo:</span><br><span class="line">	<span class="keyword">case</span> Blue:</span><br><span class="line">	<span class="keyword">case</span> Green:</span><br><span class="line">	<span class="keyword">case</span> Yellow:</span><br><span class="line">	<span class="keyword">case</span> Orange:</span><br><span class="line">	<span class="keyword">case</span> Red:</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Bingo,your choice is a Rainbow color!&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	<span class="keyword">default</span>:</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;The color you chose is not in the rainbow&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">break</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>查错：下面的代码有何错误？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> counter = <span class="number">0</span>; counter = <span class="number">10</span>; ++counter)</span><br><span class="line">    cout &lt;&lt; counter &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：counter&#x3D;10,这条语句可能会导致死循环</p>
</li>
<li><p><strong>查错：下面的代码有何错误？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> loopCounter = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">while</span>(loopCounter &lt; <span class="number">5</span>);</span><br><span class="line">&#123;</span><br><span class="line">    cout &lt;&lt; loopCounter &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">    loopCounter++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：while(loopCounter &lt; 5);的分号会导致死循环，不会执行后面的操作。</p>
</li>
<li><p><strong>查错：下面的代码有何错误？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">cout &lt;&lt; <span class="string">&quot;Enter a number between 0 and 4&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="type">int</span> input = <span class="number">0</span>;</span><br><span class="line">cin &gt;&gt; input;</span><br><span class="line"></span><br><span class="line"><span class="keyword">switch</span> (input)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line"><span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Valid input&quot;</span> &lt;&lt; endl;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Invalid input&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：没有在cout &lt;&lt; “Valid input” &lt;&lt; endl;后添加break.</p>
</li>
</ol>
<h1 id="第七章"><a href="#第七章" class="headerlink" title="第七章"></a>第七章</h1><h2 id="7-1-为何需要函数"><a href="#7-1-为何需要函数" class="headerlink" title="7.1 为何需要函数"></a>7.1 为何需要函数</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单7.1 两个根据半径分别计算圆的面积和周长的函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.14159265</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius)</span></span>;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Circumference</span><span class="params">(<span class="type">double</span> radius)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter radius: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> radius = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; radius;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Area is: &quot;</span> &lt;&lt; <span class="built_in">Area</span>(radius) &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Circumference is: &quot;</span> &lt;&lt; <span class="built_in">Circumference</span>(radius) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> Pi * radius * radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Circumference</span><span class="params">(<span class="type">double</span> radius)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> Pi * <span class="number">2</span> * radius;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>7.1.1 函数原型是什么</strong></p>
<p><code>double Area(double radius);</code></p>
<ul>
<li>double: 返回值类型</li>
<li>Area:函数名</li>
<li>(double radius):函数参数（可选）,参数列表由参数类型和参数名（可选）组成，当有多个参数时，用逗号隔开。</li>
</ul>
<p>​	<strong>函数原型</strong>：指出了函数的名称、函数接受的参数列表以及返回值类型</p>
<p><strong>7.1.2 函数定义是什么</strong></p>
<p>​	<strong>函数定义</strong>：总是由一个语句块组成。除非返回类型被声明为void，否则必须包含一条return语句。</p>
<p><strong>7.1.3  函数调用和实参是什么</strong></p>
<ul>
<li>**形参(parameter)**：函数声明中包含的参数。</li>
<li>**实参(argument)**：调用函数提供的参数</li>
</ul>
<p><strong>7.1.4 编写接收多个参数的函数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单7.2 接受两个参数以计算圆柱表面积的函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.14159265</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">SurfaceArea</span><span class="params">(<span class="type">double</span> radius, <span class="type">double</span> height)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter the radius of the cyliner:&quot;</span>;</span><br><span class="line">	<span class="type">double</span> radius = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; radius;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter the height of the cyliner:&quot;</span>;</span><br><span class="line">	<span class="type">double</span> height = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; height;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;SurfaceArea is : &quot;</span> &lt;&lt; <span class="built_in">SurfaceArea</span>(radius, height) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">SurfaceArea</span><span class="params">(<span class="type">double</span> radius, <span class="type">double</span> height)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">double</span> area = <span class="number">2</span> * Pi * radius * radius + <span class="number">2</span> * Pi * radius * height;</span><br><span class="line">	<span class="keyword">return</span> area;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>7.1.5 编写没有参数和返回值的函数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单7.3 没有参数和返回值的函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SayHello</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">SayHello</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SayHello</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;heloo world&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>7.1.6 带默认值的函数参数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单7.4 计算圆面积的函数，其第二个参数为pi,该参数的默认值为3.14</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius, <span class="type">double</span> pi = <span class="number">3.14</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter radius: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> radius = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; radius;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pi is 3.14, do you wish to change this(y/n)?&quot;</span>;</span><br><span class="line">	<span class="type">char</span> changePi = <span class="string">&#x27;n&#x27;</span>;</span><br><span class="line">	cin &gt;&gt; changePi;</span><br><span class="line"></span><br><span class="line">	<span class="type">double</span> circleArea = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> (changePi == <span class="string">&#x27;y&#x27;</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Enter new Pi: &quot;</span>;</span><br><span class="line">		<span class="type">double</span> newPi = <span class="number">3.14</span>;</span><br><span class="line">		cin &gt;&gt; newPi;</span><br><span class="line">		circleArea = <span class="built_in">Area</span>(radius, newPi);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		circleArea = <span class="built_in">Area</span>(radius);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Area is: &quot;</span> &lt;&lt; circleArea &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius, <span class="type">double</span> pi)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> radius * radius * pi;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>7.1.7 递归函数——调用自己的函数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单7.5 使用递归函数计算斐波那契数列中的数字</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">GetFibNumber</span><span class="params">(<span class="type">int</span> fibIndex)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (fibIndex &lt; <span class="number">2</span>) <span class="keyword">return</span> fibIndex;</span><br><span class="line">	<span class="keyword">else</span> <span class="keyword">return</span> <span class="built_in">GetFibNumber</span>(fibIndex - <span class="number">1</span>) + <span class="built_in">GetFibNumber</span>(fibIndex - <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter 0-Based index of desired Fibonacci Number: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; index;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Fibonacci number is: &quot;</span> &lt;&lt; <span class="built_in">GetFibNumber</span>(index) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-2-使用函数处理不同的数据"><a href="#7-2-使用函数处理不同的数据" class="headerlink" title="7.2 使用函数处理不同的数据"></a>7.2 使用函数处理不同的数据</h2><p><strong>7.2.1 函数重载</strong></p>
<p>​	<strong>名称和返回值相同，但参数不同的函数称为函数重载。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单7.7 在同一个函数中使用多条语句</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.14159265</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius)</span></span>;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius, <span class="type">double</span> height)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter z fro cyliner, c for Circle: &quot;</span>;</span><br><span class="line">	<span class="type">char</span> userSelection = <span class="string">&#x27;z&#x27;</span>;</span><br><span class="line">	cin &gt;&gt; userSelection;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter radius: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> radius = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; radius;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (userSelection == <span class="string">&#x27;z&#x27;</span>)&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Enter height:&quot;</span>;</span><br><span class="line">		<span class="type">double</span> height = <span class="number">0</span>;</span><br><span class="line">		cin &gt;&gt; height;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Area of cyliner is: &quot;</span> &lt;&lt; <span class="built_in">Area</span>(radius, height) &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Area of cyliner is: &quot;</span> &lt;&lt; <span class="built_in">Area</span>(radius) &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> radius * radius * Pi;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius, <span class="type">double</span> height)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">2</span> * <span class="built_in">Area</span>(radius) + <span class="number">2</span> * Pi * radius * height;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>7.2.2 将数组传递给函数</strong></p>
<p><strong>示例</strong>：<code>void DisplayIntegers(int numbers[], int Length);</code></p>
<ul>
<li>第一参数是一个整型数组</li>
<li>第二个参数是数组的长度</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单7.8 接受数组作为参数的函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DisplayArray</span><span class="params">(<span class="type">int</span> numbers[], <span class="type">int</span> length)</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DisplayArray</span><span class="params">(<span class="type">char</span> charaters[], <span class="type">int</span> length)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> myNums[<span class="number">4</span>] = &#123; <span class="number">24</span>,<span class="number">58</span>,<span class="number">-1</span>,<span class="number">245</span> &#125;;</span><br><span class="line">	<span class="built_in">DisplayArray</span>(myNums, <span class="number">4</span>);</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> myStatement[<span class="number">7</span>] = &#123; <span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;e&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;l&#x27;</span>,<span class="string">&#x27;o&#x27;</span>,<span class="string">&#x27;!&#x27;</span>,<span class="string">&#x27;\0&#x27;</span> &#125;;</span><br><span class="line">	<span class="built_in">DisplayArray</span>(myStatement, <span class="number">7</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DisplayArray</span><span class="params">(<span class="type">int</span> numbers[], <span class="type">int</span> length)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; length; i++)&#123;</span><br><span class="line">		cout &lt;&lt; numbers[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DisplayArray</span><span class="params">(<span class="type">char</span> charaters[], <span class="type">int</span> length)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; length; i++)&#123;</span><br><span class="line">		cout &lt;&lt; charaters[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>7.2.3 按引用传递参数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单7.9 以引用参数（而不是返回值）的方式提供圆的面积</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.1416</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius, <span class="type">double</span>&amp; result)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter radius: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> radius = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; radius;</span><br><span class="line"></span><br><span class="line">	<span class="type">double</span> areaFetched = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">Area</span>(radius, areaFetched);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;This area is: &quot;</span> &lt;&lt; areaFetched &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius, <span class="type">double</span>&amp; result)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	result = radius * radius * Pi;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-3-微处理器如何处理函数调用"><a href="#7-3-微处理器如何处理函数调用" class="headerlink" title="7.3 微处理器如何处理函数调用"></a>7.3 微处理器如何处理函数调用</h2><p><strong>7.3.1 内联函数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单7.10 将把整数翻倍的函数声明为内联</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">long</span> <span class="title">DoubleNum</span><span class="params">(<span class="type">int</span> inputNum)</span> </span>&#123;</span><br><span class="line">	<span class="keyword">return</span> inputNum * <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter an integer: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> input = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; input;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Double is:&quot;</span> &lt;&lt; <span class="built_in">DoubleNum</span>(input) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>7.3.2 自动推断返回类型</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单7.11 将函数Area()的返回类型指定为auto</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.14159265</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">auto</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span>  Pi * radius * radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter radius: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> radius = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; radius;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Area is: &quot;</span> &lt;&lt; <span class="built_in">Area</span>(radius) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>7.3.3 lambda函数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 7.12 使用lambda函数对数组中的元素进行排序并显示它们</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DisplayNums</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; dynArray)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	for_each(dynArray.<span class="built_in">begin</span>(), dynArray.<span class="built_in">end</span>(), \</span><br><span class="line">		[](<span class="type">int</span> Element) &#123;cout &lt;&lt; Element &lt;&lt; <span class="string">&quot; &quot;</span>; &#125;);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; myNums;</span><br><span class="line">	myNums.<span class="built_in">push_back</span>(<span class="number">501</span>);</span><br><span class="line">	myNums.<span class="built_in">push_back</span>(<span class="number">-1</span>);</span><br><span class="line">	myNums.<span class="built_in">push_back</span>(<span class="number">25</span>);</span><br><span class="line">	myNums.<span class="built_in">push_back</span>(<span class="number">-35</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">DisplayNums</span>(myNums);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Sorting them in descending order&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">sort</span>(myNums.<span class="built_in">begin</span>(), myNums.<span class="built_in">end</span>(), \</span><br><span class="line">		[](<span class="type">int</span> Num1, <span class="type">int</span> Num2) &#123;<span class="built_in">return</span> (Num1 &gt; Num1); &#125;);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">DisplayNums</span>(myNums);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="7-6-作业"><a href="#7-6-作业" class="headerlink" title="7.6 作业"></a>7.6 作业</h2><p><strong>7.6.1 测验</strong></p>
<ol>
<li><p><strong>在函数原型中声明的变量的作用域是什么？</strong></p>
<p><strong>答</strong>：作用域仅在函数本身</p>
</li>
<li><p><strong>传递给下述函数的值有何特征？</strong></p>
<p><code>int Func(int &amp;someNumber);</code></p>
<p><strong>答</strong>：可通过someNumber修改传进来的实参</p>
</li>
<li><p><strong>调用自己的函数叫什么？</strong></p>
<p><strong>答</strong>：递归</p>
</li>
<li><p><strong>我声明了两个函数，它们的名称和返回值类型相同，但参数列表不同，这被称为什么？</strong></p>
<p><strong>答</strong>：函数重载</p>
</li>
<li><p><strong>栈指针指向栈的顶部、中间还是底部？</strong></p>
<p><strong>答</strong>：栈的顶部</p>
</li>
</ol>
<p><strong>7.6.2 练习</strong></p>
<ol>
<li><p><strong>编写两个重载函数，它们分别使用下述公式计算球和圆柱体的体积：</strong></p>
<p><strong>答</strong>：<code>double Area(double radius);</code></p>
<p>​	 <code>double Area(double radius,double height);</code></p>
</li>
<li><p><strong>编写一个函数，它将一个double数组作为参数。</strong></p>
<p><strong>答</strong>：<code>void DisplayNumbers(double doubleArray,int length);</code></p>
</li>
<li><p><strong>查错：下述代码有什么错误？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.1416</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Area</span><span class="params">(<span class="type">double</span> radius, <span class="type">double</span> result)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	result =   Pi * radius * radius;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter radius: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> radius = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; radius;</span><br><span class="line"></span><br><span class="line">	<span class="type">double</span> areaFetched = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">Area</span>(radius, areaFetched);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The Area is: &quot;</span> &lt;&lt; areaFetched &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：通过使用值传递的方式，用形参修改实参</p>
</li>
<li><p><strong>查错：下述函数声明有什么错误？</strong></p>
<p><code>double Area(double Pi = 3.14, double radius);</code></p>
<p><strong>答</strong>：函数的默认参数应该从右往左声明</p>
</li>
<li><p><strong>编写一个返回类型为void的函数，在提供了半径的情况下，他能帮助调用者计算圆的周长和面积</strong></p>
<p><strong>答</strong>：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.14</span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Calc</span><span class="params">(<span class="type">double</span> radius, <span class="type">double</span> &amp;area, <span class="type">double</span> &amp;circumference)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    area = Pi * radius * radius;</span><br><span class="line">    circumference = <span class="number">2</span> * radius * Pi;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第八章"><a href="#第八章" class="headerlink" title="第八章"></a>第八章</h1><h2 id="8-1-什么是指针"><a href="#8-1-什么是指针" class="headerlink" title="8.1 什么是指针"></a>8.1 什么是指针</h2><p>​	<strong>指针是存储内存地址的变量</strong></p>
<p><strong>8.1.1 声明指针</strong></p>
<ul>
<li><code>PointedType * PointerVariableName;</code></li>
<li><code>PointedType * PointerVariableName = NULL; </code></li>
</ul>
<p><strong>8.1.2 使用引用运算符（&amp;）获取变量地址</strong></p>
<p>​	<strong>如果varName是一个变量，&amp;varName将是存储该变量的地址</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单8.1 获取int变量和double变量的地址</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> age = <span class="number">30</span>;</span><br><span class="line">	<span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.1416</span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Integer age is localted at: 0x&quot;</span> &lt;&lt; &amp;age &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;double Pi is localted at: 0x&quot;</span> &lt;&lt; &amp;Pi &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>8.1.3 使用指针存储地址</strong></p>
<p>​	<strong>要将变量的地址存储到一个指针，需要声明一个同样的指针，并使用引用符号（&amp;）将其初始化为该变量的地址</strong></p>
<p>​	<code>Type* Pointer = &amp;Variable;</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单8.2 声明指针并初始化指针</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> age = <span class="number">30</span>;</span><br><span class="line">	<span class="type">int</span>* pointsToInt = &amp;age;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Integer age is localted at: 0x&quot;</span> &lt;&lt; hex &lt;&lt; pointsToInt &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单8.3 给指针重新赋值，使其指向另一个变量</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> age = <span class="number">30</span>;</span><br><span class="line">	<span class="type">int</span>* pointsToInt = &amp;age;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pointsToInt points to age now&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pointaToInt = 0x&quot;</span> &lt;&lt; hex &lt;&lt; pointsToInt &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> dogsAge = <span class="number">9</span>;</span><br><span class="line">	pointsToInt = &amp;dogsAge;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pointsToInt points to dogsAge now&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pointaToInt = 0x&quot;</span> &lt;&lt; hex &lt;&lt; pointsToInt &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>8.1.4 使用解除引用运算符（*）访问指向的数据</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单8.4 使用解除引用运算符(*)来访问整数值</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> age = <span class="number">30</span>;</span><br><span class="line">	<span class="type">int</span> dogsAge = <span class="number">9</span>;</span><br><span class="line"></span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Interger age = &quot;</span> &lt;&lt; age &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Interger dogsAge = &quot;</span> &lt;&lt; hex &lt;&lt; dogsAge &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span>* pointsToInt = &amp;age;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pintersToint points to age&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pointsToInt = 0x&quot;</span> &lt;&lt; hex &lt;&lt; pointsToInt &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;*pointsToInt = &quot;</span> &lt;&lt; dec &lt;&lt; *pointsToInt &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	pointsToInt = &amp;dogsAge;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pintersToint points to dogsAge&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pointsToInt = 0x&quot;</span> &lt;&lt; hex &lt;&lt; pointsToInt &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;*pointsToInt = &quot;</span> &lt;&lt; dec &lt;&lt; *pointsToInt &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单8.5 使用指针和解除引用运算符操作数据</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> dogsAge = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Initialized dogsAge = &quot;</span> &lt;&lt; dogsAge &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span>* pointesToAnAGe = &amp;dogsAge;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pointsToAnAge points to dogsAge&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter an age for your dog: &quot;</span>;</span><br><span class="line">	cin &gt;&gt; *pointesToAnAGe;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Input stored at 0x&quot;</span> &lt;&lt; hex &lt;&lt; pointesToAnAGe &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Integer dogsAge = &quot;</span> &lt;&lt; dec &lt;&lt; dogsAge &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>8.1.5 将sizeof()用于指针的结果</strong></p>
<ul>
<li>32位：sizeof结果为4</li>
<li>64位：sizeof结果为8</li>
</ul>
<h2 id="8-2-动态分配内存"><a href="#8-2-动态分配内存" class="headerlink" title="8.2 动态分配内存"></a>8.2 动态分配内存</h2><p><strong>8.2.1 使用new和delete动态分配内存和释放内存</strong></p>
<ol>
<li><p>分配和释放一个元素</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Type* Pointer = <span class="keyword">new</span> Type;</span><br><span class="line"><span class="keyword">delete</span> Pointer;</span><br></pre></td></tr></table></figure>
</li>
<li><p>分配和释放多个元素</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Type* Pointer = <span class="keyword">new</span> Tyoe[numElements];</span><br><span class="line"><span class="keyword">delete</span>[] Pointer;</span><br></pre></td></tr></table></figure></li>
</ol>
<p><strong>8.2.2 将递增和递减运算符（++和–）用于指针的结果</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单8.9 使用偏移量和运算符来递增和递减指针</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;How many integers you wish to enter?&quot;</span>;</span><br><span class="line">	<span class="type">int</span> numEntries = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; numEntries;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span>* pointsToInts = <span class="keyword">new</span> <span class="type">int</span>[numEntries];</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Allocated for &quot;</span> &lt;&lt; numEntries &lt;&lt; <span class="string">&quot;integers&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> counter = <span class="number">0</span>; counter &lt; numEntries; ++counter) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Enter number&quot;</span> &lt;&lt; counter &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">		cin &gt;&gt; *(pointsToInts + counter);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Displaying all numbers entered: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> counter = <span class="number">0</span>; counter &lt; numEntries; ++counter) &#123;</span><br><span class="line">		cout &lt;&lt; *(pointsToInts++) &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	pointsToInts -= numEntries;</span><br><span class="line">	<span class="keyword">delete</span>[] pointsToInts;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>8.2.3 将关键字用于const用于指针</strong></p>
<ul>
<li><p>指针包含的地址是常量，不能修改指针指向的数据：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> daysInMonrh = <span class="number">30</span>;</span><br><span class="line"><span class="type">int</span>* <span class="type">const</span> pDaysInMonth = &amp;daysInMonrh;</span><br><span class="line">*pDaysInMonth = <span class="number">31</span>;</span><br><span class="line"><span class="type">int</span> daysInLunarMonth = <span class="number">28</span>;</span><br><span class="line">pDaysInMonth = &amp;daysInLunarMonth; <span class="comment">//error,Cannot change address</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>指针指向的数据为常量，不能修改，但可以修改指针包含的地址，即指针可以指向其地方</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> hoursInDay = <span class="number">24</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span>* pointsToInt = &amp;hoursInDay;</span><br><span class="line"><span class="type">int</span> monthsInYear = <span class="number">12</span>;</span><br><span class="line">pointsToInt = &amp;monthsInYear;</span><br><span class="line">*pointsToInt = <span class="number">13</span>; <span class="comment">//error ,Cannot change data being pointed to</span></span><br><span class="line"><span class="type">int</span>* newPointer = pointsToInt; <span class="comment">// error, Cannot assign const to non-const</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>指针包含的地址以及它指向的值都是常量，不能修改（这种最严格）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> hoursInDay = <span class="number">24</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span>* <span class="type">const</span> pHourInDay = &amp;hoursInDay;</span><br><span class="line">*pHourInDay = <span class="number">25</span>; <span class="comment">//error, Cannot change data being pointed to</span></span><br><span class="line"><span class="type">int</span> daysInMonth = <span class="number">30</span>;</span><br><span class="line">pHourInDay = &amp;daysInMonth; <span class="comment">//error, Cannot change address</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>8.2.4 将指针传递给函数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单8.10 在计算圆面积的函数使用关键字const</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">CalcArea</span><span class="params">(<span class="type">const</span> <span class="type">double</span>* <span class="type">const</span> ptrPi,</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="type">const</span> <span class="type">double</span>* <span class="type">const</span> ptrRadius,</span></span></span><br><span class="line"><span class="params"><span class="function">	<span class="type">double</span>* <span class="type">const</span> ptrArea)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (ptrPi &amp;&amp; ptrRadius &amp;&amp; ptrArea) &#123;</span><br><span class="line">		*ptrArea = (*ptrPi) * (*ptrRadius) * (*ptrRadius);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.1416</span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter radius of circle: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> radius = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; radius;</span><br><span class="line"></span><br><span class="line">	<span class="type">double</span> area = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">CalcArea</span>(&amp;Pi, &amp;radius, &amp;area);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Area is = &quot;</span> &lt;&lt; area &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>8.2.5 数组和指针的类似之处</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 8.11 数组变量是指向第一个元素的指针</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> myNumbers[<span class="number">5</span>];</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span>* pointToNums = myNumbers;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pointToNums = 0x&quot;</span> &lt;&lt; hex &lt;&lt; pointToNums &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;&amp;myNumbers[0] = 0x&quot;</span> &lt;&lt; hex &lt;&lt; &amp;myNumbers[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单8.12 使用解除引用运算符（*）访问数组中的元素以及将数组运算符（[]）用于指针</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> ARRAY_LEN = <span class="number">5</span>;</span><br><span class="line">	<span class="type">int</span> myNumbers[ARRAY_LEN] = &#123; <span class="number">24</span>,<span class="number">-1</span>,<span class="number">365</span>,<span class="number">-999</span>,<span class="number">2011</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span>* pointToNums = myNumbers;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;pointToNums = 0x&quot;</span> &lt;&lt; hex &lt;&lt; pointToNums &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;&amp;myNumbers[0] = 0x&quot;</span> &lt;&lt; hex &lt;&lt; &amp;myNumbers[<span class="number">0</span>] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Display array using pointer syntax, operator*&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> index = <span class="number">0</span>; index &lt; ARRAY_LEN; index++) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Element &quot;</span> &lt;&lt; index &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; *(myNumbers + index) &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Display array using ptr with array syntax, operator[]&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> index = <span class="number">0</span>; index &lt; ARRAY_LEN; index++) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Element &quot;</span> &lt;&lt; index &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; pointToNums[index] &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-5-引用是什么"><a href="#8-5-引用是什么" class="headerlink" title="8.5 引用是什么"></a>8.5 引用是什么</h2><p>​	<strong>引用是变量的别名。声明时，需要将初始化为一个变量</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">VarType original = value;</span><br><span class="line">VarType ReferenceVarialbe = original;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 8.17 引用是相应变量的别名</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> original = <span class="number">30</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;original = &quot;</span> &lt;&lt; original &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;original = &quot;</span> &lt;&lt; hex &lt;&lt; &amp;original &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span>&amp; ref1 = original;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;ref1 is at address: &quot;</span> &lt;&lt; hex &lt;&lt; &amp;ref1 &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span>&amp; ref2 = ref1;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;ref2 is at address: &quot;</span> &lt;&lt; hex &lt;&lt; &amp;ref2 &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Therefore, ref2 = &quot;</span> &lt;&lt; dec &lt;&lt; ref2 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>8.5.1 是什么让引用很有用</strong></p>
<p>​	<strong>可以在函数调用实参时避免复制这个步骤</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//可避免复制步骤的函数版本类似下面这样：</span></span><br><span class="line"><span class="function">ReturnType <span class="title">DoSomething</span><span class="params">(Type&amp; parameter)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//调用如下</span></span><br><span class="line">ReturnType Result = <span class="built_in">Dosomething</span>(argument);</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单8.18 一个计算平方值通过引用参数返回结果的函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GetSquare</span><span class="params">(<span class="type">int</span>&amp; number)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	number *= number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter a number you wish to square: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> number = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; number;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">GetSquare</span>(number);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Square is: &quot;</span> &lt;&lt; number &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>8.5.2 将关键字const用于引用</strong></p>
<p>​	<strong>须要禁止通过引用修改它的指向变量的值，为此可在声明引用时使用关键字const：</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> original = <span class="number">30</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span>&amp; constRef = original;</span><br><span class="line">constRef = <span class="number">40</span>; <span class="comment">//error: constRef can&#x27;t change value in original</span></span><br><span class="line"><span class="type">int</span>&amp; ref = constRef; <span class="comment">//error: ref2 is not const</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span>&amp; constRef2 = constRef;</span><br></pre></td></tr></table></figure>

<p><strong>按引用向函数传递参数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单8.19 使用const引用确保被调用的函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">GetSquare</span><span class="params">(<span class="type">const</span> <span class="type">int</span>&amp; number, <span class="type">int</span> &amp;result)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	result = number * number;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter a number you wish to square: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> number = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; number;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> square = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">GetSquare</span>(number, square);</span><br><span class="line">	cout &lt;&lt; number &lt;&lt; <span class="string">&quot;^2 = &quot;</span> &lt;&lt; square &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="8-5-作业"><a href="#8-5-作业" class="headerlink" title="8.5 作业"></a>8.5 作业</h2><p><strong>8.8.1 测验</strong></p>
<ol>
<li><p><strong>为何不能将const引用赋给非const引用</strong></p>
<p><strong>答</strong>：防止非const引用修改const引用的值</p>
</li>
<li><p><strong>new和delete是函数吗？</strong></p>
<p><strong>答</strong>：是关键字</p>
</li>
<li><p><strong>指针变量包含的值有何特征？</strong></p>
<p><strong>答</strong>：变量地址</p>
</li>
<li><p><strong>要访问指针指向的数据，应使用哪种运算符？</strong></p>
<p><strong>答</strong>：解引用运算符（*）</p>
</li>
</ol>
<p><strong>8.8.2 练习</strong></p>
<ol>
<li><p><strong>下面的语句显示什么</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> number = <span class="number">3</span>;</span><br><span class="line"><span class="type">int</span> *pNum1 = &amp;number;</span><br><span class="line">*pNum1 = <span class="number">20</span>;</span><br><span class="line"><span class="type">int</span> *PNum2 = pNum1;</span><br><span class="line">number *= <span class="number">2</span>;</span><br><span class="line">cout &lt;&lt; *pNum2;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：40</p>
</li>
<li><p>**下面三个重载的函数有何相同和不同之处？ **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">DoSomething</span><span class="params">(<span class="type">int</span> num1, <span class="type">int</span> num2)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">DoSomething</span><span class="params">(<span class="type">int</span>&amp; num1, <span class="type">int</span>&amp; num2)</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">DoSomething</span><span class="params">(<span class="type">int</span>* num1, <span class="type">int</span>* num2)</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：  </p>
<ol>
<li><strong>相同之处</strong><ul>
<li>函数名相同</li>
<li>功能相似</li>
<li>返回值相同</li>
</ul>
</li>
<li><strong>不同之处</strong><ul>
<li>参数不同</li>
<li>调用方式不同</li>
<li>对参数的影响</li>
<li>使用场景不同</li>
</ul>
</li>
</ol>
</li>
<li><p><strong>要让练习1中第3行的赋值非法，应如何修改第1行中pNum1的声明（提示：让pNum1不能 修改它指向的数据）？</strong></p>
<p><strong>答</strong>：添加const关键字</p>
</li>
<li><p><strong>查错：下面的代码有何错误？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span>* pointToAnInt = <span class="keyword">new</span> <span class="type">int</span>;</span><br><span class="line">	pointToAnInt = <span class="number">9</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The value at pointToAnInt: &quot;</span> &lt;&lt; *pointToAnInt &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">delete</span> pointToAnInt;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：没有使用解引用运算符（*）就直接对pointToAnInt操作</p>
</li>
<li><p><strong>查错：下面的代码有何错误？</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span>* pointToAnInt = <span class="keyword">new</span> <span class="type">int</span>;</span><br><span class="line">	<span class="type">int</span> * pNumberCopy = pointToAnInt;</span><br><span class="line">	*pNumberCopy = <span class="number">30</span>;</span><br><span class="line">	cout &lt;&lt; *pointToAnInt;</span><br><span class="line">	<span class="keyword">delete</span> pNumberCopy;</span><br><span class="line">	<span class="keyword">delete</span> pointToAnInt;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：对同一块内存重复释放；  </p>
</li>
<li><p><strong>修正练习5的代码后，其输出是什么？</strong></p>
<p><strong>答</strong>：30</p>
</li>
</ol>
<h1 id="第九章"><a href="#第九章" class="headerlink" title="第九章"></a>第九章</h1><h2 id="9-1-类和对象"><a href="#9-1-类和对象" class="headerlink" title="9.1 类和对象"></a>9.1 类和对象</h2><p><strong>9.14 使用指针运算符（-&gt;）访问成员</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 一个值得编译的Human类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">IntroduceSelf</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;I am&quot;</span> + name &lt;&lt; <span class="string">&quot; and am &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years old&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Human firstMan;</span><br><span class="line">	firstMan.name = <span class="string">&quot;Adam&quot;</span>;</span><br><span class="line">	firstMan.age = <span class="number">30</span>;</span><br><span class="line"></span><br><span class="line">	Human firstWoman;</span><br><span class="line">	firstWoman.name = <span class="string">&quot;Eve&quot;</span>;</span><br><span class="line">	firstWoman.age = <span class="number">28</span>;</span><br><span class="line"></span><br><span class="line">	firstMan.<span class="built_in">IntroduceSelf</span>();</span><br><span class="line">	firstWoman.<span class="built_in">IntroduceSelf</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-2-关键字public和private"><a href="#9-2-关键字public和private" class="headerlink" title="9.2 关键字public和private"></a>9.2 关键字public和private</h2><p><strong>9.2.1 使用关键字private实现数据抽象</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单9.2 一个对外隐藏真实年龄并将自己说的更年轻的Human类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SetAge</span><span class="params">(<span class="type">int</span> inputAge)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		age = inputAge;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">GetAge</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (age &gt; <span class="number">30</span>) <span class="keyword">return</span> (age - <span class="number">2</span>);</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Human firstMan;</span><br><span class="line">	firstMan.<span class="built_in">SetAge</span>(<span class="number">35</span>);</span><br><span class="line">	</span><br><span class="line">	Human firstWoman;</span><br><span class="line">	firstWoman.<span class="built_in">SetAge</span>(<span class="number">22</span>);</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Age of firstMan &quot;</span> &lt;&lt; firstMan.<span class="built_in">GetAge</span>() &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Age of firstWoman &quot;</span> &lt;&lt; firstWoman.<span class="built_in">GetAge</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-3-构造函数"><a href="#9-3-构造函数" class="headerlink" title="9.3 构造函数"></a>9.3 构造函数</h2><p><strong>9.3.1 声明和实现构造函数</strong></p>
<p>​	<strong>构造函数是一种特殊的函数，他与类同名且不返回任何值，Human类的构造函数的声明类似于下面这样</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Human</span>(); <span class="comment">//constuctor declaration</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>​	<strong>构造函数可在类声明中实现</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Human</span>()</span><br><span class="line">    &#123;</span><br><span class="line">    	<span class="comment">//constructor code here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>​	<strong>在类声明外定义构造函数</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Human</span>(); <span class="comment">//constuctor declaration</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Human::<span class="built_in">Human</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//constructor code here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>9.3.2 何时及如何使用构造函数</strong></p>
<p>​	<strong>构造函数总是在创建对象时被调用，这让构造函数成为将类成员变量初始化为选定值的理想场所</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//9.3 使用构造函数初始化类成员变量</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Human</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		age = <span class="number">1</span>;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Constructed an instance of class Human&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SetName</span><span class="params">(string humansNmae)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		name = humansNmae;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SetAge</span><span class="params">(<span class="type">int</span> humansAge)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		age = humansAge;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">IntroduceSelf</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;I am &quot;</span> + name &lt;&lt; <span class="string">&quot; and am &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years old&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Human firstWoman;</span><br><span class="line">	firstWoman.<span class="built_in">SetName</span>(<span class="string">&quot;Eve&quot;</span>);</span><br><span class="line">	firstWoman.<span class="built_in">SetAge</span>(<span class="number">28</span>);</span><br><span class="line"></span><br><span class="line">	firstWoman.<span class="built_in">IntroduceSelf</span>();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>9.3.3 重载构造函数</strong></p>
<p>​	<strong>与函数一样，构造函数也可以重载</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//9.4 包含多个构造函数的Human类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Human</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		age = <span class="number">1</span>;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Default Constructor: name and age not set&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">Human</span>(string humansName, <span class="type">int</span> humansAge)</span><br><span class="line">	&#123;</span><br><span class="line">		name = humansName;</span><br><span class="line">		age = humansAge;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Overloaded constructor creates &quot;</span>;</span><br><span class="line">		cout &lt;&lt; name &lt;&lt; <span class="string">&quot; of &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years &quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Human firstMan;</span><br><span class="line">	<span class="function">Human <span class="title">firstWoman</span><span class="params">(<span class="string">&quot;Eve&quot;</span>, <span class="number">20</span>)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>9.3.4 没有默认构造函数的类</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//9.5 一个有重载的构造函数，但没有默认的构造函数的类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Human</span>(string humansName, <span class="type">int</span> humansAge)</span><br><span class="line">	&#123;</span><br><span class="line">		name = humansName;</span><br><span class="line">		age = humansAge;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Overloaded constructor creates &quot;</span>;</span><br><span class="line">		cout &lt;&lt; name &lt;&lt; <span class="string">&quot; of &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years &quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">IntroduceSelf</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;I am &quot;</span> + name &lt;&lt; <span class="string">&quot; and am&quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years old&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Human <span class="title">firstMan</span><span class="params">(<span class="string">&quot;Adam&quot;</span>, <span class="number">25</span>)</span></span>;</span><br><span class="line">	<span class="function">Human <span class="title">firstWoman</span><span class="params">(<span class="string">&quot;Eve&quot;</span>, <span class="number">20</span>)</span></span>;</span><br><span class="line">	</span><br><span class="line">	firstMan.<span class="built_in">IntroduceSelf</span>();</span><br><span class="line">	firstWoman.<span class="built_in">IntroduceSelf</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>9.3.5 带默认值的构造函数参数</strong></p>
<p>​	<strong>就像函数可以带有默认值的参数一样，构造函数也可以</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Human</span>(string humansName, <span class="type">int</span> humansAge = <span class="number">25</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		name = humansName;</span><br><span class="line">		age = humansAge;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Overloaded constructor creates &quot;</span>;</span><br><span class="line">		cout &lt;&lt; name &lt;&lt; <span class="string">&quot; of &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years &quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">IntroduceSelf</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;I am &quot;</span> + name &lt;&lt; <span class="string">&quot; and am&quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years old&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>9.3.6 包含初始化列表的构造函数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单9.6 接受带默认值的参数的默认构造函数，并使用初始化列表来设置成员</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Human</span>(string humansName = <span class="string">&quot;Adam&quot;</span>, <span class="type">int</span> humansAge = <span class="number">25</span>) </span><br><span class="line">		: <span class="built_in">name</span>(humansName),<span class="built_in">age</span>(humansAge)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Overloaded constructor creates &quot;</span>;</span><br><span class="line">		cout &lt;&lt; name &lt;&lt; <span class="string">&quot; of &quot;</span> &lt;&lt; age &lt;&lt; <span class="string">&quot; years &quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Human firstMan;</span><br><span class="line">	<span class="function">Human <span class="title">firstWoman</span><span class="params">(<span class="string">&quot;Eve&quot;</span>, <span class="number">20</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>​	<strong>也可以使用constexpr关键字将构造函数定义为常量表达式</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Sample</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">const</span> <span class="type">char</span>* someString;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">constexpr</span> <span class="title">Sample</span><span class="params">(<span class="type">const</span> <span class="type">char</span>* input)</span> : someString(input)</span></span><br><span class="line"><span class="function">    &#123;</span></span><br><span class="line">        <span class="comment">//constructor code</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="9-4-析构函数"><a href="#9-4-析构函数" class="headerlink" title="9.4 析构函数"></a>9.4 析构函数</h2><p>​	<strong>析构函数看起来像一个类同名的函数，但前面有一个腭化符号（~）。因此Human类的析构函数声明如下</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~<span class="built_in">Human</span>(); <span class="comment">//declaration of a destructor</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>​	<strong>类中声明实现</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~<span class="built_in">Human</span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">//destructor code here</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>​	<strong>在类声明外定义</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    ~<span class="built_in">Human</span>(); <span class="comment">//declaration of a destructor</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Human::~<span class="built_in">Human</span>()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//destructor code here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>9.4.2 何时及如何使用析构函数</strong></p>
<p>​	<strong>每当对象不在作用域内或通过delete被删除进而被销毁时，都讲调用析构函数。这使得析构函数称为重置变量以及释放动态分配的内存和其他资源的理想场所</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单9.7 一个简单的类，它封装了字符缓冲区并通过析构函数释放它</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyString</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">MyString</span>(<span class="type">const</span> <span class="type">char</span>* initString)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (initString != <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(initString) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, initString);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			buffer = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">MyString</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Invoking destructor, clearing up&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">GetLength</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">strlen</span>(buffer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">const</span> <span class="type">char</span>* <span class="title">GetString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> buffer;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">char</span>* buffer;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">MyString <span class="title">sayHello</span><span class="params">(<span class="string">&quot;Hello from String Class&quot;</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;String buffer in sayHello is  &quot;</span> &lt;&lt; sayHello.<span class="built_in">GetLength</span>() &lt;&lt; <span class="string">&quot; characters long&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Buffer contains: &quot;</span> &lt;&lt; sayHello.<span class="built_in">GetString</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-5-复制构造函数"><a href="#9-5-复制构造函数" class="headerlink" title="9.5 复制构造函数"></a>9.5 复制构造函数</h2><p><strong>9.5.1 浅复制及其存在的问题</strong></p>
<p>​	<strong>复制类的对象时，将复制其指针成员，但不复制指针指向的缓冲区，其结果是两个对象指向同一个动态分配的内存。销毁其中的一个对象时，导致另一个对象存储的指针拷贝无效。这种复制被称为浅复制</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单9.7  按值传递类的对象带来的问题</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyString</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">MyString</span>(<span class="type">const</span> <span class="type">char</span>* initString)</span><br><span class="line">	&#123;</span><br><span class="line">		buffer = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="keyword">if</span> (initString != <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(initString) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, initString);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">MyString</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Invoking destructor, clearing up&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">delete</span>[] buffer;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">GetLength</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">strlen</span>(buffer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">const</span> <span class="type">char</span>* <span class="title">GetString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> buffer;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">char</span>* buffer;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UseMyString</span><span class="params">(MyString str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;String buffer in MyString is &quot;</span> &lt;&lt; str.<span class="built_in">GetLength</span>() &lt;&lt; <span class="string">&quot; characters long&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;buffer contains: &quot;</span> &lt;&lt; str.<span class="built_in">GetLength</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">MyString <span class="title">sayHello</span><span class="params">(<span class="string">&quot;Hello from String Class&quot;</span>)</span></span>;</span><br><span class="line">	<span class="built_in">UseMyString</span>(sayHello);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>9.5.2 使用复制构造函数确保深复制</strong></p>
<p>​	<strong>复制构造函数是一个重载的构造函数，由编写类的程序员提供。每当对象被复制时，编译器都将调用复制构造函数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">MyString</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">MyString</span>(<span class="type">const</span> MyString&amp; copySource);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">MyString::<span class="built_in">MyString</span>(<span class="type">const</span> MyString&amp; copySource)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//Copy constructor implementation code</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单9.9 定义一个复制构造函数，确保对动态分配的缓冲区进行深复制</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyString</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">MyString</span>(<span class="type">const</span> <span class="type">char</span>* initString)</span><br><span class="line">	&#123;</span><br><span class="line">		buffer = <span class="literal">NULL</span>;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Default constructor: creating new MyString&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">if</span> (initString != <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(initString) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, initString);</span><br><span class="line"></span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;buffer points to: 0x&quot;</span> &lt;&lt; (<span class="type">unsigned</span> <span class="type">int</span>*)buffer &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">MyString</span>(<span class="type">const</span> MyString&amp; copySource)</span><br><span class="line">	&#123;</span><br><span class="line">		buffer = <span class="literal">NULL</span>;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Copy constructor: copying from MyString&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">if</span> (copySource.buffer != <span class="literal">NULL</span>)&#123;</span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(copySource.buffer) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, copySource.buffer);</span><br><span class="line"></span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;buffer points to:0x&quot;</span> &lt;&lt; hex &lt;&lt; (<span class="type">unsigned</span> <span class="type">int</span>*)buffer &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">MyString</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Invoking destructor, clearing up&quot;</span> &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">delete</span>[] buffer;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">GetLength</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">strlen</span>(buffer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">const</span> <span class="type">char</span>* <span class="title">GetString</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> buffer;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">char</span>* buffer;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">UseMyString</span><span class="params">(MyString str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;String buffer in MyString is &quot;</span> &lt;&lt; str.<span class="built_in">GetLength</span>() &lt;&lt; <span class="string">&quot; characters long&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;buffer contains: &quot;</span> &lt;&lt; str.<span class="built_in">GetLength</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">MyString <span class="title">sayHello</span><span class="params">(<span class="string">&quot;Hello from String Class&quot;</span>)</span></span>;</span><br><span class="line">	<span class="built_in">UseMyString</span>(sayHello);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>9.5.3 有助于改善性能的移动构造函数</strong></p>
<p>​	<strong>移动构造函数的语法</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">MyString</span>(MyString&amp;&amp; moveSource)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(moveSource.buffer != <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        buffer = moveSource.buffer;</span><br><span class="line">        moveSource.buffer = <span class="literal">NULL</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-6-构造函数和析构函数的其他用途"><a href="#9-6-构造函数和析构函数的其他用途" class="headerlink" title="9.6 构造函数和析构函数的其他用途"></a>9.6 构造函数和析构函数的其他用途</h2><p><strong>9.6.1 不允许复制的类</strong></p>
<p>​	<strong>要禁止类对象被复制，可声明一个私有的复制构造函数。确保函数调用无法通过编译。为禁止复制，可声明一个私有的赋值运算符</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">President</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="built_in">President</span>(<span class="type">const</span> President&amp;);</span><br><span class="line">    <span class="function">President&amp; <span class="title">operator</span><span class="params">(<span class="type">const</span> President&amp;)</span></span>;</span><br><span class="line">    <span class="comment">//... other attributes</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>9.6.2 只能有一个实列的单例类</strong></p>
<p>​	<strong>要创建单例类，关键字static必不可少</strong>  </p>
<ul>
<li>static用于类的数据成员时，该数据成员将在所有实例之间共享</li>
<li>static用于函数中声明的局部变量时，该变量的值将在两次调用之间保持不变</li>
<li>static用于成员函数时，该方法将在所有成员之间共享</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单9.10 单例类President, 它禁止复制、赋值及创建多个实例</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">President</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="built_in">President</span>() &#123;&#125;; <span class="comment">//private default constructor</span></span><br><span class="line">	<span class="built_in">President</span>(<span class="type">const</span> President&amp;); <span class="comment">//private copy constructor</span></span><br><span class="line">	<span class="type">const</span> President&amp; <span class="keyword">operator</span>=(<span class="type">const</span> President&amp;);<span class="comment">//assignment operator</span></span><br><span class="line"></span><br><span class="line">	string name;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">static</span> President&amp; <span class="title">GetInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="comment">//static objects are constructor only once</span></span><br><span class="line">		<span class="type">static</span> President onlyInstance;</span><br><span class="line">		<span class="keyword">return</span> onlyInstance;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">string <span class="title">GetName</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SetName</span><span class="params">(string InputName)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		name = InputName;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	President&amp; onlyPresident = President::<span class="built_in">GetInstance</span>();</span><br><span class="line">	onlyPresident.<span class="built_in">SetName</span>(<span class="string">&quot;Abraham Lincoln&quot;</span>);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The name of the President is: &quot;</span> &lt;&lt; President::<span class="built_in">GetInstance</span>().<span class="built_in">GetName</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>9.6.3 禁止在栈中实例化的类</strong></p>
<p>​	<strong>可声明一个私有的析构函数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 9.11 数据库类monsterDB,只能使用new在自由存储区创建其对象</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MonsterDB</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	~<span class="built_in">MonsterDB</span>() &#123;&#125;;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">DestroyInstance</span><span class="params">(MonsterDB* pInstance)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">delete</span> pInstance;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Dosomething</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	MonsterDB* myDB = <span class="keyword">new</span> <span class="built_in">MonsterDB</span>();</span><br><span class="line">	myDB-&gt;DestroyInstance;</span><br><span class="line"></span><br><span class="line">	myDB-&gt;<span class="built_in">DestroyInstance</span>(myDB);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>9.6.4 使用构造函数进行类型转换</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 使用explicit避免无意间的隐式转换</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">explicit</span> <span class="title">Human</span><span class="params">(<span class="type">int</span> humansAge)</span> : age(humansAge)&#123;</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DoSomething</span><span class="params">(Human person)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Human sent did something&quot;</span> &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Human <span class="title">kid</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">	Human anotherKid = <span class="built_in">Human</span>(<span class="number">11</span>);</span><br><span class="line">	<span class="built_in">DoSomething</span>(kid);</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Human anotherKid2 = 11; //failure: implicit conversion not OK</span></span><br><span class="line">	<span class="comment">//DoSomething(10); //implicit conversion</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-10-声明友元"><a href="#9-10-声明友元" class="headerlink" title="9.10 声明友元"></a>9.10 声明友元</h2><p>​	<strong>不能从外部访问类的私有数据成员和方法，但这条规则不适用于友元类和友元函数。要声明友元函数或友元类，可使用friend关键字</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 9.14 使用friend关键字让外部函数DisplayAge()能够访问私有数据成员</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="keyword">friend</span> <span class="type">void</span> <span class="title">DisplayAge</span><span class="params">(<span class="type">const</span> Human&amp; person)</span></span>;</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">explicit</span> <span class="title">Human</span><span class="params">(string HumansName,<span class="type">int</span> humansAge)</span> :name(HumansName), age(humansAge)&#123;</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DisplayAge</span><span class="params">(<span class="type">const</span> Human&amp; person)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; person.age &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Human <span class="title">firstMan</span><span class="params">(<span class="string">&quot;Adam&quot;</span>, <span class="number">25</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Accessing private member age via friend function: &quot;</span>;</span><br><span class="line">	<span class="built_in">DisplayAge</span>(firstMan);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 9.14 使用friend关键字让外部l类Utility能够访问私有数据成员</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">friend</span> <span class="keyword">class</span> <span class="title class_">Utility</span>;</span><br><span class="line">	string name;</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">explicit</span> <span class="title">Human</span><span class="params">(string HumansName,<span class="type">int</span> humansAge)</span> :name(HumansName), age(humansAge)&#123;</span>&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Utility</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">static</span> <span class="type">void</span> <span class="title">DisplayAge</span><span class="params">(<span class="type">const</span> Human&amp; person)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; person.age &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Human <span class="title">firstMan</span><span class="params">(<span class="string">&quot;Adam&quot;</span>, <span class="number">25</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Accessing private member age via friend class: &quot;</span>;</span><br><span class="line">	Utility::<span class="built_in">DisplayAge</span>(firstMan);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-15-作业"><a href="#9-15-作业" class="headerlink" title="9.15 作业"></a>9.15 作业</h2><p><strong>9.15.1 测验</strong></p>
<ol>
<li><p><strong>使用new创建类实例时，将在什么地方创建它？</strong></p>
<p><strong>答</strong>：堆区</p>
</li>
<li><p><strong>我的类包含一个原始指针int*，它指向一个动态分配的int 数组。请问将sizeof 用于这个类的 对象时，结果是否取决于该动态数组包含的元素数？</strong></p>
<p><strong>答</strong>：否</p>
</li>
<li><p><strong>假设有一个类，其所有成员都是私有的，且没有友元类和友元函数。请问谁能访问这些成员？</strong></p>
<p><strong>答</strong>：设置成员函数get和set方法</p>
</li>
<li><p><strong>可以在一个类成员方法中调用另一个成员方法吗？</strong></p>
<p><strong>答</strong>：可以</p>
</li>
<li><p><strong>构造函数适合做什么？</strong></p>
<p><strong>答</strong>：初始化成员变量</p>
</li>
<li><p><strong>构造函数适合做什么？</strong></p>
<p><strong>答</strong>：重置变量以及释放动态分配的内存</p>
</li>
</ol>
<p><strong>9.15.2 练习</strong></p>
<ol>
<li><p><strong>查错：下面的类声明有什么错误？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Class Human</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    string name;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Human</span>()&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：类声明关键字错误且没有声明完成后加上分号</p>
</li>
<li><p><strong>练习1所示类的用户如何访问成员Human::age？</strong></p>
<p><strong>答</strong>：1.使用友元函数进行访问</p>
<p>​		2.设置成员函数get和set方法</p>
</li>
<li><p>**对练习1中的类进行修改，在构造函数中使用初始化列表对所有参数进行初始化。 **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Human</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    string name;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Human</span>(string humansName,<span class="type">int</span> humansAge):age&#123;humansAge&#125;,name&#123;humansName&#125;&#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写一个 Circle 类，它根据实例化时提供的半径计算面积和周长。将 Pi 包含在一个私有成员 常量中，该常量不能在类外访问。</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Circle</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Circle</span>(<span class="type">double</span> r = <span class="number">0</span>) : radius&#123;r&#125;&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">GetArea</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> radius * radius * Pi;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">GetCircumference</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="number">2</span> * radius * Pi;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">double</span> radius;</span><br><span class="line">	<span class="type">const</span> <span class="type">double</span> Pi = <span class="number">3.14</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第十章"><a href="#第十章" class="headerlink" title="第十章"></a>第十章</h1><h2 id="10-1-继承基础"><a href="#10-1-继承基础" class="headerlink" title="10.1 继承基础"></a>10.1 继承基础</h2><p><strong>10.1.2 C++派生语法</strong>  </p>
<p>​	c++派生语法如下</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Derived</span> : access-specifier Base</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单10.1 鱼类世界呈现的一种简单的继承层次结构</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="type">bool</span> isFreshWaterFish;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (isFreshWaterFish) &#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Swims in lake&quot;</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Swims in sea&quot;</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tuna</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Tuna</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		isFreshWaterFish = <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Carp</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Carp</span>() </span><br><span class="line">	&#123;</span><br><span class="line">		isFreshWaterFish = <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Carp myLunch;</span><br><span class="line">	Tuna myDinner;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;About my food: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	myLunch.<span class="built_in">swim</span>();</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Dinner&quot;</span> &lt;&lt; endl;</span><br><span class="line">	myDinner.<span class="built_in">swim</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>10.1.3 访问限定符protected</strong></p>
<p>​	<strong>需要让基类的某些属性能在派生类中的访问，但不能在继承层次外部访问，可使用protected关键字</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单10.2 一种更好的Fish类设计，可使用关键字protected将成员属性暴露给派生类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="type">bool</span> isFreshWaterFish;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (isFreshWaterFish) &#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Swims in lake&quot;</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Swims in sea&quot;</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tuna</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Tuna</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		isFreshWaterFish = <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Carp</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Carp</span>() </span><br><span class="line">	&#123;</span><br><span class="line">		isFreshWaterFish = <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Carp myLunch;</span><br><span class="line">	Tuna myDinner;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;About my food: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	myLunch.<span class="built_in">swim</span>();</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Dinner&quot;</span> &lt;&lt; endl;</span><br><span class="line">	myDinner.<span class="built_in">swim</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>10.1.4 基类初始化——向基类传递参数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单10.3 包含初始化列表的派生类构造函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">protected</span>:</span><br><span class="line">	<span class="type">bool</span> isFreshWaterFish;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Fish</span>(<span class="type">bool</span> isFreshWater) : <span class="built_in">isFreshWaterFish</span>(isFreshWater)&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (isFreshWaterFish) &#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Swims in lake&quot;</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Swims in sea&quot;</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tuna</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Tuna</span>() : <span class="built_in">Fish</span>(<span class="literal">false</span>)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Carp</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Carp</span>() : <span class="built_in">Fish</span>(<span class="literal">true</span>)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Carp myLunch;</span><br><span class="line">	Tuna myDinner;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;About my food: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	myLunch.<span class="built_in">swim</span>();</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Dinner&quot;</span> &lt;&lt; endl;</span><br><span class="line">	myDinner.<span class="built_in">swim</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>10.1.5 在派生类中覆盖基类的方法</strong></p>
<p>​	<strong>如果派生类实现了基类的函数，且返回值和特征标相同，相当于覆盖了基类的这个方法，如果使用派生类去调用这个方法，将不在调用基类的方法，而是自己的方法</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单10.4 派生类Tuna和Carp覆盖了基类fish的方法Swim</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">bool</span> isFreshWaterFish;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Fish</span>(<span class="type">bool</span> isFreshWater) : <span class="built_in">isFreshWaterFish</span>(isFreshWater)&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (isFreshWaterFish) &#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Swims in lake&quot;</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Swims in sea&quot;</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tuna</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Tuna</span>() : <span class="built_in">Fish</span>(<span class="literal">false</span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Tuna swims real fast&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Carp</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Carp</span>() : <span class="built_in">Fish</span>(<span class="literal">true</span>)&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Carp siwms real slow&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Carp myLunch;</span><br><span class="line">	Tuna myDinner;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;About my food: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	myLunch.<span class="built_in">swim</span>();</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Dinner&quot;</span> &lt;&lt; endl;</span><br><span class="line">	myDinner.<span class="built_in">swim</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>10.1.6 调用基类中被覆盖的方法和方法</strong></p>
<p>​	<strong>使用作用域解析运算符（::）</strong></p>
<p>​	<code>myDinner.Fish::Swim();</code></p>
<h2 id="10-2-私有继承"><a href="#10-2-私有继承" class="headerlink" title="10.2 私有继承"></a>10.2 私有继承</h2><p>​	<strong>私有继承意味着派生类的实例中，基类的所有公有成员和方法都是私有的——不能从外部访问，即便是Base类的公有成员和方法，也只能被Derived类使用，而无法通过Derived实例来使用它们</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单10.8 Car类以私有方式继承Motor类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Motor</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SwithcIgnition</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Ignition ON&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">PumpFuel</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Fuel in cylinders&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">FireCylinders</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Vroooom&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span> : <span class="keyword">private</span> Motor</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Move</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">SwithcIgnition</span>();</span><br><span class="line">		<span class="built_in">PumpFuel</span>();</span><br><span class="line">		<span class="built_in">FireCylinders</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Car myDreamCar;</span><br><span class="line">	myDreamCar.<span class="built_in">Move</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="10-3-保护继承"><a href="#10-3-保护继承" class="headerlink" title="10.3 保护继承"></a>10.3 保护继承</h2><p>​	<strong>保护继承和私有继承的类似之处</strong>  </p>
<ul>
<li>它也表示has-a关系；</li>
<li>它也让派生类能够访问基类的所用公有和保护对象</li>
<li>在继承层次结构外面，也不能通过派生类实例访问基类的公有成员</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//情绪清单10.9 RaceCar类以保护方式继承了Car类，而Car以保护方式继承了Motor类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Motor</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">SwithcIgnition</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Ignition ON&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">PumpFuel</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Fuel in cylinders&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">FireCylinders</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Vroooom&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span> : <span class="keyword">protected</span> Motor</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Move</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">SwithcIgnition</span>();</span><br><span class="line">		<span class="built_in">PumpFuel</span>();</span><br><span class="line">		<span class="built_in">FireCylinders</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RaceCar</span> : <span class="keyword">protected</span> Car</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Move</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">SwithcIgnition</span>(); <span class="comment">//RaceCar Has access to members of</span></span><br><span class="line">		<span class="built_in">PumpFuel</span>(); <span class="comment">//base Motor due to &quot;protected&quot; inheritance</span></span><br><span class="line">		<span class="built_in">FireCylinders</span>(); <span class="comment">//between RaceCar &amp; Car, Car &amp; Motor</span></span><br><span class="line">		<span class="built_in">FireCylinders</span>();</span><br><span class="line">		<span class="built_in">FireCylinders</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	RaceCar myDreamCar;</span><br><span class="line">	myDreamCar.<span class="built_in">Move</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="10-9-作业"><a href="#10-9-作业" class="headerlink" title="10.9 作业"></a>10.9 作业</h2><p><strong>10.9.1 测试</strong>  </p>
<ol>
<li><p>**我希望基类的某些成员可在派生类中访问，但不能在继承层次结构外访问，该使用哪种访问限定符？  **</p>
<p><strong>答</strong>：protected</p>
</li>
<li><p><strong>如果一个函数接受一个基类对象作为参数，而我将一个派生类对象作为实参按值传递给它，结果将如何？</strong></p>
<p><strong>答</strong>：  会导致切除问题</p>
</li>
<li><p>**该使用私有继承还是组合？  **</p>
<p><strong>答</strong>：使用组合，这样可以提高设计的灵活性</p>
</li>
<li><p>**在继承层次结构中，关键字using有何用途？  **</p>
<p><strong>答</strong>：避免隐藏基类方法</p>
</li>
<li><p><strong>Derived 类以私有方式继承了 Base 类，而 SubDerived 类以公有方式继承了 Derived 类。请问 SubDerived 类能访问Base 类的公有成员吗？</strong></p>
<p><strong>答</strong>：不能</p>
</li>
</ol>
<p><strong>10.9.2 实践</strong></p>
<ol>
<li><p>**创建程序清单10.10所示的Platypus对象时，将以什么样的顺序调用构造函数？ **</p>
<p><strong>答</strong>:</p>
<ul>
<li>构造函数：Mammal、Bird、Reptile、Platypus</li>
<li>析构函数：Platypus、Reptile、Bird、Mammal</li>
</ul>
</li>
<li><p>**使用代码说明Polygon、Triangle和Shape类之间的关系。  **</p>
<p><strong>答</strong>:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Shape</span> &#123;&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Polygon</span> : <span class="keyword">public</span> Shape &#123;&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Triangle</span> : <span class="keyword">public</span> Polygon &#123;&#125;;</span><br></pre></td></tr></table></figure>


</li>
<li><p>**D2 类继承了D1类，而D1类继承了Base类。要禁止D2访问Base的公有方法，应使用哪种 访问限定符？在什么地方使用？  **</p>
<p><strong>答</strong>:应该在D1类继承Base类时使用private关键字</p>
</li>
<li><p>**下面的代码表示哪种继承关系？  **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Derived</span>: Base </span><br><span class="line">&#123; </span><br><span class="line">   <span class="comment">// ... Derived members </span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>:私有继承</p>
</li>
<li><p>**查错：下述代码有何问题？  **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Derived</span>: <span class="keyword">public</span> Base </span><br><span class="line">&#123; </span><br><span class="line">   <span class="comment">// ... Derived members </span></span><br><span class="line">&#125;; </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">SomeFunc</span> <span class="params">(Base value)</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">   <span class="comment">// </span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><strong>答</strong>: 会导致切除问题</p>
</li>
</ol>
<h1 id="第十一章"><a href="#第十一章" class="headerlink" title="第十一章"></a>第十一章</h1><h2 id="11-1-多态基础"><a href="#11-1-多态基础" class="headerlink" title="11.1 多态基础"></a>11.1 多态基础</h2><p><strong>11.1.1 为何需要多态行为</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单11.1 将Tuna实例传递给Fish参数，并通过参数调用方法</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Fish swims!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tuna</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Tuna swims&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span>  <span class="title">MakeFishSwim</span><span class="params">(Fish&amp; inputFish)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	inputFish.<span class="built_in">Swim</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Tuna myDinner;</span><br><span class="line">	myDinner.<span class="built_in">Swim</span>();</span><br><span class="line">	<span class="built_in">MakeFishSwim</span>(myDinner);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>11.1.2 使用虚函数实现多态行为</strong></p>
<p>​	<strong>通过使用virtual关键字，可确保编译器调用覆盖版本</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> ReturnType <span class="title">FunctionName</span><span class="params">(Parameter List)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Derived</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function">TeturnType <span class="title">FunctionName</span><span class="params">(Parameter List)</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 11.2 将Fish::Swim()声明为虚函数带来的影响</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">Swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Fish swims!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tuna</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Tuna swims&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Carp</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Siwm</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Carp swims!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span>  <span class="title">MakeFishSwim</span><span class="params">(Fish&amp; inputFish)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	inputFish.<span class="built_in">Swim</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Tuna myDinner;</span><br><span class="line">	Carp myLunch;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">MakeFishSwim</span>(myDinner);</span><br><span class="line">	<span class="built_in">MakeFishSwim</span>(myLunch);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>11.1.3 为何需要虚析构函数</strong> </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 11.3 在函数中通过基类指针调用运算符delete</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Fish</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Consturcted Fish&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">Fish</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Destroyed Fish&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tuna</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Tuna</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Consturcted Tuna&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">Tuna</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Destroyed Tuna&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DeleteFishMemory</span><span class="params">(Fish *pFish)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">delete</span> pFish;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Allocating a Tuna on The Free store:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	Tuna* pTuna = <span class="keyword">new</span> Tuna;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Deleteing the Tuna: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">DeleteFishMemory</span>(pTuna);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Instantiating a Tuna on the stack:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	Tuna myDinner;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Automatic destruction as it goes out of scope: &quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单11.4 将析构函数声明为虚函数，确保通过基类指针调用delete时，将调用派生类的析构函数</span></span><br><span class="line"><span class="comment">//程序清单 11.3 在函数中通过基类指针调用运算符delete</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Fish</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Consturcted Fish&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">virtual</span> ~<span class="built_in">Fish</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Destroyed Fish&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tuna</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Tuna</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Consturcted Tuna&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">Tuna</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Destroyed Tuna&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DeleteFishMemory</span><span class="params">(Fish *pFish)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">delete</span> pFish;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Allocating a Tuna on The Free store:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	Tuna* pTuna = <span class="keyword">new</span> Tuna;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Deleteing the Tuna: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">DeleteFishMemory</span>(pTuna);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Instantiating a Tuna on the stack:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	Tuna myDinner;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Automatic destruction as it goes out of scope: &quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>11.1.4 虚函数的工作原理——理解虚函数表</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单11.5 对两个相同的类（一个包含虚函数，另一个不包含）进行比较，证明确实存在隐藏的虚函数指针表</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SimpleClass</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> a, b;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">DoSomething</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Base</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> a, b;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">DoSomething</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;sizeof(simpleClass) = &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(SimpleClass) &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;sizeof(Base) = &quot;</span> &lt;&lt; <span class="built_in">sizeof</span>(Base) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>11.1.5 抽象基类和纯虚函数</strong></p>
<p>​	<strong>不能实例化的基类被称为抽象基类，这样的基类只有一个用途，那就是从它派生出其他类，要创建抽象基类，可声明纯虚函数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">AbstractBase</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">DoSomething</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//该声明告诉编译器，AbstactBase的派生类必须实现方法DoSomething()</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Derived</span> : <span class="keyword">public</span> AbstractBase</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">DoSomething</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Implemented virtual function&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单11.6 Fish和Tuan和Crap的抽象基类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">Swim</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tuna</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Tuna swims fast in the sea! &quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Carp</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Carp swims slow in the lake!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MakeFishSwim</span><span class="params">(Fish&amp; inputFish)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	inputFish.<span class="built_in">Swim</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Carp myLunch;</span><br><span class="line">	Tuna myDinner;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">MakeFishSwim</span>(myLunch);</span><br><span class="line">	<span class="built_in">MakeFishSwim</span>(myDinner);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="11-2-使用虚继承解决菱形问题"><a href="#11-2-使用虚继承解决菱形问题" class="headerlink" title="11.2 使用虚继承解决菱形问题"></a>11.2 使用虚继承解决菱形问题</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单11.8 在继承层次结构中使用virtual关键字，将基类Animal的实例个数限定为1</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Animal</span>() </span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Animal constructor&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Mammal</span> : <span class="keyword">public</span> <span class="keyword">virtual</span> Animal &#123;&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Bird</span> : <span class="keyword">public</span> <span class="keyword">virtual</span> Animal &#123;&#125;;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Reptile</span> : <span class="keyword">public</span> <span class="keyword">virtual</span> Animal&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Platypus</span> <span class="keyword">final</span> : <span class="keyword">public</span> Mammal, <span class="keyword">public</span> Bird, <span class="keyword">public</span> Reptile</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Platypus</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Platpus constructor&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Platypus duckBilledP;</span><br><span class="line">	duckBilledP.age = <span class="number">25</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="11-3-表面覆盖意图的限定符override"><a href="#11-3-表面覆盖意图的限定符override" class="headerlink" title="11.3 表面覆盖意图的限定符override"></a>11.3 表面覆盖意图的限定符override</h2><p>​	<strong>override会让编译器做如下检查</strong>  </p>
<ul>
<li>基类函数是否是虚函数</li>
<li>基类中相应虚函数的特征标是否于派生类中被声明为override的函数完全相同</li>
</ul>
<h2 id="11-4-使用final来禁止覆盖函数"><a href="#11-4-使用final来禁止覆盖函数" class="headerlink" title="11.4 使用final来禁止覆盖函数"></a>11.4 使用final来禁止覆盖函数</h2><p>​	<strong>被声明为final的类不能用作基类，同样，对于被声明为final的虚函数，不能在派生类中进行覆盖</strong></p>
<h2 id="11-5-可将复制构造函数声明为虚函数吗"><a href="#11-5-可将复制构造函数声明为虚函数吗" class="headerlink" title="11.5 可将复制构造函数声明为虚函数吗"></a>11.5 可将复制构造函数声明为虚函数吗</h2><p>​	<strong>不能，因为在基类方法声明中使用了virtual，表示它将被派生的类实现覆盖，这种多态的行为是在运行阶段实现的。而构造函数只能创建固定类型的对象，不具备多态性</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单11.9 Tuna和Carp包含Clone函数，它们模拟了虚复制构造函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> Fish* <span class="title">Clone</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">Swim</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">virtual</span> ~<span class="built_in">Fish</span>() &#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tuna</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function">Fish* <span class="title">Clone</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Tuna</span> (*<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span> <span class="keyword">override</span> <span class="keyword">final</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Tuan swims fast in the sea&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">BluefinTuna</span> <span class="keyword">final</span> : <span class="keyword">public</span> Tuna</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function">Fish* <span class="title">Clone</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span>  <span class="keyword">new</span> <span class="built_in">BluefinTuna</span>(*<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//Cannot override Tuna::Swim as it is &quot;final&quot; in Tuna</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Carp</span> <span class="keyword">final</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line">	<span class="function">Fish* <span class="title">Clone</span><span class="params">()</span> <span class="keyword">override</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Carp</span>(*<span class="keyword">this</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span> <span class="keyword">override</span> <span class="keyword">final</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Carp swims slow in the lake&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> ARRAY_SIZE = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">	Fish* myFishes[ARRAY_SIZE] = &#123; <span class="literal">NULL</span> &#125;;</span><br><span class="line">	myFishes[<span class="number">0</span>] = <span class="keyword">new</span> <span class="built_in">Tuna</span>();</span><br><span class="line">	myFishes[<span class="number">1</span>] = <span class="keyword">new</span> <span class="built_in">Carp</span>();</span><br><span class="line">	myFishes[<span class="number">2</span>] = <span class="keyword">new</span> <span class="built_in">BluefinTuna</span>();</span><br><span class="line">	myFishes[<span class="number">3</span>] = <span class="keyword">new</span> <span class="built_in">Carp</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	Fish* myNewFishers[ARRAY_SIZE];</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ARRAY_SIZE; i++) &#123;</span><br><span class="line">		myNewFishers[i] = myFishes[i]-&gt;<span class="built_in">Clone</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ARRAY_SIZE; i++) &#123;</span><br><span class="line">		myNewFishers[i]-&gt;<span class="built_in">Swim</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; ARRAY_SIZE; i++) &#123;</span><br><span class="line">		<span class="keyword">delete</span> myFishes[i];</span><br><span class="line">		<span class="keyword">delete</span> myNewFishers[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="11-8-作业"><a href="#11-8-作业" class="headerlink" title="11.8 作业"></a>11.8 作业</h2><p><strong>11.8 测验</strong></p>
<ol>
<li><p>**假设您要模拟形状—圆和三角形，并要求每个形成都必须实现函数Area( )和Print( )。您该怎么办？  **</p>
<p><strong>答</strong>：把Area和Print声明成纯虚函数</p>
</li>
<li><p><strong>编译器为每个类都创建虚函数表吗？</strong>  </p>
<p><strong>答</strong>：只有在使用了virtual关键字后才会创建</p>
</li>
<li><p><strong>我编写了一个Fish类，它有两个公有方法、一个纯虚函数和几个成员属性。这个类是抽象基类吗？</strong></p>
<p><strong>答</strong>：是</p>
</li>
</ol>
<p><strong>11.8.2 练习</strong></p>
<ol>
<li><p>**创建一个继承层次结构，实现测验1中的Circle和Triangle类。  **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Shape</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">double</span> <span class="title">Area</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">Print</span><span class="params">()</span> </span>= <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">virtual</span> ~<span class="built_in">Shape</span>() &#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Circle</span> : <span class="keyword">public</span> Shape</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">Area</span><span class="params">()</span> <span class="keyword">override</span></span>&#123;&#125;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span> <span class="keyword">override</span></span>&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Triangle</span> : <span class="keyword">public</span> Shape</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">double</span> <span class="title">Area</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123;&#125;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span> <span class="keyword">override</span> </span>&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


</li>
<li><p>**差错：下面的代码有何问题？ **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Vehicle</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Vehicle</span>()&#123;&#125;</span><br><span class="line">    ~<span class="built_in">Vehicle</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Car</span> : <span class="keyword">public</span> Vehicle</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Car</span>()&#123;&#125;</span><br><span class="line">	<span class="built_in">Car</span>()&#123;&#125;	   </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：基类 <code>Vehicle</code> 的析构函数不是虚函数。这可能导致内存泄漏或资源未正确释放的风险。</p>
</li>
<li><p>**给定练习2所示的（错误）代码，像下面这样创建并销毁Car实例时，将按什么样的顺序执行 构造函数和析构函数？ ** </p>
<p><code>Vehicle* pMyRacer = new Car;  </code></p>
<p><code>delete pMyRacer;</code></p>
<p><strong>答</strong>：先调用Vehicle的构造函数，在调用Car的构造函数，delete时在调用Vehicle的析构函数</p>
</li>
</ol>
<h1 id="第十二章"><a href="#第十二章" class="headerlink" title="第十二章"></a>第十二章</h1><h2 id="12-2-单目运算符"><a href="#12-2-单目运算符" class="headerlink" title="12.2 单目运算符"></a>12.2 单目运算符</h2><p>​	<strong>12.2.2 单目递增与单目递减运算符</strong></p>
<ul>
<li><p>在类中声明单目前缀递增运算符语法</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Date&amp; <span class="keyword">operator</span>++()</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//operator implementation code</span></span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在类中声明单目后缀递增运算符语法</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Date&amp; <span class="keyword">operator</span>++(<span class="type">int</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//store a copy of the current state of the object, before incrementing day</span></span><br><span class="line">    <span class="function">Date <span class="title">copy</span><span class="params">(*<span class="keyword">this</span>)</span></span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//increment implementation code</span></span><br><span class="line">    <span class="comment">//return state before increment(because,postfix)</span></span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>​	前缀和后缀的语法相似，只是将声明中的++替换成了–</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单12.1 一个处理日、月、年的日历类，可对日期执行递增和递减操作</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Date</span>(<span class="type">int</span> inMonth,<span class="type">int</span> inDay,<span class="type">int</span> inYear) </span><br><span class="line">		: month&#123;inMonth&#125;,day&#123;inDay&#125;,year&#123;inYear&#125;&#123;&#125;</span><br><span class="line"></span><br><span class="line">	Date&amp; <span class="keyword">operator</span>++()</span><br><span class="line">	&#123;</span><br><span class="line">		++day;</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Date&amp; <span class="keyword">operator</span>--()</span><br><span class="line">	&#123;</span><br><span class="line">		--day;</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">DisplayDate</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; month &lt;&lt; <span class="string">&quot; / &quot;</span> &lt;&lt; day &lt;&lt; <span class="string">&quot; / &quot;</span> &lt;&lt; year &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">int</span> day, month, year;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Date <span class="title">holiday</span><span class="params">(<span class="number">12</span>, <span class="number">25</span>, <span class="number">2016</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>12.2.3 转换运算符</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单12.2 在Date类中实现转换运算符的简单实现</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Date</span>(<span class="type">int</span> inMonth,<span class="type">int</span> inDay,<span class="type">int</span> inYear) </span><br><span class="line">		: month&#123;inMonth&#125;,day&#123;inDay&#125;,year&#123;inYear&#125;&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="type">const</span> <span class="type">char</span>* ()</span><br><span class="line">	&#123;</span><br><span class="line">		ostringstream formattedDate;</span><br><span class="line">		formattedDate &lt;&lt; month &lt;&lt; <span class="string">&quot; / &quot;</span> &lt;&lt; day &lt;&lt; <span class="string">&quot; / &quot;</span> &lt;&lt; year;</span><br><span class="line">		dateInString = formattedDate.<span class="built_in">str</span>();</span><br><span class="line">		<span class="keyword">return</span> dateInString.<span class="built_in">c_str</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">int</span> day, month, year;</span><br><span class="line">	string dateInString;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Date <span class="title">holiday</span><span class="params">(<span class="number">12</span>, <span class="number">25</span>, <span class="number">2016</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Holiday is on:&quot;</span> &lt;&lt; holiday &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>12.2.4 解除引用运算符（*）和成员选择运算符(-&gt;)</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Date</span>(<span class="type">int</span> inMonth,<span class="type">int</span> inDay,<span class="type">int</span> inYear) </span><br><span class="line">		: month&#123;inMonth&#125;,day&#123;inDay&#125;,year&#123;inYear&#125;&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">DisplayDate</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; month &lt;&lt; <span class="string">&quot;/ &quot;</span> &lt;&lt; day &lt;&lt; <span class="string">&quot; / &quot;</span> &lt;&lt; year &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">int</span> day, month, year;</span><br><span class="line">	string dateInString;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">unique_ptr&lt;<span class="type">int</span>&gt; <span class="title">smartIntPtr</span><span class="params">(<span class="keyword">new</span> <span class="type">int</span>)</span></span>;</span><br><span class="line">	*smartIntPtr = <span class="number">42</span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Integer value is: &quot;</span> &lt;&lt; *smartIntPtr &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="function">unique_ptr&lt;Date&gt; <span class="title">smartHoliday</span><span class="params">(<span class="keyword">new</span> Date(<span class="number">12</span>, <span class="number">25</span>, <span class="number">2016</span>))</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The new instance of date contains: &quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	smartHoliday-&gt;<span class="built_in">DisplayDate</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12-3-双目运算符"><a href="#12-3-双目运算符" class="headerlink" title="12.3 双目运算符"></a>12.3 双目运算符</h2><p>​	<strong>以全局函数或静态成员的方式实现的双目运算符</strong></p>
<p>​	<code>return_type operator_type(parameter1,parameter2);</code></p>
<p>​	<strong>以类成员的方式实现的双目运算符</strong></p>
<p>​	<code>return_type operator_type(parameter);</code></p>
<p><strong>12.3.2 双目加法和减法运算符</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单12.4 实现了双目加减法日历类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Date</span>(<span class="type">int</span> inMonth,<span class="type">int</span> inDay,<span class="type">int</span> inYear) </span><br><span class="line">		: month&#123;inMonth&#125;,day&#123;inDay&#125;,year&#123;inYear&#125;&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">DisplayDate</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; month &lt;&lt; <span class="string">&quot;/ &quot;</span> &lt;&lt; day &lt;&lt; <span class="string">&quot; / &quot;</span> &lt;&lt; year &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Date <span class="keyword">operator</span>+(<span class="type">int</span> daysToAdd)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="function">Date <span class="title">newDate</span><span class="params">(month, day + daysToAdd, year)</span></span>;</span><br><span class="line">		<span class="keyword">return</span> newDate;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	Date <span class="keyword">operator</span>-(<span class="type">int</span> daysToAdd)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="function">Date <span class="title">newDate</span><span class="params">(month, day - daysToAdd, year)</span></span>;</span><br><span class="line">		<span class="keyword">return</span> newDate;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">int</span> day, month, year;</span><br><span class="line">	string dateInString;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Date <span class="title">Holiday</span><span class="params">(<span class="number">12</span>, <span class="number">25</span>, <span class="number">2016</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Holiday on: &quot;</span>;</span><br><span class="line">	Holiday.<span class="built_in">DisplayDate</span>();</span><br><span class="line"></span><br><span class="line">	<span class="function">Date <span class="title">PreviousHoliday</span><span class="params">(Holiday - <span class="number">19</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Previous holiday on: &quot;</span>;</span><br><span class="line">	PreviousHoliday.<span class="built_in">DisplayDate</span>();</span><br><span class="line"></span><br><span class="line">	<span class="function">Date <span class="title">NextHoliday</span><span class="params">(Holiday + <span class="number">6</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Next Holiday on: &quot;</span>;</span><br><span class="line">	NextHoliday.<span class="built_in">DisplayDate</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>13.3.3 实现运算符+&#x3D;与-&#x3D;</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单12.5 定义运算符+=和-=，以便将日历向前或向后翻整型输入参数指定天数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Date</span>(<span class="type">int</span> inMonth,<span class="type">int</span> inDay,<span class="type">int</span> inYear) </span><br><span class="line">		: month&#123;inMonth&#125;,day&#123;inDay&#125;,year&#123;inYear&#125;&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">DisplayDate</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; month &lt;&lt; <span class="string">&quot;/ &quot;</span> &lt;&lt; day &lt;&lt; <span class="string">&quot; / &quot;</span> &lt;&lt; year &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">void</span> <span class="keyword">operator</span>+=(<span class="type">int</span> daysToAdd)</span><br><span class="line">	&#123;</span><br><span class="line">		day += daysToAdd;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="type">void</span> <span class="keyword">operator</span>-=(<span class="type">int</span> daysToAdd)</span><br><span class="line">	&#123;</span><br><span class="line">		day -= daysToAdd;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">int</span> day, month, year;</span><br><span class="line">	string dateInString;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Date <span class="title">Holiday</span><span class="params">(<span class="number">12</span>, <span class="number">25</span>, <span class="number">2016</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Holiday is on: &quot;</span>;</span><br><span class="line">	Holiday.<span class="built_in">DisplayDate</span>();</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;holiday -= 9 gives: &quot;</span>;</span><br><span class="line">	Holiday -= <span class="number">9</span>;</span><br><span class="line">	Holiday.<span class="built_in">DisplayDate</span>();</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;holiday += 25 gives: &quot;</span>;</span><br><span class="line">	Holiday += <span class="number">25</span>;</span><br><span class="line">	Holiday.<span class="built_in">DisplayDate</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>12.3.4 重载等于运算符（&#x3D;&#x3D;）和不等于运算符（!&#x3D;）</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单12.6 运算符==和!=</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Date</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Date</span>(<span class="type">int</span> inMonth,<span class="type">int</span> inDay,<span class="type">int</span> inYear) </span><br><span class="line">		: month&#123;inMonth&#125;,day&#123;inDay&#125;,year&#123;inYear&#125;&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">DisplayDate</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; month &lt;&lt; <span class="string">&quot;/ &quot;</span> &lt;&lt; day &lt;&lt; <span class="string">&quot; / &quot;</span> &lt;&lt; year &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span> ==(<span class="type">const</span> Date&amp; compareTo)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">return</span> ( day == compareTo.day &amp;&amp;</span><br><span class="line">				 month == compareTo.month &amp;&amp;</span><br><span class="line">				 year == compareTo.year</span><br><span class="line">				);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span> !=(<span class="type">const</span> Date&amp; compareTo)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> !(*<span class="keyword">this</span> == compareTo);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">int</span> day, month, year;</span><br><span class="line">	string dateInString;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Date <span class="title">Holiday1</span><span class="params">(<span class="number">12</span>, <span class="number">25</span>, <span class="number">2016</span>)</span></span>;</span><br><span class="line">	<span class="function">Date <span class="title">Holiday2</span><span class="params">(<span class="number">12</span>, <span class="number">31</span>, <span class="number">2016</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;holiday 1 is: &quot;</span>;</span><br><span class="line">	Holiday<span class="number">1.</span><span class="built_in">DisplayDate</span>();</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;holiday 2 is: &quot;</span>;</span><br><span class="line">	Holiday<span class="number">2.</span><span class="built_in">DisplayDate</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (Holiday1 == Holiday2) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Equality operator: The tow are on the same day&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Equality operator: The tow are on the different day&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (Holiday1 != Holiday2) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Equality operator: The tow are on the different day&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Equality operator: The tow are on the same day&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>12.3.6 重载复制赋值运算符（&#x3D;）</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单12.8 对程序清单9.9的MyString类进行改进，添加了赋值运算符</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyString</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">MyString</span>(<span class="type">const</span> <span class="type">char</span>* initialInput)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (initialInput != <span class="literal">NULL</span>) &#123;</span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(initialInput) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, initialInput);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			buffer = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line"></span><br><span class="line">	MyString&amp; <span class="keyword">operator</span>=(<span class="type">const</span> MyString&amp; copySource)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((<span class="keyword">this</span> != &amp;copySource) &amp;&amp; (copySource.buffer != <span class="literal">NULL</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (buffer) &#123;</span><br><span class="line">				<span class="keyword">delete</span> buffer;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(copySource.buffer) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, copySource.buffer);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">operator</span> <span class="type">const</span> <span class="type">char</span>* ()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> buffer;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">MyString</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">delete</span>[] buffer;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">char</span>* buffer;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">MyString <span class="title">string1</span><span class="params">(<span class="string">&quot;hello&quot;</span>)</span></span>;</span><br><span class="line">	<span class="function">MyString <span class="title">string2</span><span class="params">(<span class="string">&quot; World&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Before assignment: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; string1 &lt;&lt; string2 &lt;&lt; endl;</span><br><span class="line">	string2 = string1;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;After assignment string2 = string1&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; string1 &lt;&lt; string2 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>12.3.7 下标运算符</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单12.9 在MyString类中实现下标运算符，以便随机访问MyString::buffer包含的字符</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyString</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">MyString</span>(<span class="type">const</span> <span class="type">char</span>* initialInput)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (initialInput != <span class="literal">NULL</span>) &#123;</span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(initialInput) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, initialInput);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			buffer = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125; </span><br><span class="line"></span><br><span class="line">	<span class="built_in">MyString</span>(<span class="type">const</span> MyString&amp; copySource)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (copySource.buffer) &#123;</span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(copySource.buffer) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, copySource.buffer);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			buffer = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	MyString&amp; <span class="keyword">operator</span>=(<span class="type">const</span> MyString&amp; copySource)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((<span class="keyword">this</span> != &amp;copySource) &amp;&amp; (copySource.buffer != <span class="literal">NULL</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (buffer) &#123;</span><br><span class="line">				<span class="keyword">delete</span> buffer;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(copySource.buffer) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, copySource.buffer);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> <span class="type">char</span>&amp; <span class="keyword">operator</span>[](<span class="type">int</span> index) <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (index &lt; <span class="built_in">GetLength</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> buffer[index];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">GetLength</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">strlen</span>(buffer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">operator</span> <span class="type">const</span> <span class="type">char</span>* ()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> buffer;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">MyString</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(buffer != <span class="literal">NULL</span>)</span><br><span class="line">		<span class="keyword">delete</span>[] buffer;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">char</span>* buffer;</span><br><span class="line">	<span class="built_in">MyString</span>() &#123;&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Tupe a statement: &quot;</span>;</span><br><span class="line">	string strInput;</span><br><span class="line">	<span class="built_in">getline</span>(cin, strInput);</span><br><span class="line"></span><br><span class="line">	<span class="function">MyString <span class="title">youSaid</span><span class="params">(strInput.c_str())</span></span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Using operator[] for displaying your input: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; youSaid.<span class="built_in">GetLength</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; youSaid[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter index 0 - &quot;</span> &lt;&lt; youSaid.<span class="built_in">GetLength</span>() - <span class="number">1</span> &lt;&lt; <span class="string">&quot;: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; index;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Input character at zero-base position: &quot;</span> &lt;&lt; index;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot; is:&quot;</span> &lt;&lt; youSaid[index] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12-4-函数运算符operator"><a href="#12-4-函数运算符operator" class="headerlink" title="12.4 函数运算符operator()"></a>12.4 函数运算符operator()</h2><p>​	<strong>operator()让对象像函数，被称为函数运算符。函数运算符用于标准模板库(stl)，通常stl算法中，其用途包括决策。根据使用的操作数数量，像这样的函数被称为单目谓词和双目谓词</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单12.10 一个使用operator()实现的函数对象</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Display</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(string input)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; input &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Display displayFuncObj;</span><br><span class="line">	<span class="built_in">displayFuncObj</span>(<span class="string">&quot;Display this string!&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12-5-用于高性能编程的移动构造函数和移动赋值运算符"><a href="#12-5-用于高性能编程的移动构造函数和移动赋值运算符" class="headerlink" title="12.5 用于高性能编程的移动构造函数和移动赋值运算符"></a>12.5 用于高性能编程的移动构造函数和移动赋值运算符</h2><p>​	<strong>移动构造函数和移动赋值函数运算符乃性能优化功能，属于C++11标准的一部分，皆在避免不必要的临时值（当前语句执行完毕后就不再存在的右值）。对于那些管理动态分配的类，如动态数组类和字符串类</strong></p>
<p><strong>12.5.2 声明移动构造函数和移动赋值运算符</strong></p>
<p>​	<strong>移动构造函数的声明语法如下</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Sample</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Sample</span>(Sample&amp;&amp; moveSource) <span class="comment">// Move constructor, note &amp;&amp;</span></span><br><span class="line">	&#123;</span><br><span class="line">		ptrResource = moveSource.ptrResource;</span><br><span class="line">		moveSource.ptrResource = <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Sample&amp; <span class="keyword">operator</span>=(Sample&amp;&amp; moveSource) <span class="comment">//move assignment operator, note &amp;&amp;</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="keyword">this</span> != &amp;moveSource)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">delete</span>[] ptrResource;</span><br><span class="line">			ptrResource = moveSource.ptrResource;</span><br><span class="line">			moveSource.ptrResource = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">Sample</span>(); <span class="comment">// default constructor</span></span><br><span class="line">	<span class="built_in">Sample</span>(<span class="type">const</span> Sample&amp; copySource); <span class="comment">//copy constructor</span></span><br><span class="line">	Sample&amp; <span class="keyword">operator</span>&amp;(<span class="type">const</span> Sample&amp; copySource); <span class="comment">//copy assignment</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	Type* ptrResource;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 12.11 除复制构造函数和复制赋值运算符除外，还包含移动构造函数和移动赋值运算符的MyString类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyString</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">MyString</span>(<span class="type">const</span> <span class="type">char</span>* initialInput)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (initialInput != <span class="literal">NULL</span>) &#123;</span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(initialInput) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, initialInput);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			buffer = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">MyString</span>(<span class="type">const</span> MyString&amp; copySource)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (copySource.buffer) &#123;</span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(copySource.buffer) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, copySource.buffer);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			buffer = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">MyString</span>(MyString&amp;&amp; moveSrc) </span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Move constructor moves: &quot;</span> &lt;&lt; moveSrc.buffer &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">if</span> (moveSrc.buffer !=  <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			buffer = moveSrc.buffer;</span><br><span class="line">			moveSrc.buffer = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	MyString&amp; <span class="keyword">operator</span>=(<span class="type">const</span> MyString&amp; copySource)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> ((<span class="keyword">this</span> != &amp;copySource) &amp;&amp; (copySource.buffer != <span class="literal">NULL</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (buffer) &#123;</span><br><span class="line">				<span class="keyword">delete</span> buffer;</span><br><span class="line">			&#125;</span><br><span class="line"></span><br><span class="line">			buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">strlen</span>(copySource.buffer) + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(buffer, copySource.buffer);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	MyString&amp; <span class="keyword">operator</span>=(MyString&amp;&amp; moveSrc)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Move assignment op. moves: &quot;</span> &lt;&lt; moveSrc.buffer &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">if</span> (moveSrc.buffer != <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">delete</span> buffer;</span><br><span class="line">			buffer = moveSrc.buffer;</span><br><span class="line">			moveSrc.buffer = <span class="literal">NULL</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> <span class="type">char</span>&amp; <span class="keyword">operator</span>[](<span class="type">int</span> index) <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (index &lt; <span class="built_in">GetLength</span>())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">return</span> buffer[index];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">int</span> <span class="title">GetLength</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="built_in">strlen</span>(buffer);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">operator</span> <span class="type">const</span> <span class="type">char</span>* ()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> buffer;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	MyString <span class="keyword">operator</span>+(<span class="type">const</span> MyString&amp; addThis)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;operator + called: &quot;</span> &lt;&lt; endl;</span><br><span class="line">		MyString newStr;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (addThis.buffer != <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			newStr.buffer = <span class="keyword">new</span> <span class="type">char</span>[<span class="built_in">GetLength</span>() + addThis.<span class="built_in">GetLength</span>() + <span class="number">1</span>];</span><br><span class="line">			<span class="built_in">strcpy</span>(newStr.buffer, buffer);</span><br><span class="line">			<span class="built_in">strcpy</span>(newStr.buffer, addThis.buffer);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> newStr;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="built_in">MyString</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (buffer != <span class="literal">NULL</span>)</span><br><span class="line">			<span class="keyword">delete</span>[] buffer;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">char</span>* buffer;</span><br><span class="line">	<span class="built_in">MyString</span>() : buffer&#123;<span class="literal">NULL</span>&#125; </span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Default constructor called&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">MyString <span class="title">Hello</span><span class="params">(<span class="string">&quot;Hello&quot;</span>)</span></span>;</span><br><span class="line">	<span class="function">MyString <span class="title">World</span><span class="params">(<span class="string">&quot;World&quot;</span>)</span></span>;</span><br><span class="line">	<span class="function">MyString <span class="title">CPP</span><span class="params">(<span class="string">&quot; of C++&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">MyString <span class="title">sayHelloAgain</span><span class="params">(<span class="string">&quot;overwrite this&quot;</span>)</span></span>;</span><br><span class="line">	sayHelloAgain = Hello + World + CPP;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12-6-用户自定义的字面值"><a href="#12-6-用户自定义的字面值" class="headerlink" title="12.6 用户自定义的字面值"></a>12.6 用户自定义的字面值</h2><p>​	<strong>要自定义字面量，可像下面这样定义operator””</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ReturnType opeator <span class="string">&quot;&quot;</span> <span class="built_in">YourLiteral</span>(ValueType value)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//conversion code here</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单12.12 将华氏温度和摄氏温度转换为开尔文温度</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Temperature</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">double</span> Kelvin;</span><br><span class="line">	<span class="built_in">Temperature</span>(<span class="type">long</span> <span class="type">double</span> kelvin) : <span class="built_in">Kelvin</span>(kelvin)&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Temperature <span class="keyword">operator</span><span class="string">&quot;&quot;</span> _C(<span class="type">long</span> <span class="type">double</span> celcius)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">Temperature</span>(celcius + <span class="number">273</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Temperature <span class="keyword">operator</span><span class="string">&quot;&quot;</span> _F(<span class="type">long</span> <span class="type">double</span> fahrenheit)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">Temperature</span>((fahrenheit + <span class="number">459.67</span>) * <span class="number">5</span> / <span class="number">9</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Temperature k1 = <span class="number">31.73</span>_F;</span><br><span class="line">	Temperature k2 = <span class="number">0.0</span>_C;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;k1 is &quot;</span> &lt;&lt; k<span class="number">1.</span>Kelvin &lt;&lt; <span class="string">&quot; Kelvin&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;k2 is &quot;</span> &lt;&lt; k<span class="number">1.</span>Kelvin &lt;&lt; <span class="string">&quot; Kelvin&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="12-7-作业"><a href="#12-7-作业" class="headerlink" title="12.7 作业"></a>12.7 作业</h2><p><strong>12.10.1 测验</strong></p>
<ol>
<li><p><strong>可以像下面这样，编写两个版本的下标运算符，一个的返回类型为const，另一个为非const吗？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> Type&amp; <span class="keyword">operator</span>[](<span class="type">int</span> index);  </span><br><span class="line">Type&amp; <span class="keyword">operator</span>[](<span class="type">int</span> index); <span class="comment">// is this OK?  </span></span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：不可以，C++不允许两个函数的名称相同，返回类型值不同。</p>
</li>
<li><p>**可以将复制构造函数或复制赋值运算符声明为私有的吗？  **</p>
<p><strong>答</strong>：可以</p>
</li>
<li><p><strong>给Date类实现移动构造函数和移动赋值运算符有意义吗？</strong></p>
<p><strong>答</strong>：没有意义，只有在动态分配资源时才会导致复制构造函数和复制赋值函数进行不必要的内存分配和释放</p>
</li>
</ol>
<p><strong>12.10.2 练习</strong></p>
<ol>
<li><p><strong>为Date类编写一个转换运算符，将其存储的日期转换为整数。</strong> </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">explicit</span> <span class="keyword">operator</span> <span class="title">int</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> year*<span class="number">10000</span> + month * <span class="number">100</span> + day;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>*<em>DynIntegers 类以 int</em>私有成员的方式封装了一个动态分配的数组，请给它编写移动构造函数和 移动赋值运算符。 **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">DynIntegers</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span>* array;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">DynIntegers</span>(DynIntegers&amp;&amp; moveArray)</span><br><span class="line">    &#123;</span><br><span class="line">        array = moveArray.array;</span><br><span class="line">        moveArray.array = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    DynIntegers&amp; <span class="keyword">operator</span>=(DynIntegers&amp;&amp; moveArray)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (moveArray.array) &#123;</span><br><span class="line">            <span class="keyword">delete</span>[] array;</span><br><span class="line">            array = moveArray.array;</span><br><span class="line">            moveArray.array = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (*<span class="keyword">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ~<span class="built_in">DynIntegers</span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> (array) &#123;</span><br><span class="line">            <span class="keyword">delete</span>[] array;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第十三章-类型转换运算符"><a href="#第十三章-类型转换运算符" class="headerlink" title="第十三章 类型转换运算符"></a>第十三章 类型转换运算符</h1><h2 id="13-3-C-类型转换运算符"><a href="#13-3-C-类型转换运算符" class="headerlink" title="13.3 C++类型转换运算符"></a>13.3 C++类型转换运算符</h2><p>​	<strong>4个C++类型转换运算符如下</strong>  </p>
<ul>
<li>static_cast</li>
<li>dynamic_cast</li>
<li>reinterpret_cast</li>
<li>const_cast</li>
</ul>
<p><strong>它们的使用语法相同</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">destination_type result = <span class="built_in">cast_operator</span>&lt;destination_type&gt;(object_to_cast);</span><br></pre></td></tr></table></figure>

<p><strong>13.3.1 使用static_cast</strong></p>
<p>​	static_cast用于相关类型的指针之间进行转换，还可以显示的执行标准数据类型的类型转换——这种转换原本将自动或隐式地进行。用于指针时，static_cast实现了基本地编译阶段检查，确保指针转换为相关类型。使用static_cast可将指针向上转换为基类类型，也可以向下转换为派生类型。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Base* objBase = <span class="keyword">new</span> Derived;</span><br><span class="line">Derived objDer = <span class="built_in">static_cast</span>&lt;Derived*&gt;(objBase);</span><br></pre></td></tr></table></figure>

<p><strong>13.3.2 使用dynamic_cast和运行阶段类型识别</strong></p>
<p>​	顾名思义，与静态类型转换相反，动态类型转换在运行阶段（即应用程序运行时）执行类型转换。可检查dynamic_cast操作的结果，以判断类型转换是否成功</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单13.1 使用动态转换判断Fish指针指向的是否时Tuna对象或Carp对象</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">virtual</span> <span class="type">void</span> <span class="title">Swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Fish swims in water&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">virtual</span> ~<span class="built_in">Fish</span>()&#123;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Tuna</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Tuna swims real fast in the sea&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">BecomeDinner</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Tuna became dinner in SuShi&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Carp</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Carp swims real slow in the lake&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Talk</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Carp talked Carp!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DetectFishType</span><span class="params">(Fish* objFish)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Tuna* objTuna = <span class="built_in">dynamic_cast</span>&lt;Tuna*&gt;(objFish);</span><br><span class="line">    <span class="keyword">if</span> (objTuna) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Detected Tuna. Making Tuna dinner: &quot;</span> &lt;&lt; endl;</span><br><span class="line">        objTuna-&gt;<span class="built_in">BecomeDinner</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    Carp* objCarp = <span class="built_in">dynamic_cast</span>&lt;Carp*&gt;(objFish);</span><br><span class="line">    <span class="keyword">if</span> (objCarp) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Detected Carp.Making carp talk: &quot;</span> &lt;&lt; endl;</span><br><span class="line">        objCarp-&gt;<span class="built_in">Talk</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Verifying type using virtual Fish::Swim: &quot;</span> &lt;&lt; endl;</span><br><span class="line">    objFish-&gt;<span class="built_in">Swim</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Carp myLunch;</span><br><span class="line">    Tuna myDinner;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">DetectFishType</span>(&amp;myDinner);</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">DetectFishType</span>(&amp;myLunch);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> <strong>13.3.3 使用reinterpret_cast</strong></p>
<p>​	reinterpret_cast时C++中与C风格类型转换最接近的类型转换运算符，它让程序员能够将一种对象类型转换为另一种，不管它们是否相关。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Base* objBase = <span class="keyword">new</span> <span class="built_in">Base</span>();</span><br><span class="line">Unrelated* notRelated = <span class="built_in">reinterpret_cast</span>&lt;Unrelated*&gt;(objBase);</span><br></pre></td></tr></table></figure>

<p><strong>13.3.4 使用const_cast</strong></p>
<p>​	const_cast让程序员能够关闭对象的访问修饰符const</p>
<h2 id="13-7-作业"><a href="#13-7-作业" class="headerlink" title="13.7 作业"></a>13.7 作业</h2><p><strong>13.7.1 测验</strong></p>
<ol>
<li><p><strong>您有一个基类对象指针objBase，要确定它指向的是否是Derived1或Derived2对象，应使用哪 种类型转换？</strong></p>
<p><strong>答</strong>：dynamic_cast</p>
</li>
<li><p>**假设您有一个指向对象的const引用，并试图通过它调用一个您编写的公有成员函数，但编译 器不允许您这样做，因为该函数不是const成员。您将修改这个函数还是使用const_cast？  **</p>
<p><strong>答</strong>：修改函数，除非万不得已，否则要使用const_cast</p>
</li>
<li><p><strong>判断对错：仅在不能使用static_cast时才应使用reinterpret_cast，这种类型转换是必须和安全的。</strong></p>
<p><strong>答</strong>：对</p>
</li>
<li><p><strong>判断对错：优秀的编译器将自动执行很多基于static_cast的类型转换，尤其是简单数据类型之 间的转换。</strong> </p>
<p><strong>答</strong>：对</p>
</li>
</ol>
<p><strong>13.7.2 练习</strong></p>
<ol>
<li><p><strong>查错：下述代码有何问题？</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">DoSomething</span><span class="params">(Base* objBase)</span>  </span>&#123;   </span><br><span class="line">    Derived* objDer = <span class="built_in">dynamic_cast</span> (objBase);   </span><br><span class="line">    objDer-&gt;<span class="built_in">DerivedClassMethod</span>();  </span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：没有判断是否转换成功，就对对象进行了使用</p>
</li>
<li><p><strong>假设有一个Fish指针（objFish），它指向一个Tuna对象,要让一个Tuna指针指向该指针指向的Tuna对象，应使用哪种类型转换？请使用代码证明您的 看法。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Fish* objFish = <span class="keyword">new</span> Tuna;</span><br><span class="line">Tuna* pTuna = objFish;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用static_cast</span></span><br><span class="line">Fish* objFish = <span class="keyword">new</span> Tuna;</span><br><span class="line">Tuna* pTuna = <span class="built_in">static_cast</span>&lt;Tuna*&gt;(objFish);</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第十四章"><a href="#第十四章" class="headerlink" title="第十四章"></a>第十四章</h1><h2 id="13-4-模板简介"><a href="#13-4-模板简介" class="headerlink" title="13.4 模板简介"></a>13.4 模板简介</h2><p><strong>14.4.1 模板声明语法</strong></p>
<p>​	模板声明以关键字template打头，接下来是类型参数列表。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;parameter list&gt;</span><br><span class="line"><span class="keyword">template</span> function / <span class="keyword">class</span> <span class="title class_">declaration</span></span><br></pre></td></tr></table></figure>

<p>关键字template标志着模板声明的开始，接下来是模板参数列表。该参数列表包含关键字typename,它定义了模板参数objType，objType是一个占位符。针对对象实例化模板时，将使用对象的类型替换它。</p>
<p><strong>14.4.2 各种类型的模板声明</strong> </p>
<p>​	模板声明可以是：</p>
<ul>
<li>函数的声明或实现</li>
<li>类的定义或声明</li>
<li>类模板的成员函数或成员类的声明或定义</li>
<li>类模板的静态数据成员的定义</li>
<li>嵌套在类模板中的类的静态数据成员的定义</li>
<li>类或模板类的成员模板的定义</li>
</ul>
<p><strong>14.4.3 模板函数</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单14.3 模板函数GetMax,它返回两个参数中较大的一个</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Type&gt;</span></span><br><span class="line"><span class="function"><span class="type">const</span> Type&amp; <span class="title">GetMax</span><span class="params">(<span class="type">const</span> Type&amp; value1, <span class="type">const</span> Type&amp; value2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> value1 &gt; value2 ? value1 : value2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Type&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DisplayComparison</span><span class="params">(<span class="type">const</span> Type&amp; value1, <span class="type">const</span> Type&amp; value2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;GetMax(&quot;</span> &lt;&lt; value1 &lt;&lt; <span class="string">&quot;, &quot;</span> &lt;&lt; value2 &lt;&lt; <span class="string">&quot;) = &quot;</span>;</span><br><span class="line">	cout &lt;&lt; <span class="built_in">GetMax</span>(value1, value2) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> num1 = <span class="number">-101</span>, num2 = <span class="number">2011</span>;</span><br><span class="line">	<span class="built_in">DisplayComparison</span>(num1, num2);</span><br><span class="line"></span><br><span class="line">	<span class="type">double</span> d1 = <span class="number">3.14</span>, d2 = <span class="number">3.1416</span>;</span><br><span class="line">	<span class="built_in">DisplayComparison</span>(d1, d2);</span><br><span class="line"></span><br><span class="line">	<span class="function">string <span class="title">name1</span><span class="params">(<span class="string">&quot;Jack&quot;</span>)</span>, <span class="title">name2</span><span class="params">(<span class="string">&quot;John&quot;</span>)</span></span>;</span><br><span class="line">	<span class="built_in">DisplayComparison</span>(name1, name2);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>14.4.8 一个模板示例</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单14.4 包含两个成员属性的模板类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T1 = <span class="type">int</span>, <span class="keyword">typename</span> T2 = <span class="type">double</span>&gt;</span><br><span class="line"><span class="keyword">class</span> HoldPair</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">HoldPair</span>(<span class="type">const</span> T1&amp; val1, <span class="type">const</span> T2&amp; val2) : <span class="built_in">value1</span>(val1), <span class="built_in">value2</span>(val2) &#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> T1&amp; <span class="built_in">GetFirstValue</span>() <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> value1;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">const</span> T2&amp; <span class="title">GetSecondValue</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> value2;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	T1 value1;</span><br><span class="line">	T2 value2;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	HoldPair&lt;&gt; <span class="built_in">pairIntDbl</span>(<span class="number">300</span>,<span class="number">10.09</span>);</span><br><span class="line">	<span class="function">HoldPair&lt;<span class="type">short</span>, <span class="type">const</span> <span class="type">char</span>*&gt; <span class="title">pairShortStr</span><span class="params">(<span class="number">25</span>, <span class="string">&quot;learn templates, love c++&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The first object contains -&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Value 1:&quot;</span> &lt;&lt; pairIntDbl.<span class="built_in">GetFirstValue</span>() &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Value 2:&quot;</span> &lt;&lt; pairIntDbl.<span class="built_in">GetSecondValue</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The second object contains -&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Value 1:&quot;</span> &lt;&lt; pairShortStr.<span class="built_in">GetFirstValue</span>() &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Value 2:&quot;</span> &lt;&lt; pairShortStr.<span class="built_in">GetSecondValue</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>14.4.9 模板的实例化和具体化</strong></p>
<ul>
<li>实例化：使用一个或多个模板参数来创建特定的类型</li>
<li>具体化：为特定的类型指定行为</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单14.5 模板具体化</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T1 = <span class="type">int</span>, <span class="keyword">typename</span> T2 = <span class="type">double</span>&gt;</span><br><span class="line"><span class="keyword">class</span> HoldPair</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">HoldPair</span>(<span class="type">const</span> T1&amp; val1, <span class="type">const</span> T2&amp; val2) : <span class="built_in">value1</span>(val1), <span class="built_in">value2</span>(val2) &#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> T1&amp; <span class="built_in">GetFirstValue</span>() <span class="type">const</span>;</span><br><span class="line">	<span class="function"><span class="type">const</span> T2&amp; <span class="title">GetSecondValue</span><span class="params">()</span> <span class="type">const</span></span>;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	T1 value1;</span><br><span class="line">	T2 value2;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;&gt; <span class="keyword">class</span> <span class="title class_">HoldPair</span>&lt;<span class="type">int</span>, <span class="type">int</span>&gt;</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">HoldPair</span>(<span class="type">const</span> <span class="type">int</span>&amp; val1, <span class="type">const</span> <span class="type">int</span>&amp; val2) : <span class="built_in">value1</span>(val1), <span class="built_in">value2</span>(val2) &#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">const</span> <span class="type">int</span>&amp; <span class="title">GetFirstValue</span><span class="params">()</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Returning integer &quot;</span> &lt;&lt; value1 &lt;&lt; endl;</span><br><span class="line">		<span class="keyword">return</span> value1;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="type">int</span> value1;</span><br><span class="line">	<span class="type">int</span> value2;</span><br><span class="line">	string strFun;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">HoldPair&lt;<span class="type">int</span>, <span class="type">int</span>&gt; <span class="title">pairInInt</span><span class="params">(<span class="number">223</span>, <span class="number">333</span>)</span></span>;</span><br><span class="line">	pairInInt.<span class="built_in">GetFirstValue</span>();</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>14.4.10</strong></p>
<p>​	<strong>模板类的静态成员，由特定的具体化的所用实例共享</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单14.6 静态成员对模板类和实例的影响</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestStatic</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="type">static</span> <span class="type">int</span> staticVal;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt; <span class="type">int</span> TestStatic&lt;T&gt;::staticVal;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	TestStatic&lt;<span class="type">int</span>&gt; intInstance;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;setting staticVzl for intInstance to 2011&quot;</span> &lt;&lt; endl;</span><br><span class="line">	intInstance.staticVal = <span class="number">2011</span>;</span><br><span class="line"></span><br><span class="line">	TestStatic&lt;<span class="type">int</span>&gt; dblInstance;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;setting staticVal for dblInstance to 1011&quot;</span> &lt;&lt; endl;</span><br><span class="line">	dblInstance.staticVal = <span class="number">1011</span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;intInstance.staticVal = &quot;</span> &lt;&lt; intInstance.staticVal &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;dblInstance.staticVal = &quot;</span> &lt;&lt; dblInstance.staticVal &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>对于模板类的静态成员，通用初始化语法如下：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">template</span> parameters&gt; StaticType</span><br><span class="line">ClassName&lt;Template Arguments&gt;::StaticVarName;</span><br></pre></td></tr></table></figure>

<p><strong>14.4.11 参数数量可变的模板</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单14.7 使用参数数量可变的模板的函数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Res, <span class="keyword">typename</span> ValType&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Sum</span><span class="params">(Res&amp; result, ValType&amp; val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	result = result + val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> Res, <span class="keyword">typename</span> First, <span class="keyword">typename</span>... Rest&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Sum</span><span class="params">(Res&amp; result, First val1, Rest... valN)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	result = result + val1;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">Sum</span>(result, valN...);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">double</span> dResult = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">Sum</span>(dResult, <span class="number">3.14</span>, <span class="number">4.56</span>, <span class="number">1.1111</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;dResult = &quot;</span> &lt;&lt; dResult &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	string strResult;</span><br><span class="line">	<span class="built_in">Sum</span>(strResult, <span class="string">&quot;Hello &quot;</span>, <span class="string">&quot;World&quot;</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;strResult = &quot;</span> &lt;&lt; strResult &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序请单14.8 实例化并使用std::tuple</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;tuple&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> tupleType&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DisplayTupleInfo</span><span class="params">(tupleType&amp; tup)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">int</span> numMembers = tuple_size&lt;tupleType&gt;::value;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Num element in tuple: &quot;</span> &lt;&lt; numMembers &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Last element value: &quot;</span> &lt;&lt; <span class="built_in">get</span>&lt;numMembers - <span class="number">1</span>&gt;(tup) &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">tuple&lt;<span class="type">int</span>, <span class="type">char</span>, string&gt; <span class="title">tup1</span><span class="params">(make_tuple(<span class="number">101</span>, <span class="string">&#x27;s&#x27;</span>, <span class="string">&quot;Hello Tuple&quot;</span>))</span></span>;</span><br><span class="line">	<span class="built_in">DisplayTupleInfo</span>(tup1);</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">auto</span> <span class="title">tup2</span><span class="params">(make_tuple(<span class="number">3.14</span>, <span class="literal">false</span>))</span></span>;</span><br><span class="line">	<span class="built_in">DisplayTupleInfo</span>(tup2);</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">auto</span> <span class="title">concatTup</span><span class="params">(tuple_cat(tup2, tup1))</span></span>;</span><br><span class="line">	<span class="built_in">DisplayTupleInfo</span>(concatTup);</span><br><span class="line"></span><br><span class="line">	<span class="type">double</span> pi;</span><br><span class="line">	string sentence;</span><br><span class="line">	<span class="built_in">tie</span>(pi, ignore, ignore, ignore, sentence) = concatTup;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Unpacked! Pi &quot;</span> &lt;&lt; pi &lt;&lt; <span class="string">&quot; and \&quot;&quot;</span> &lt;&lt; sentence &lt;&lt; <span class="string">&quot;\&quot;&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>14.4.12 使用static_assert执行编译阶段检查</strong></p>
<p>​	<strong>static_assert是C++11新增的一项功能，让您能够在不满足指定条件时禁止编译</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">static_assert</span>(expression being validated,<span class="string">&quot;Error message when check fails&quot;</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单14.9 一个挑剔的模板类，它使用static_assert在您针对int类型实例化时发出抗议</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;tuple&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">EverythingButInt</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">EverythingButInt</span>()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">static_assert</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>) != <span class="built_in">sizeof</span>(T), <span class="string">&quot;No int please!&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	EverythingButInt&lt;<span class="type">int</span>&gt; test;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="14-7-作业"><a href="#14-7-作业" class="headerlink" title="14.7 作业"></a>14.7 作业</h2><p><strong>14.7.1 测验</strong></p>
<ol>
<li><p><strong>什么是多次包含防范（inclusion guard）？</strong></p>
<p><strong>答</strong>：这是一个预编译结构，防止重复包含同文件</p>
</li>
<li><p><strong>如果使用参数20调用下面的宏，结果将是多少？</strong> </p>
<p><code>#define SPLIT(x) x / 5 </code></p>
<p><strong>答</strong>：4</p>
</li>
<li><p>**如果用10+10调用测验2中的SPLIT宏，结果将是多少？  **</p>
<p><strong>答</strong>：12</p>
</li>
<li><p>**如何修改SPLIT宏以免得到错误的结果？ **</p>
<p><strong>答</strong>：<code>#define SPLIT(x) ((x) / 5)</code></p>
</li>
</ol>
<p><strong>14.7.2 练习</strong></p>
<ol>
<li><p>**编写一个将两个数相乘的宏。  **</p>
<p><code>#define MULI(x,y) ((x) * (y))</code></p>
</li>
<li><p>**编写一个模板，实现测验4中宏的功能。  **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">T <span class="title">Split</span><span class="params">(<span class="type">const</span> T&amp; input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (input / <span class="number">5</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>**实现模板函数swap，它交换两个变量的值。  **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function">T <span class="title">Swap</span><span class="params">(T&amp; input1, T&amp; input2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	T tmp = input1;</span><br><span class="line">	input1 = input2;</span><br><span class="line">	input2 = tmp;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>**查错：您将如何改进下面的宏使其计算输入值的1&#x2F;4？  **</p>
<p><code>#define QUARTER(x) (x / 4)  </code></p>
<p><code>#define QUARTER(x) ((x) / 4)</code></p>
</li>
<li><p><strong>编写一个简单的模板类，它存储两个数组，数组的类型是通过模板参数列表指定的。数组包含 10 个元素，模板类应包含存取器函数，可用于操作数组元素。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> arr1Type,<span class="keyword">typename</span> arr2Type&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Arrays</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function">arr1Type&amp; <span class="title">GetElem1</span><span class="params">(<span class="type">int</span> index)</span> </span>&#123; <span class="keyword">return</span> arr1[index]; &#125;</span><br><span class="line">	<span class="function">arr1Type&amp; <span class="title">GetElem2</span><span class="params">(<span class="type">int</span> index)</span> </span>&#123; <span class="keyword">return</span> arr2[index]; &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	arr1Type arr1[<span class="number">10</span>];</span><br><span class="line">	arr2Type arr2[<span class="number">10</span>];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写模板函数Display()，它可使用不同数量和类型的参数调用，并将所有的参数都显示出来</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T, <span class="keyword">typename</span>... args&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(T input,args... begin)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; input &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(begin...);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第十五章"><a href="#第十五章" class="headerlink" title="第十五章"></a>第十五章</h1><h2 id="15-5选择正确的容器"><a href="#15-5选择正确的容器" class="headerlink" title="15.5选择正确的容器"></a>15.5选择正确的容器</h2><p><img src="https://www.helloimg.com/i/2024/12/29/6770cd809d079.png"></p>
<p><img src="https://www.helloimg.com/i/2024/12/29/6770cdfb31523.png"></p>
<h2 id="15-9-作业"><a href="#15-9-作业" class="headerlink" title="15.9 作业"></a>15.9 作业</h2><p><strong>测验</strong></p>
<ol>
<li><p>**要包含一个对象数组，并允许在开头和末尾插入对象，应使用哪种容器？ **</p>
<p><strong>答</strong>：deque</p>
</li>
<li><p>**要存储元素以进行快速查找，应选择哪种容器？ **</p>
<p><strong>答</strong>：应该选择关联式容器</p>
</li>
<li><p>**要使用std:set 存储元素，并根据除元素值外的其他条件进行存储和查找，可能吗？  **</p>
<p><strong>答</strong>：可能</p>
</li>
<li><p>**哪项STL特性将算法和容器联系起来？  **</p>
<p><strong>答</strong>：迭代器</p>
</li>
<li><p>**如果应用程序要移植到不同的平台，并使用不同的C++编译器进行编译，是否可选择使用容器 hash_set？ **</p>
<p><strong>答</strong>：hash_set并非C++标准容器，因此不应在有移植性需求的程序上使用它，应该使用map</p>
</li>
</ol>
<h1 id="第十六章"><a href="#第十六章" class="headerlink" title="第十六章"></a>第十六章</h1><h2 id="16-1-为何需要字符串操作类"><a href="#16-1-为何需要字符串操作类" class="headerlink" title="16.1 为何需要字符串操作类"></a>16.1 为何需要字符串操作类</h2><ul>
<li>减少了程序员创建和操作字符串方面需要做的工作</li>
<li>在内部管理内存分配细节，从而提高了应用程序的稳定性</li>
<li>提供了复制构造函数和赋值运算符，可确保成员字符串得以正确复制</li>
<li>提供了帮助执行截短、查找和删除等操作的实用函数</li>
<li>提供了用于比较的运算符</li>
<li>让程序能够将精力放在应用的主要需求上而不是字符串的操作上</li>
</ul>
<h2 id="16-2-使用STL-string类"><a href="#16-2-使用STL-string类" class="headerlink" title="16.2 使用STL string类"></a>16.2 使用STL string类</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//16.1程序清单 实例化和复制STL string的方法</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">char</span>* constCStyleString = <span class="string">&quot;Hello String!&quot;</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Constant string is: &quot;</span> &lt;&lt; constCStyleString &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="function">string <span class="title">strFromConst</span><span class="params">(constCStyleString)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;strFromConst is: &quot;</span> &lt;&lt; strFromConst &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="function">string <span class="title">str2</span><span class="params">(<span class="string">&quot;Hello String!&quot;</span>)</span></span>;</span><br><span class="line">	<span class="function">string <span class="title">str2Copy</span><span class="params">(str2)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;str2Copy is: &quot;</span> &lt;&lt; str2Copy &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="function">string <span class="title">strPartialCopy</span><span class="params">(constCStyleString, <span class="number">5</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;strPartialCopy is: &quot;</span> &lt;&lt; strPartialCopy &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="function">string <span class="title">strRepeatChars</span><span class="params">(<span class="number">10</span>, <span class="string">&#x27;a&#x27;</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;strRepeatChars is: &quot;</span> &lt;&lt; strRepeatChars &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>16.2.2 访问std::string的字符内容</strong></p>
<p>​	<strong>要访问STL string的字符串内容，可使用迭代器，也可采用类似数组的语法并使用下标运算符（[]）提供偏移量。要获得string对象的C风格字符串可使用成员函数c_str()</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 16.2 两种访问STL string字符元素的方式：运算符[]和迭代器</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">string <span class="title">stlString</span><span class="params">(<span class="string">&quot;Hello string&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Display elements in string using array-syntax: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; stlString.<span class="built_in">length</span>(); i++) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Character [&quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;] is:&quot;</span> &lt;&lt; stlString[i] &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Display elements in string using iterators: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="type">int</span> charOffset = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> i = stlString.<span class="built_in">begin</span>(); i != stlString.<span class="built_in">end</span>(); i++) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Character [&quot;</span> &lt;&lt; charOffset++ &lt;&lt; <span class="string">&quot;] is:&quot;</span> &lt;&lt; *i &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The char* representation of the string is: &quot;</span> &lt;&lt; stlString.<span class="built_in">c_str</span>() &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>16.2.3 拼接字符串</strong></p>
<p> <strong>要拼接字符串，可使用运算符+&#x3D;，也可使用成员函数append()</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单16.3 使用加法赋值运算符（+=）或 apped() 拼接字符串</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">string <span class="title">sampleStr1</span><span class="params">(<span class="string">&quot;Hello&quot;</span>)</span></span>;</span><br><span class="line">	<span class="function">string <span class="title">sampleStr2</span><span class="params">(<span class="string">&quot; String&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	sampleStr1 += sampleStr2;</span><br><span class="line">	cout &lt;&lt; sampleStr1 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="function">string <span class="title">sampleStr3</span><span class="params">(<span class="string">&quot; Fun is not needing to use pointers!&quot;</span>)</span></span>;</span><br><span class="line">	sampleStr<span class="number">3.</span><span class="built_in">append</span>(sampleStr3);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;sampleStr1&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">const</span> <span class="type">char</span>* constCStyleString = <span class="string">&quot; you however still can!&quot;</span>;</span><br><span class="line">	sampleStr<span class="number">1.</span><span class="built_in">append</span>(constCStyleString);</span><br><span class="line">	cout &lt;&lt; sampleStr1 &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>16.2.4 在string中查找字符或子字符串</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单16.4 使用string::find()查找子字符串或字符</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">string <span class="title">sampleStr</span><span class="params">(<span class="string">&quot;Good day String! Today is beautiful!&quot;</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Sample string is:&quot;</span> &lt;&lt; endl &lt;&lt; sampleStr &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">size_t</span> charPos = sampleStr.<span class="built_in">find</span>(<span class="string">&quot;day&quot;</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span> (charPos != string::npos) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;First instance \&quot;day\&quot; at pos. &quot;</span> &lt;&lt; charPos &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Substring not found.&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Locating all instance of substring \&quot;day\&quot;&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="type">size_t</span> subStrPos = sampleStr.<span class="built_in">find</span>(<span class="string">&quot;day&quot;</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (subStrPos != string::npos) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;\&quot;day\&quot; found at position&quot;</span> &lt;&lt; subStrPos &lt;&lt; endl;</span><br><span class="line">		<span class="type">size_t</span> searchOffset = subStrPos + <span class="number">1</span>;</span><br><span class="line">		subStrPos = sampleStr.<span class="built_in">find</span>(<span class="string">&quot;day&quot;</span>, searchOffset);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>16.2.5 截断STL string</strong></p>
<pre><code> **STL string类提供了erase函数**
</code></pre>
<ul>
<li><p>在给定偏移位置和字符串时删除指定数目的字符</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">string <span class="title">sampleStr</span><span class="params">(<span class="string">&quot;Hello String! Wake up to a beautiful day!&quot;</span>)</span></span>;</span><br><span class="line">sampleStr.<span class="built_in">erase</span>(<span class="number">13</span>,<span class="number">28</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>在给定指向字符的迭代器时删除该字符</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sampleStr.<span class="built_in">erase</span>(iChars);</span><br></pre></td></tr></table></figure>
</li>
<li><p>在给定由两个迭代器指定的范围时删除该范围内的字符</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sampleStr.<span class="built_in">erase</span>(iChars);</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单16.5 使用string::erase从指定偏移位置或迭代器指定的位置开始截断字符串</span></span><br></pre></td></tr></table></figure>

<p><strong>16.2.6 字符串反转</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单16.6 使用std::reverse反转STL string</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">string <span class="title">sampleStr</span><span class="params">(<span class="string">&quot;Hello String! We will reverse!&quot;</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The original sample string is: &quot;</span> &lt;&lt; sampleStr &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">reverse</span>(sampleStr.<span class="built_in">begin</span>(), sampleStr.<span class="built_in">end</span>());</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;After applying the std::reverse algorithm: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; sampleStr &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>16.2.7 字符串的大小写转换</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单16.7 使用是std::transform()将STL string转换为大写</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Please enter a string for case-convertion:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;&gt; &quot;</span>;</span><br><span class="line"></span><br><span class="line">	string inStr;</span><br><span class="line">	<span class="built_in">getline</span>(cin, inStr);</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">transform</span>(inStr.<span class="built_in">begin</span>(), inStr.<span class="built_in">end</span>(), inStr.<span class="built_in">begin</span>(), ::toupper);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The string converted to upper case is：&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; inStr &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">transform</span>(inStr.<span class="built_in">begin</span>(), inStr.<span class="built_in">end</span>(), inStr.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The string converted to lower case is：&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; inStr &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="16-6-作业"><a href="#16-6-作业" class="headerlink" title="16.6 作业"></a>16.6 作业</h2><p><strong>16.6.1 测验</strong></p>
<ol>
<li><p><strong>std::string 具体化了哪个 STL 模板类?</strong></p>
<p><strong>答</strong>：std::basic_string</p>
</li>
<li><p>**如果要对两个字符串进行区分大小写的比较，该如何做? **</p>
<p><strong>答</strong>：将两个字符串赋值到两个副本对象中，再将每个复制的字符串都转为小写或大写，然后对转换后的字符串进行比较，返回结果</p>
</li>
<li><p><strong>STL string 与 C 风格字符串是否类似?</strong></p>
<p><strong>答</strong>：不类似</p>
</li>
</ol>
<p><strong>16.6.2 练习</strong></p>
<ol>
<li><p>**编写一个程序检查用户输入的单词是否为回文。例如，ATOYOTA 是回文，因为该单词反转后 与原来相同 **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter string: &quot;</span>;</span><br><span class="line">	string str;</span><br><span class="line">	cin &gt;&gt; str;</span><br><span class="line"></span><br><span class="line">	string tmp = str;</span><br><span class="line">	<span class="built_in">reverse</span>(tmp.<span class="built_in">begin</span>(), tmp.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Whether it is a palindrome or not&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">if</span> (tmp == str) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Yes&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;No&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写一个程序，告诉用户输入的句子包含多少个元音字母</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Please enter string: &quot;</span>;</span><br><span class="line">	string str;</span><br><span class="line">	cin &gt;&gt; str;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> ch : str) &#123;</span><br><span class="line">		<span class="keyword">if</span> (ch == <span class="string">&#x27;a&#x27;</span> || ch == <span class="string">&#x27;e&#x27;</span> || ch == <span class="string">&#x27;i&#x27;</span> || ch == <span class="string">&#x27;o&#x27;</span> || ch == <span class="string">&#x27;u&#x27;</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			count++;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The number of vowels in that sentence is:&quot;</span> &lt;&lt; count &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>将字符串的字符交替地转换为大写</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Please enter string: &quot;</span>;</span><br><span class="line">	string str;</span><br><span class="line">	cin &gt;&gt; str;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; str.<span class="built_in">size</span>(); i += <span class="number">2</span>) &#123;</span><br><span class="line">		str[i] = <span class="built_in">toupper</span>(str[i]);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The string converted to upper case is: &quot;</span> &lt;&lt; str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写一个程序，将4个string对象分别初始化为I、Love、STL和String，然后在这些字符串之 间添加空格，再显示整个句子</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	string str1 = <span class="string">&quot;I&quot;</span>;</span><br><span class="line">	string str2 = <span class="string">&quot;Love&quot;</span>;</span><br><span class="line">	string str3 = <span class="string">&quot;STL&quot;</span>;</span><br><span class="line">	string str4 = <span class="string">&quot;String&quot;</span>;</span><br><span class="line"></span><br><span class="line">	string result = str1 + <span class="string">&quot; &quot;</span> + str2 + <span class="string">&quot; &quot;</span> + str3 + <span class="string">&quot; &quot;</span> + str4;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The Sentence reads: &quot;</span> &lt;&lt; result &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ol start="5">
<li><p><strong>编写一个程序，显示字符串Good day String! Today is beautiful!中每个 a 所在的位置</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	string str = <span class="string">&quot;Good day String! Today is beautiful!&quot;</span>;</span><br><span class="line">	<span class="type">int</span> count = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>;;) &#123;</span><br><span class="line">		i = str.<span class="built_in">find</span>(<span class="string">&#x27;a&#x27;</span>, i);</span><br><span class="line">		<span class="keyword">if</span> (i == string::npos) <span class="keyword">break</span>;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;a found at position: &quot;</span> &lt;&lt; i &lt;&lt; endl;</span><br><span class="line">		i++;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<h1 id="第十七章"><a href="#第十七章" class="headerlink" title="第十七章"></a>第十七章</h1><h2 id="17-1-std-vector的特点"><a href="#17-1-std-vector的特点" class="headerlink" title="17.1 std::vector的特点"></a>17.1 std::vector的特点</h2><p>​	<strong>vector是一个模板类，提供了动态数组的通用功能，具有如下特点</strong></p>
<ul>
<li>在数组末尾添加元素所需要的时间是固定的，即在末尾插入元素的所需时间不随数组大小而异，在末尾删除元素也是如此</li>
<li>在数组中间添加或删除元素所需要的时间与该元素后面的元素个数成正比</li>
<li>存储的元素数是动态的，而vector类负责管理内存</li>
</ul>
<h2 id="17-2-典型的vector操作"><a href="#17-2-典型的vector操作" class="headerlink" title="17.2 典型的vector操作"></a>17.2 典型的vector操作</h2><p><strong>17.2.1 实例化vector</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单17.1 各种实例化std::vector的方式：指定长度和初始值以及复制另一个vector的值</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; integers;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; initVector&#123; <span class="number">202</span>,<span class="number">2017</span>,<span class="number">-1</span> &#125;;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">tenElements</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">tneElemInit</span><span class="params">(<span class="number">10</span>, <span class="number">90</span>)</span></span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">copyVector</span><span class="params">(tneElemInit)</span></span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">partialCopy</span><span class="params">(tenElements.begin(), tenElements.begin() + <span class="number">5</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>17.2.2 使用push_back()在末尾插入元素</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//使用push_back()在vector中插入元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; integers;</span><br><span class="line">	</span><br><span class="line">	integers.<span class="built_in">push_back</span>(<span class="number">50</span>);</span><br><span class="line">	integers.<span class="built_in">push_back</span>(<span class="number">1</span>);</span><br><span class="line">	integers.<span class="built_in">push_back</span>(<span class="number">987</span>);</span><br><span class="line">	integers.<span class="built_in">push_back</span>(<span class="number">1001</span>);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The vector contains &quot;</span> &lt;&lt; integers.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot;Elements&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>17.2.4 使用insert()在指定位置插入元素</strong></p>
<ul>
<li><p>让您能够指定位置插入位置</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">integers.<span class="built_in">insert</span>(integers.<span class="built_in">begin</span>(),<span class="number">25</span>);</span><br></pre></td></tr></table></figure>
</li>
<li><p>让您能够指定位置插入位置、要插入的元素以及这些元素的值（都相同）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  integers.<span class="built_in">insert</span>(integers.<span class="built_in">end</span>(),<span class="number">2</span>,<span class="number">45</span>);</span><br><span class="line"></span><br><span class="line">* 还可以将另一个vector的内容插入到指定位置</span><br><span class="line"></span><br><span class="line">  ```C++</span><br><span class="line">  <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">anoter</span><span class="params">(<span class="number">2</span>,<span class="number">30</span>)</span></span>;</span><br><span class="line">  integers.<span class="built_in">insert</span>(integers.<span class="built_in">begin</span>() + <span class="number">1</span>,another.<span class="built_in">begin</span>(),another.<span class="built_in">end</span>());</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单17.3 使用函数vector::insert在指定位置插入元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DisplayVector</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; inVec)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> element = inVec.<span class="built_in">begin</span>(); element != inVec.<span class="built_in">end</span>(); element++)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *element &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">integers</span><span class="params">(<span class="number">4</span>,<span class="number">90</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The initial contents of the Vector: &quot;</span>;</span><br><span class="line">	<span class="built_in">DisplayVector</span>(integers);</span><br><span class="line"></span><br><span class="line">	integers.<span class="built_in">insert</span>(integers.<span class="built_in">begin</span>(), <span class="number">25</span>);</span><br><span class="line">	integers.<span class="built_in">insert</span>(integers.<span class="built_in">end</span>(), <span class="number">2</span>, <span class="number">45</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Vector after inserting elements at beginning and end: &quot;</span>;</span><br><span class="line">	<span class="built_in">DisplayVector</span>(integers);</span><br><span class="line">	</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">another</span><span class="params">(<span class="number">2</span>, <span class="number">30</span>)</span></span>;</span><br><span class="line">	integers.<span class="built_in">insert</span>(integers.<span class="built_in">begin</span>() + <span class="number">1</span>, another.<span class="built_in">begin</span>(), another.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Vector after inserting contents from another vector: &quot;</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;in the middle:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">DisplayVector</span>(integers);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>17.2.5 使用数组语法访问vector中的元素</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单17.4 使用数组语法访问vector中的元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; integers&#123; <span class="number">50</span>,<span class="number">1</span>,<span class="number">987</span>,<span class="number">1001</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; integers.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Element [&quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;] = &quot;</span> &lt;&lt; integers[i] &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	integers[<span class="number">2</span>] = <span class="number">2011</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;After replacement: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Element[2] = &quot;</span> &lt;&lt; integers[<span class="number">2</span>] &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>17.2.6 使用指针语法访问vector中的元素</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单17.5 使用指针语法访问vector中的元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; integers&#123; <span class="number">50</span>,<span class="number">1</span>,<span class="number">987</span>,<span class="number">1001</span> &#125;;</span><br><span class="line"></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt;::const_iterator element = integers.<span class="built_in">cbegin</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> (element != integers.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		<span class="type">size_t</span> index = <span class="built_in">distance</span>(integers.<span class="built_in">cbegin</span>(), element);<span class="comment">//计算偏移量</span></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Element at position &quot;</span> &lt;&lt; index &lt;&lt; <span class="string">&quot; is: &quot;</span> &lt;&lt; *element &lt;&lt; endl;</span><br><span class="line">		++element;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>17.2.7 删除vector中元素</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单17.6 使用pop_back()删除最后一个元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">DisplayVector</span><span class="params">(<span class="type">const</span> vector&lt;<span class="type">int</span>&gt;&amp; inVec)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> element = inVec.<span class="built_in">begin</span>(); element != inVec.<span class="built_in">end</span>(); element++) &#123;</span><br><span class="line">		cout &lt;&lt; *element &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; integers&#123; <span class="number">50</span>,<span class="number">1</span>,<span class="number">987</span>,<span class="number">1001</span> &#125;;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Vector contains &quot;</span> &lt;&lt; integers.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; elements: &quot;</span>;</span><br><span class="line">	<span class="built_in">DisplayVector</span>(integers);</span><br><span class="line"></span><br><span class="line">	integers.<span class="built_in">pop_back</span>();</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;After a call pop_back()&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Vector contains &quot;</span> &lt;&lt; integers.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; elements: &quot;</span>;</span><br><span class="line">	<span class="built_in">DisplayVector</span>(integers);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="17-4-STL-deque类"><a href="#17-4-STL-deque类" class="headerlink" title="17.4 STL deque类"></a>17.4 STL deque类</h2><p>​	<strong>deque是一个STL动态数组类，与下面非常类似，但支持在数组开头和末尾插入或删除元素</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单17.8 实例化一个STL deque，并使用函数push_front()和pop_front()在开头插入和删除元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	deque&lt;<span class="type">int</span>&gt; inDeque;</span><br><span class="line"></span><br><span class="line">	inDeque.<span class="built_in">push_back</span>(<span class="number">3</span>);</span><br><span class="line">	inDeque.<span class="built_in">push_back</span>(<span class="number">4</span>);</span><br><span class="line">	inDeque.<span class="built_in">push_back</span>(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">	inDeque.<span class="built_in">push_front</span>(<span class="number">2</span>);</span><br><span class="line">	inDeque.<span class="built_in">push_front</span>(<span class="number">1</span>);</span><br><span class="line">	inDeque.<span class="built_in">push_front</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of the deque after inserting elements &quot;</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;at the top and bottom are: &quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">size_t</span> count = <span class="number">0</span>; count &lt; inDeque.<span class="built_in">size</span>(); count++) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Element [&quot;</span> &lt;&lt; count &lt;&lt; <span class="string">&quot;] = &quot;</span> &lt;&lt; inDeque[count] &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	inDeque.<span class="built_in">pop_front</span>();</span><br><span class="line"></span><br><span class="line">	inDeque.<span class="built_in">pop_back</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> element = inDeque.<span class="built_in">begin</span>(); element != inDeque.<span class="built_in">end</span>(); element++) &#123;</span><br><span class="line">		<span class="type">size_t</span> Offset = <span class="built_in">distance</span>(inDeque.<span class="built_in">begin</span>(), element);</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Element [&quot;</span> &lt;&lt; Offset &lt;&lt; <span class="string">&quot;] = &quot;</span> &lt;&lt; *element &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="17-7-作业"><a href="#17-7-作业" class="headerlink" title="17.7 作业"></a>17.7 作业</h2><p><strong>17.7.1 测验</strong></p>
<ol>
<li><p><strong>在vector 的开头或中间插入元素时，所需的时间是否是固定的？</strong>  </p>
<p><strong>答</strong>：否</p>
</li>
<li><p><strong>有一个vector，对其调用函数size( )和capacity( )时分别返回10和20。还可再插入多少个元素 而不会导致vector重新分配其缓冲区？</strong> </p>
<p><strong>答</strong>：10个元素</p>
</li>
<li><p><strong>pop_back()函数有何功能？</strong>  </p>
<p><strong>答</strong>：删除最后一个元素</p>
</li>
<li><p><strong>如果vector 是一个整型动态数组，那vector<Mammal> 是什么类型的动态数组？</strong> </p>
<p><strong>答</strong>：Mammal动态数组</p>
</li>
<li><p><strong>能否随机访问vector中的元素？如果是，如何访问？</strong> </p>
<p><strong>答</strong>：能，使用数组下标，迭代器或使用成员函数at()进行访问</p>
</li>
<li><p><strong>哪种迭代器可用于随机访问vector中的元素？</strong></p>
</li>
</ol>
<p>   <strong>答</strong>：随机访问迭代器</p>
<p><strong>17.7.2 练习</strong></p>
<ol>
<li><p><strong>编写一个交互式程序，它接受用户输入的整数并将其存储到vector中。用户应能够随时使用索 引查询vector中存储的值。</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">char</span> <span class="title">DisplayOptions</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;What would you like to do?&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Select 1 To enter an integer&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Select 2 Query a value given an index&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Select 3 To display the vector&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Select 4 To quit&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> ch = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; ch;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ch;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; vecData;</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> chUserChoice = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> ((chUserChoice = <span class="built_in">DisplayOptions</span>()) != <span class="string">&#x27;4&#x27;</span>) &#123;</span><br><span class="line">		<span class="keyword">switch</span> (chUserChoice)</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">		&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Please enter an integer to be inserted: &quot;</span>;</span><br><span class="line">			<span class="type">int</span> val = <span class="number">0</span>;</span><br><span class="line">			cin &gt;&gt; val;</span><br><span class="line">			vecData.<span class="built_in">push_back</span>(val);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">		&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Please enter an index between 0 and &quot;</span> &lt;&lt; vecData.<span class="built_in">size</span>() - <span class="number">1</span> &lt;&lt; <span class="string">&quot; : &quot;</span>;</span><br><span class="line">			<span class="type">size_t</span> index = <span class="number">0</span>;</span><br><span class="line">			cin &gt;&gt; index;</span><br><span class="line">			<span class="keyword">if</span> (index &lt; vecData.<span class="built_in">size</span>()) &#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;Element [&quot;</span> &lt;&lt; index &lt;&lt; <span class="string">&quot;] = &quot;</span> &lt;&lt; vecData[index] &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; vecData.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">				cout &lt;&lt; vecData[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			cout &lt;&lt; endl;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>对练习1中的程序进行扩展，使其能够告诉用户他查询的值是否在vector中。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">char</span> <span class="title">DisplayOptions</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;What would you like to do?&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Select 1 To enter an integer&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Select 2 Query a value given an index&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Select 3 To display the vector&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Select 4 To quit&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Select 5 TO Query whether a value exists&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> ch = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; ch;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ch;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; vecData;</span><br><span class="line"></span><br><span class="line">	<span class="type">char</span> chUserChoice = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span> ((chUserChoice = <span class="built_in">DisplayOptions</span>()) != <span class="string">&#x27;4&#x27;</span>) &#123;</span><br><span class="line">		<span class="keyword">switch</span> (chUserChoice)</span><br><span class="line">		&#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;1&#x27;</span>:</span><br><span class="line">		&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Please enter an integer to be inserted: &quot;</span>;</span><br><span class="line">			<span class="type">int</span> val = <span class="number">0</span>;</span><br><span class="line">			cin &gt;&gt; val;</span><br><span class="line">			vecData.<span class="built_in">push_back</span>(val);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;2&#x27;</span>:</span><br><span class="line">		&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Please enter an index between 0 and &quot;</span> &lt;&lt; vecData.<span class="built_in">size</span>() - <span class="number">1</span> &lt;&lt; <span class="string">&quot; : &quot;</span>;</span><br><span class="line">			<span class="type">size_t</span> index = <span class="number">0</span>;</span><br><span class="line">			cin &gt;&gt; index;</span><br><span class="line">			<span class="keyword">if</span> (index &lt; vecData.<span class="built_in">size</span>()) &#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;Element [&quot;</span> &lt;&lt; index &lt;&lt; <span class="string">&quot;] = &quot;</span> &lt;&lt; vecData[index] &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;3&#x27;</span>:</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; vecData.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">				cout &lt;&lt; vecData[i] &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			cout &lt;&lt; endl;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;4&#x27;</span>:<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;5&#x27;</span>:</span><br><span class="line">		&#123;</span><br><span class="line">			cout &lt;&lt; <span class="string">&quot;Please enter an value: &quot;</span>;</span><br><span class="line">			<span class="type">int</span> val = <span class="number">0</span>;</span><br><span class="line">			cin &gt;&gt; val;</span><br><span class="line">			<span class="keyword">if</span> (<span class="built_in">find</span>(vecData.<span class="built_in">begin</span>(), vecData.<span class="built_in">end</span>(), val) != vecData.<span class="built_in">end</span>()) &#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;Found&quot;</span> &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span> &#123;</span><br><span class="line">				cout &lt;&lt; <span class="string">&quot;Not found&quot;</span> &lt;&lt; endl;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">default</span>:</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;  </span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Jack 在 eBay 销售广口瓶。为了帮助他打包和发货，请编写一个程序，让他能够输入每件商品 的尺寸，将其存储在vector中再显示到屏幕上。</strong>  </p>
</li>
<li><p><strong>编写一个应用程序，将一个队列初始化为包含以下3个字符串：Hello、Containers are cool!和 C++ is evolving!，并使用适用于各种队列的泛型函数来显示这些元素。另外，在这个应用程序 中，使用C++11引入的列表初始化和C++14引入的operator “”s。</strong> </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> deque&lt;T&gt;&amp; deq)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem : deq) &#123;</span><br><span class="line">		cout &lt;&lt; elem &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	deque&lt;string&gt; strDuque&#123; <span class="string">&quot;Hello&quot;</span>s,<span class="string">&quot;Containers are cool&quot;</span>s,<span class="string">&quot;C++ is evolving!&quot;</span>s &#125;;</span><br><span class="line">	<span class="built_in">Display</span>(strDuque);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第十八章"><a href="#第十八章" class="headerlink" title="第十八章"></a>第十八章</h1><h2 id="18-2-基本的list操作"><a href="#18-2-基本的list操作" class="headerlink" title="18.2 基本的list操作"></a>18.2 基本的list操作</h2><p><strong>18.2.1 实例化一个对象</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单18.1  各种实例化std::list的方式：指定元素数和初始值</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	list&lt;<span class="type">int</span>&gt;  listInt;</span><br><span class="line"></span><br><span class="line">	<span class="function">list&lt;<span class="type">int</span>&gt; <span class="title">listWith10Integers</span><span class="params">(<span class="number">10</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">list&lt;<span class="type">int</span>&gt; <span class="title">listWith4IntegerEach99</span><span class="params">(<span class="number">10</span>, <span class="number">99</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">list&lt;<span class="type">int</span>&gt; <span class="title">listCopyAnother</span><span class="params">(listWith4IntegerEach99)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">vecIntegers</span><span class="params">(<span class="number">10</span>, <span class="number">2017</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">list&lt;<span class="type">int</span>&gt; <span class="title">listContainsCopyOfAnother</span><span class="params">(vecIntegers.cbegin(), vecIntegers.cend())</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<p><strong>18.2.2   在list 开头或末尾插入元素</strong></p>
<p>​	<strong>与deque 类似，要在list 开头插入元素，可使用其成员方法push_front()。要在末尾插入，可使用 成员方法push_back()。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单18.2  使用push_front()和push_back()在 list 中插入元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	list&lt;<span class="type">int</span>&gt; linkInts&#123; <span class="number">-101</span>,<span class="number">42</span> &#125;;</span><br><span class="line"></span><br><span class="line">	linkInts.<span class="built_in">push_front</span>(<span class="number">10</span>);</span><br><span class="line">	linkInts.<span class="built_in">push_front</span>(<span class="number">2011</span>);</span><br><span class="line">	linkInts.<span class="built_in">push_back</span>(<span class="number">-1</span>);</span><br><span class="line">	linkInts.<span class="built_in">push_back</span>(<span class="number">9999</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">Display</span>(linkInts);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>18.2.3   在list 中间插入元素</strong></p>
<p>​	<strong>成员函数list::insert()有 3 种版本</strong></p>
<ul>
<li><p>第1种版本：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">iterator <span class="title">insert</span><span class="params">(iterator pos, <span class="type">const</span> T&amp; x)</span></span>;</span><br><span class="line"><span class="comment">//insert 函数接受的第 1 个参数是插入位置，第2个参数是要插入的值。该函数返回一个迭代器，它指向刚插入到list中的元素。</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>第2种版本：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(iterator pos, size_type n, <span class="type">const</span> T&amp; x)</span></span>;</span><br><span class="line"><span class="comment">//该函数的第1个参数是插入位置，最后一个参数是要插入的值，而第2个参数是要插入的元素个数。 </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>第3种版本：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">class</span> <span class="title class_">InputIterator</span>&gt; </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">insert</span><span class="params">(iterator pos, InputIterator f, InputIterator l)</span></span>;</span><br><span class="line"><span class="comment">//该重载版本是一个模板函数，除一个位置参数外，它还接受两个输入迭代器，指定要将集合中相应范围内的元素插入到list 中。注意，输入类型 InputIterator 是一种模板参数化类型，因此可指定任何集合（数组、vector或另一个list）的边界。</span></span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单18.3  在list中插入元素的各种方法</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	list&lt;<span class="type">int</span>&gt; linkInts1;</span><br><span class="line"></span><br><span class="line">	linkInts<span class="number">1.</span><span class="built_in">insert</span>(linkInts<span class="number">1.</span><span class="built_in">begin</span>(), <span class="number">2</span>);</span><br><span class="line">	linkInts<span class="number">1.</span><span class="built_in">insert</span>(linkInts<span class="number">1.</span><span class="built_in">begin</span>(), <span class="number">1</span>);</span><br><span class="line">	linkInts<span class="number">1.</span><span class="built_in">insert</span>(linkInts<span class="number">1.</span><span class="built_in">end</span>(), <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">Display</span>(linkInts1);</span><br><span class="line"></span><br><span class="line">	list&lt;<span class="type">int</span>&gt; linkInts2;</span><br><span class="line">	linkInts<span class="number">2.</span><span class="built_in">insert</span>(linkInts<span class="number">2.</span><span class="built_in">begin</span>(), <span class="number">4</span>,<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of list 2 after inserting &quot;</span>;</span><br><span class="line">	cout &lt;&lt; linkInts<span class="number">2.</span><span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; elements of a value:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(linkInts2);</span><br><span class="line"></span><br><span class="line">	list&lt;<span class="type">int</span>&gt; linkInts3;</span><br><span class="line">	linkInts<span class="number">3.</span><span class="built_in">insert</span>(linkInts<span class="number">3.</span><span class="built_in">end</span>(), linkInts<span class="number">1.</span><span class="built_in">begin</span>(), linkInts<span class="number">1.</span><span class="built_in">end</span>());</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of list 3 after inserting the contents of list 1 at the beginning:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(linkInts3);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of list 3 after inserting the contents of list 2 at the end:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	linkInts<span class="number">3.</span><span class="built_in">insert</span>(linkInts<span class="number">3.</span><span class="built_in">end</span>(), linkInts<span class="number">2.</span><span class="built_in">begin</span>(), linkInts<span class="number">2.</span><span class="built_in">end</span>());</span><br><span class="line">	<span class="built_in">Display</span>(linkInts3);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>**18.2.4   删除list 中的元素 **</p>
<p>​	<strong>list 的成员函数erase()有两种重载版本：一个接受一个迭代器参数并删除迭代器指向的元素；另一 个接受两个迭代器参数并删除指定范围内的所有元素。</strong> </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单18.4  删除list中的元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	list&lt;<span class="type">int</span>&gt; linkInts&#123;<span class="number">4</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">-1</span>,<span class="number">2017</span>&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> val2 = linkInts.<span class="built_in">insert</span>(linkInts.<span class="built_in">begin</span>(), <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Initial contents of the list:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(linkInts);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;After erasing element &quot;</span> &lt;&lt; *val2 &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	linkInts.<span class="built_in">erase</span>(val2);</span><br><span class="line"></span><br><span class="line">	linkInts.<span class="built_in">erase</span>(linkInts.<span class="built_in">begin</span>(), linkInts.<span class="built_in">end</span>());</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Number of elements after erasing range: &quot;</span> &lt;&lt; linkInts.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="18-3-对list-中的元素进行反转和排序"><a href="#18-3-对list-中的元素进行反转和排序" class="headerlink" title="18.3   对list 中的元素进行反转和排序"></a>18.3   对list 中的元素进行反转和排序</h2><p><strong>18.3.1   使用list::reverse( )反转元素的排列顺序</strong></p>
<p>​	<strong>list 提供了成员函数reverse()，该函数没有参数，它反转list中元素的排列顺序</strong></p>
<p>​	<code>linkInts.reverse();</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单18.5  反转list中元素的排列顺序</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	list&lt;<span class="type">int</span>&gt; linkInts&#123;<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>&#125;;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Initial contents of list:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(linkInts);</span><br><span class="line"></span><br><span class="line">	linkInts.<span class="built_in">reverse</span>();</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Contents of list after using reverse():&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(linkInts);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>18.3.2   对元素进行排序</strong></p>
<p>​	<strong>list 的成员函数sort()有两个版本，其中一个没有参数：</strong></p>
<p>​	<code>linkInts.sort();</code></p>
<p><strong>另一个接受一个二元谓词函数作为参数，让您能够指定排序标准：</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">SortPredicate_Descending</span> <span class="params">(<span class="type">const</span> <span class="type">int</span>&amp; lhs, <span class="type">const</span> <span class="type">int</span>&amp; rhs)</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">   <span class="comment">// define criteria for list::sort: return true for desired order </span></span><br><span class="line">   <span class="keyword">return</span> (lhs &gt; rhs); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// Use predicate to sort a list: </span></span><br><span class="line">linkInts.<span class="built_in">sort</span> (SortPredicate_Descending);</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Use predicate to sort a list: linkInts.sort (SortPredicate_Descending);</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">SortPredicate_Descending</span><span class="params">(<span class="type">const</span> <span class="type">int</span>&amp; lhs, <span class="type">const</span> <span class="type">int</span>&amp; rhs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (lhs &gt; rhs);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	list&lt;<span class="type">int</span>&gt; linkInts&#123;<span class="number">0</span>,<span class="number">-1</span>,<span class="number">2011</span>,<span class="number">444</span>,<span class="number">-5</span>&#125;;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Initial contents of list are - :&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(linkInts);</span><br><span class="line"></span><br><span class="line">	linkInts.<span class="built_in">sort</span>();</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Order after sort(): &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(linkInts);</span><br><span class="line"></span><br><span class="line">	linkInts.<span class="built_in">sort</span>(SortPredicate_Descending);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Order after sort() with a predicate:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(linkInts);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>18.3.3   对包含对象的list进行排序以及删除其中的元素</strong></p>
<p>采取下面两种方式之一</p>
<ul>
<li>在list包含的对象所属的类中，实现运算符&lt;</li>
<li>提供一个排序二元谓词—一个这样的函数，即接受两个输入值，并返回一个布尔值，指出第 一个值是否比第二个值小。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单18.7  存储对象的list：创建一个联系人列表</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContactItem</span></span><br><span class="line">&#123;</span><br><span class="line">	string name;</span><br><span class="line">	string phone;</span><br><span class="line">	string displayAs;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">ContactItem</span>(<span class="type">const</span> string&amp; conName, <span class="type">const</span> string&amp; conNum) </span><br><span class="line">	&#123;</span><br><span class="line">		name = conName;</span><br><span class="line">		phone = conNum;</span><br><span class="line">		displayAs = name + <span class="string">&quot; &quot;</span> + phone;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span> == (<span class="type">const</span> ContactItem&amp; itemToCompare) <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">return</span> (itemToCompare.name == name);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> ContactItem&amp; itemToCompare) <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> (itemToCompare.name &lt; name);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">operator</span> <span class="type">const</span> <span class="type">char</span>* () <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> displayAs.<span class="built_in">c_str</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">SortPredicate_Descending</span><span class="params">(<span class="type">const</span> ContactItem&amp; lhs, <span class="type">const</span> ContactItem&amp; rhs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (lhs.phone &lt; rhs.phone);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	list &lt;ContactItem&gt; contacts;</span><br><span class="line">	contacts.<span class="built_in">push_back</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Jack Welsch&quot;</span>, <span class="string">&quot;+1 7889879879&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">push_back</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Bill Gates&quot;</span>, <span class="string">&quot;+1 97789787998&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">push_back</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Angi Merkel&quot;</span>, <span class="string">&quot;+49 234565466&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">push_back</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Vlad Putin&quot;</span>, <span class="string">&quot;+7 66454564797&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">push_back</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Ben Affleck&quot;</span>, <span class="string">&quot;+1 745641314&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">push_back</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Dan Craig&quot;</span>, <span class="string">&quot;+44 123641976&quot;</span>));</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;List in initial order: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(contacts);</span><br><span class="line"></span><br><span class="line">	contacts.<span class="built_in">sort</span>();</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Sorting in alphabetical order via operator&lt;:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(contacts);</span><br><span class="line"></span><br><span class="line">	contacts.<span class="built_in">sort</span>(SortPredicate_Descending);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Sorting in order of phone numbers via predicate&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(contacts);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Erasing Putin from list: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	contacts.<span class="built_in">remove</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Vlad Putin&quot;</span>, <span class="string">&quot;&quot;</span>));</span><br><span class="line">	<span class="built_in">Display</span>(contacts);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>18.3.4  C++11 引入的 std::forward_list</strong></p>
<p>​	<strong>forward_list 的用法与 list 很像，但只能沿一个方向移动迭代器，且插入元素时只能使用函数 push_front( )，而不能使用 push_back( )。当然，总是可以使用insert( )及其重载版本在指定位置插入 元素。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单18.8  forward_list 的基本插入和删除操作 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;forward_list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	forward_list&lt;<span class="type">int</span>&gt; flistIntegers&#123; <span class="number">3</span>,<span class="number">4</span>,<span class="number">2</span>,<span class="number">2</span>,<span class="number">0</span> &#125;;</span><br><span class="line">	flistIntegers.<span class="built_in">push_front</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Contents of forward_list: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(flistIntegers);</span><br><span class="line"></span><br><span class="line">	flistIntegers.<span class="built_in">remove</span>(<span class="number">2</span>);</span><br><span class="line">	flistIntegers.<span class="built_in">sort</span>();</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Contents after removing 2 and sorting: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(flistIntegers);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>**18.6   作业 **</p>
<p><strong>18.6.1  测验</strong></p>
<ol>
<li><p><strong>与在开头或末尾插入元素相比，在STL list中间插入元素是否会降低性能？</strong></p>
<p><strong>答</strong>：不会</p>
</li>
<li><p><strong>假设有两个迭代器分别指向STL list对象中的两个元素，然后在这两个元素之间插入了一个元 素。请问这种插入是否会导致这两个迭代器无效？</strong></p>
<p><strong>答</strong>：不会</p>
</li>
<li><p><strong>如何清空std::list 的内容？</strong></p>
<p><strong>答</strong>：调用成员函数clear()或erase(list.begin(),list.end());</p>
</li>
<li><p><strong>能否在list中插入多个元素？</strong></p>
<p><strong>答</strong>：可以</p>
</li>
</ol>
<p><strong>18.6.2   练习</strong></p>
<ol>
<li><p><strong>编写一个程序，它接受用户输入的数字并将它们插入到list开头。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	list&lt;<span class="type">int</span>&gt; listInts;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Please enter a number: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> val = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">while</span> (cin &gt;&gt; val) &#123;</span><br><span class="line">		listInts.<span class="built_in">push_back</span>(val);</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Please enter a number: &quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">Display</span>(listInts);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>使用一个简短的程序来演示这样一点：在list中插入一个新元素，导致迭代器指向的元素的相 对位置发生变化后，该迭代器仍有效。</strong></p>
</li>
<li><p><strong>编写一个程序，使用list的insert()函数将一个vector的内容插入到一个STL list中。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list&lt;<span class="type">int</span>&gt; listInts;</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; vecInts&#123; <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span> &#125;;</span><br><span class="line"></span><br><span class="line">listInts.<span class="built_in">insert</span>(listInts.<span class="built_in">begin</span>(), vecInts.<span class="built_in">begin</span>(), vecInts.<span class="built_in">end</span>());</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写一个程序，对字符串list进行排序以及反转排列顺序。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">list&lt;string&gt; listStr;</span><br><span class="line">vector&lt;string&gt; vecStr&#123; <span class="string">&quot;1,2,3,4,5&quot;</span>,<span class="string">&quot;hfsjfkalfj&quot;</span>,<span class="string">&quot;ddd&quot;</span>,<span class="string">&quot;wwafa&quot;</span>&#125;;</span><br><span class="line"></span><br><span class="line">listStr.<span class="built_in">insert</span>(listStr.<span class="built_in">begin</span>(), vecStr.<span class="built_in">begin</span>(), vecStr.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">listStr.<span class="built_in">sort</span>();</span><br><span class="line">listStr.<span class="built_in">reverse</span>();</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第十九章"><a href="#第十九章" class="headerlink" title="第十九章"></a>第十九章</h1><h2 id="19-1-简介"><a href="#19-1-简介" class="headerlink" title="19.1  简介"></a>19.1  简介</h2><p>​	<strong>容器set和multiset让程序员能够在容器中快速查找键，键是存储在一维容器中的值。set和multiset 之间的区别在于，后者可存储重复的值，而前者只能存储唯一的值。为了实现快速搜索，STL set和multiset的内部结构像二叉树，这意味着将元素插入到set或multiset 时将对其进行排序，以提高查找速度。</strong></p>
<h2 id="19-2-STL-set-和-multiset-的基本操作"><a href="#19-2-STL-set-和-multiset-的基本操作" class="headerlink" title="19.2  STL set 和 multiset 的基本操作"></a>19.2  STL set 和 multiset 的基本操作</h2><p><strong>19.2.1   实例化std::set 对象</strong></p>
<ul>
<li><p>要实例化一个特定类型的set或multiset，必须针对该类型具体化模板类std::set或std::multiset</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::set &lt;<span class="type">int</span>&gt; setInts; </span><br><span class="line">std::multiset &lt;<span class="type">int</span>&gt; msetInts; </span><br></pre></td></tr></table></figure>
</li>
<li><p>要声明一个包含Tuna对象的set或multiset，应这样编写代码</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::set &lt;Tuna&gt; tunaSet; </span><br><span class="line">std::multiset &lt;Tuna&gt; tunaMSet; </span><br></pre></td></tr></table></figure>
</li>
<li><p>要声明一个指向set或multiset中元素的迭代器，应这样做</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::set&lt;<span class="type">int</span>&gt;::const_iterator element; </span><br><span class="line">std::multiset&lt;<span class="type">int</span>&gt;::const_iterator element;</span><br></pre></td></tr></table></figure>
</li>
<li><p>创建二元排序谓词,指定初始化序列</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; </span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SortDescending</span> </span><br><span class="line">&#123; </span><br><span class="line">   <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; lhs, <span class="type">const</span> T&amp; rhs)</span> <span class="type">const</span> </span></span><br><span class="line"><span class="function">   </span>&#123; </span><br><span class="line">      <span class="keyword">return</span> (lhs &gt; rhs); </span><br><span class="line">   &#125; </span><br><span class="line">&#125;; </span><br><span class="line"></span><br><span class="line"><span class="comment">// a set and multiset of integers (using sort predicate) </span></span><br><span class="line">set &lt;<span class="type">int</span>, SortDescending&lt;<span class="type">int</span>&gt;&gt; setInts; </span><br><span class="line">multiset &lt;<span class="type">int</span>, SortDescending&lt;<span class="type">int</span>&gt;&gt; msetInts;</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单19.1  各种实例化set和multiset的方式</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">SortDescending</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; lhs, <span class="type">const</span> T&amp; rhs)</span><span class="type">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (lhs &gt; rhs);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	set&lt;<span class="type">int</span>&gt; setInts1;</span><br><span class="line">	multiset&lt;<span class="type">int</span>&gt; msetInts1;</span><br><span class="line"></span><br><span class="line">	set&lt;<span class="type">int</span>, SortDescending&lt;<span class="type">int</span>&gt;&gt; setInts2;</span><br><span class="line">	multiset&lt;<span class="type">int</span>, SortDescending&lt;<span class="type">int</span>&gt;&gt; msetInts2;</span><br><span class="line"></span><br><span class="line">	<span class="function">set&lt;<span class="type">int</span>&gt; <span class="title">setInts3</span><span class="params">(setInts1)</span></span>;</span><br><span class="line">	<span class="function">set&lt;<span class="type">int</span>&gt; <span class="title">msetInts3</span><span class="params">(setInts<span class="number">1.</span>cbegin(),setInts<span class="number">1.</span>end())</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>19.2.2   在set 或multiset 中插入元素</strong></p>
<p>​	<strong>set 和 multiset 的大多数函数的用法类似，它们接受类似的参数，返回类型也类似。例如，要在这 两种容器中插入元素，都可使用成员函数insert()，这个函数接受要插入的值或容器的指定范围</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单19.2  在STL set或multiset 中插入元素 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	set&lt;<span class="type">int</span>&gt; setInts&#123; <span class="number">202</span>,<span class="number">151</span>,<span class="number">-999</span>,<span class="number">-1</span> &#125;;</span><br><span class="line">	setInts.<span class="built_in">insert</span>(<span class="number">-1</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Contents of the set: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(setInts);</span><br><span class="line"></span><br><span class="line">	multiset&lt;<span class="type">int</span>&gt; msetInts;</span><br><span class="line">	msetInts.<span class="built_in">insert</span>(setInts.<span class="built_in">begin</span>(), setInts.<span class="built_in">end</span>());</span><br><span class="line">	msetInts.<span class="built_in">insert</span>(<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Contents of the multiset: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(msetInts);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Number of instances of -1 in the multiset are: &quot;</span> &lt;&lt; msetInts.<span class="built_in">count</span>(<span class="number">-1</span>) &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>19.2.3   在STL set 或 multiset 中查找元素</strong></p>
<p>​	<strong>诸如set、multiset、map 和 multimap 等关联容器都提供了成员函数find( )，它让您能够根据给定的 键来查找值。multiset可包含多个值相同的元素，因此对于multiset，这个 函数查找第一个与给定键匹配的元素。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单19.3  使用成员函数find</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	set&lt;<span class="type">int</span>&gt; setInts&#123; <span class="number">43</span>,<span class="number">78</span>,<span class="number">-1</span>,<span class="number">124</span> &#125;;</span><br><span class="line">	<span class="built_in">Display</span>(setInts);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> element = setInts.<span class="built_in">find</span>(<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (element != setInts.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Element &quot;</span> &lt;&lt; *element &lt;&lt; <span class="string">&quot; found！&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Element not found in set!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> anotherFind = setInts.<span class="built_in">find</span>(<span class="number">12345</span>);</span><br><span class="line">	<span class="keyword">if</span> (anotherFind != setInts.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Element &quot;</span> &lt;&lt; *anotherFind &lt;&lt; <span class="string">&quot; found！&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Element not found in set!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>19.2.4   删除STL set 或multiset 中的元素</strong></p>
<ul>
<li><p>诸如set、multiset、map 和 multimap 等关联容器都提供了成员函数erase( )，它让您能够根据键删除值</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setObject.<span class="built_in">erase</span> (key); </span><br></pre></td></tr></table></figure>
</li>
<li><p>erase()函数的另一个版本接受一个迭代器作为参数，并删除该迭代器指向的元素</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setObject.<span class="built_in">erase</span> (element);</span><br></pre></td></tr></table></figure>
</li>
<li><p>通过使用迭代器指定的边界，可将指定范围内的所有元素都从set或multiset中删除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">setObject.erase (iLowerBound, iUpperBound);</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单19.4  使用multiset的成员函数erase</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> multiset&lt;<span class="type">int</span>&gt; MSETINT;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	MSETINT msetInts&#123; <span class="number">43</span>,<span class="number">78</span>,<span class="number">78</span>,<span class="number">-1</span>,<span class="number">124</span> &#125;;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;multiset contains &quot;</span> &lt;&lt; msetInts.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot;elements: &quot;</span>;</span><br><span class="line">	<span class="built_in">Display</span>(msetInts);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter a number to erase from the set: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> input = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; input;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Erasing &quot;</span> &lt;&lt; msetInts.<span class="built_in">count</span>(input);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot; instances of value &quot;</span> &lt;&lt; input &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	msetInts.<span class="built_in">erase</span>(input);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;multiset now contains &quot;</span> &lt;&lt; msetInts.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot;elements: &quot;</span>;</span><br><span class="line">	<span class="built_in">Display</span>(msetInts);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单19.5  一个使用STL set及其成员函数find和erase的电话簿</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContactItem</span></span><br><span class="line">&#123;</span><br><span class="line">	string name;</span><br><span class="line">	string phone;</span><br><span class="line">	string displayAs;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">ContactItem</span>(<span class="type">const</span> string&amp; conName, <span class="type">const</span> string&amp; conNum)</span><br><span class="line">	&#123;</span><br><span class="line">		name = conName;</span><br><span class="line">		phone = conNum;</span><br><span class="line">		displayAs = name + <span class="string">&quot; &quot;</span> + phone;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span> == (<span class="type">const</span> ContactItem&amp; itemToCompare) <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">return</span> (itemToCompare.name == name);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> ContactItem&amp; itemToCompare) <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> (itemToCompare.name &lt; name);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">operator</span> <span class="type">const</span> <span class="type">char</span>* () <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> displayAs.<span class="built_in">c_str</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">SortPredicate_Descending</span><span class="params">(<span class="type">const</span> ContactItem&amp; lhs, <span class="type">const</span> ContactItem&amp; rhs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (lhs.phone &lt; rhs.phone);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	set &lt;ContactItem&gt; contacts;</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Jack Welsch&quot;</span>, <span class="string">&quot;+1 7889879879&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Bill Gates&quot;</span>, <span class="string">&quot;+1 97789787998&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Angi Merkel&quot;</span>, <span class="string">&quot;+49 234565466&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Vlad Putin&quot;</span>, <span class="string">&quot;+7 66454564797&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Ben Affleck&quot;</span>, <span class="string">&quot;+1 745641314&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Dan Craig&quot;</span>, <span class="string">&quot;+44 123641976&quot;</span>));</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter a name you wish to delete: &quot;</span>;</span><br><span class="line">	string inputName;</span><br><span class="line">	<span class="built_in">getline</span>(cin, inputName);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> contactFound = contacts.<span class="built_in">find</span>(<span class="built_in">ContactItem</span>(inputName, <span class="string">&quot;&quot;</span>));</span><br><span class="line">	<span class="keyword">if</span> (contactFound != contacts.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		contacts.<span class="built_in">erase</span>(contactFound);</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Display contents after erasing &quot;</span> &lt;&lt; inputName &lt;&lt; endl;</span><br><span class="line">		<span class="built_in">Display</span>(contacts);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Contact not found&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="19-6-作业"><a href="#19-6-作业" class="headerlink" title="19.6   作业"></a>19.6   作业</h2><p><strong>19.6.1   测验</strong></p>
<ol>
<li><p><strong>使用set 声明整型set 时，排序标准将由哪个函数提供？</strong></p>
<p><strong>答</strong>：less&lt;&gt;</p>
</li>
<li><p><strong>在multiset 中，重复的值以什么方式出现？</strong></p>
<p><strong>答</strong>：在插入时排序，因此值相同的元素将在一起</p>
</li>
<li><p><strong>set 和multiset 的哪个成员函数指出容器包含多少个元素？</strong></p>
<p><strong>答</strong>：size(0)</p>
</li>
</ol>
<p><strong>19.6.2   练习</strong></p>
<ol>
<li><p><strong>在不修改 ContactItem 的情况下，扩展本章的电话簿应用程序，使其能够根据电话号码查找人 名（提示：调整运算符&lt;和&#x3D;&#x3D;，确保根据电话号码对元素进行比较和排序）。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ContactItem</span></span><br><span class="line">&#123;</span><br><span class="line">	string name;</span><br><span class="line">	string phone;</span><br><span class="line">	string displayAs;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">ContactItem</span>(<span class="type">const</span> string&amp; conName, <span class="type">const</span> string&amp; conNum)</span><br><span class="line">	&#123;</span><br><span class="line">		name = conName;</span><br><span class="line">		phone = conNum;</span><br><span class="line">		displayAs = name + <span class="string">&quot; &quot;</span> + phone;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span> == (<span class="type">const</span> ContactItem&amp; itemToCompare) <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">return</span> (itemToCompare.phone == phone);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span> &lt; (<span class="type">const</span> ContactItem&amp; itemToCompare) <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> (itemToCompare.phone &gt; phone);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">operator</span> <span class="type">const</span> <span class="type">char</span>* () <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> displayAs.<span class="built_in">c_str</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">SortPredicate_Descending</span><span class="params">(<span class="type">const</span> ContactItem&amp; lhs, <span class="type">const</span> ContactItem&amp; rhs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> (lhs.phone &lt; rhs.phone);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	set &lt;ContactItem&gt; contacts;</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Jack Welsch&quot;</span>, <span class="string">&quot;+1 7889879879&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Bill Gates&quot;</span>, <span class="string">&quot;+1 97789787998&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Angi Merkel&quot;</span>, <span class="string">&quot;+49 234565466&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Vlad Putin&quot;</span>, <span class="string">&quot;+7 66454564797&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Ben Affleck&quot;</span>, <span class="string">&quot;+1 745641314&quot;</span>));</span><br><span class="line">	contacts.<span class="built_in">insert</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;Dan Craig&quot;</span>, <span class="string">&quot;+44 123641976&quot;</span>));</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter a name you wish to delete: &quot;</span>;</span><br><span class="line">	string inputName;</span><br><span class="line">	<span class="built_in">getline</span>(cin, inputName);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> contactFound = contacts.<span class="built_in">find</span>(<span class="built_in">ContactItem</span>(<span class="string">&quot;&quot;</span>, inputName));</span><br><span class="line">	<span class="keyword">if</span> (contactFound != contacts.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;The number belongs to &quot;</span> &lt;&lt; contactFound-&gt;name &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Contact not found&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
<li><p><strong>定义一个multiset 来存储单词及其含义，即将multiset用作词典（提示：multiset存储的对象应 是一个包含两个字符串的结构，其中一个字符串为单词，另一个字符串是单词的含义）。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PAIR_WORD_MEANING</span></span><br><span class="line">&#123;</span><br><span class="line">	string word;</span><br><span class="line">	string meaning;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">PAIR_WORD_MEANING</span>(<span class="type">const</span> string&amp; sWord, <span class="type">const</span> string&amp; sMeaning)</span><br><span class="line">		:<span class="built_in">word</span>(sWord),<span class="built_in">meaning</span>(sMeaning)&#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> PAIR_WORD_MEANING&amp; pairAnotherWord) <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> (word &lt; pairAnotherWord.word);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="type">bool</span> <span class="keyword">operator</span>==(<span class="type">const</span> string&amp; key)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> key == <span class="keyword">this</span>-&gt;word;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	multiset&lt; PAIR_WORD_MEANING&gt; msetDictionary;</span><br><span class="line">	<span class="function">PAIR_WORD_MEANING <span class="title">word1</span><span class="params">(<span class="string">&quot;C++&quot;</span>, <span class="string">&quot;A programming language&quot;</span>)</span></span>;</span><br><span class="line">	<span class="function">PAIR_WORD_MEANING <span class="title">word2</span><span class="params">(<span class="string">&quot;Programmer&quot;</span>, <span class="string">&quot;A geek!&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	msetDictionary.<span class="built_in">insert</span>(word1);</span><br><span class="line">	msetDictionary.<span class="built_in">insert</span>(word2);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter a word you wish to find the meaning off&quot;</span> &lt;&lt; endl;</span><br><span class="line">	string input;</span><br><span class="line">	<span class="built_in">getline</span>(cin, input);</span><br><span class="line">	<span class="keyword">auto</span> element = msetDictionary.<span class="built_in">find</span>(<span class="built_in">PAIR_WORD_MEANING</span>(input, <span class="string">&quot;&quot;</span>));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (element != msetDictionary.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Meaning is: &quot;</span> &lt;&lt; element-&gt;meaning &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>通过一个简单程序演示set不接受重复的元素，而multiset接受。</strong> </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;set&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = container.<span class="built_in">begin</span>(); elem != container.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">		cout &lt;&lt; *elem &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	set&lt;<span class="type">int</span>&gt; setInts;</span><br><span class="line">	setInts.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">	setInts.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">	setInts.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">	setInts.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">	setInts.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">Display</span>(setInts);</span><br><span class="line"></span><br><span class="line">	multiset&lt;<span class="type">int</span>&gt; msetInts;</span><br><span class="line">	msetInts.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">	msetInts.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">	msetInts.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">	msetInts.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">	msetInts.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="built_in">Display</span>(msetInts);</span><br><span class="line">	msetInts.<span class="built_in">insert</span>(<span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第二十章"><a href="#第二十章" class="headerlink" title="第二十章"></a>第二十章</h1><h2 id="20-2-STL-map-和multimap-的基本操作"><a href="#20-2-STL-map-和multimap-的基本操作" class="headerlink" title="20.2  STL map 和multimap 的基本操作"></a>20.2  STL map 和multimap 的基本操作</h2><p>​	<strong>要实例化将整数用作键、将字符串用作值的 map 或 multimap，必须具体化模板类 std::map 或 std::multimap。实例化模板类 map 时，需要指定键和值的类型以及可选的谓词（它帮助map类对插入 的元素进行排序）</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">map &lt;keyType, valueType, Predicate=std::less &lt;keyType&gt;&gt; mapObj; </span><br><span class="line">multimap &lt;keyType, valueType, Predicate=std::less &lt;keyType&gt;&gt; mmapObj;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单20.1  实例化STL map和multimap（键类型为int，值类型为string）</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> keyType&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ReverseSort</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> keyType&amp; key1, <span class="type">const</span> keyType&amp; key2)</span> <span class="type">const</span> <span class="comment">// 添加 const 修饰符</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> key1 &gt; key2;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	map&lt;<span class="type">int</span>, string&gt; mapIntToStr1;</span><br><span class="line">	multimap&lt;<span class="type">int</span>, string&gt; mmapIntToStr1;</span><br><span class="line"></span><br><span class="line">	<span class="function">map&lt;<span class="type">int</span>, string&gt; <span class="title">mapIntToStr2</span><span class="params">(mapIntToStr1)</span></span>;</span><br><span class="line">	<span class="function">multimap&lt;<span class="type">int</span>, string&gt; <span class="title">mmapIntToStr2</span><span class="params">(mmapIntToStr1)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">map&lt;<span class="type">int</span>, string&gt; <span class="title">mapIntToStr3</span><span class="params">(mapIntToStr<span class="number">1.</span>cbegin(), mapIntToStr<span class="number">1.</span>cend())</span></span>;</span><br><span class="line">	<span class="function">multimap&lt;<span class="type">int</span>, string&gt; <span class="title">mmapIntToStr3</span><span class="params">(mmapIntToStr<span class="number">1.</span>cbegin(), mmapIntToStr<span class="number">1.</span>cend())</span></span>;</span><br><span class="line"></span><br><span class="line">	map&lt;<span class="type">int</span>, string, ReverseSort&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">mapIntToStr4</span>(mapIntToStr<span class="number">1.</span><span class="built_in">begin</span>(), mapIntToStr<span class="number">1.</span><span class="built_in">end</span>());</span><br><span class="line">	multimap&lt;<span class="type">int</span>, string, ReverseSort&lt;<span class="type">int</span>&gt;&gt; <span class="built_in">mmapIntToStr4</span>(mapIntToStr<span class="number">1.</span><span class="built_in">cbegin</span>(), mapIntToStr<span class="number">1.</span><span class="built_in">cend</span>());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>20.2.2   在STL map 或multimap 中插入元素</strong></p>
<p>​	<strong>map 和multimap 的大多数函数的用法类似，它们接受类似的参数，返回类型也类似。例如，要在 这两种容器中插入元素，都可使用成员函数insert</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">std::map&lt;<span class="type">int</span>, std::string&gt; mapIntToStr1; </span><br><span class="line"><span class="comment">// insert pair of key and value using make_pair function </span></span><br><span class="line">mapIntToStr.<span class="built_in">insert</span> (<span class="built_in">make_pair</span> (<span class="number">-1</span>, <span class="string">&quot;Minus One&quot;</span>)); </span><br></pre></td></tr></table></figure>

<p><strong>鉴于这两种容器包含的元素都是键-值对，因此也可直接使用std::pair来指定要插入的键和值</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mapIntToStr.<span class="built_in">insert</span> (pair &lt;<span class="type">int</span>, string&gt;(<span class="number">1000</span>, <span class="string">&quot;One Thousand&quot;</span>));</span><br></pre></td></tr></table></figure>

<p><strong>另外，还可使用类似于数组的语法进行插入。这种方式对用户不太友好，是由下标运算符（[]）支持</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mapIntToStr [<span class="number">1000000</span>] = <span class="string">&quot;One Million&quot;</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单20.2  使用insert( )以及数组语法（运算符[]）在STL map或multimap中插入元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> map&lt;<span class="type">int</span>, string&gt; MAP_INT_STRING;</span><br><span class="line"><span class="keyword">typedef</span> multimap&lt;<span class="type">int</span>, string&gt; MMAP_INT_STRING;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; cont)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = cont.<span class="built_in">begin</span>(); elem != cont.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">	</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;elem-&gt;first = &quot;</span> &lt;&lt; elem-&gt;first &lt;&lt; <span class="string">&quot; elem-&gt;second = &quot;</span> &lt;&lt; elem-&gt;second &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	MAP_INT_STRING mapIntToStr;</span><br><span class="line"></span><br><span class="line">	mapIntToStr.<span class="built_in">insert</span>(MAP_INT_STRING::<span class="built_in">value_type</span>(<span class="number">3</span>,<span class="string">&quot;Three&quot;</span>));</span><br><span class="line"></span><br><span class="line">	mapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">-1</span>, <span class="string">&quot;Minus one&quot;</span>));</span><br><span class="line"></span><br><span class="line">	mapIntToStr.<span class="built_in">insert</span>(<span class="built_in">pair</span>&lt;<span class="type">int</span>, string&gt;(<span class="number">1000</span>, <span class="string">&quot;One Thousand&quot;</span>));</span><br><span class="line"></span><br><span class="line">	mapIntToStr[<span class="number">1000000</span>] = <span class="string">&quot;One Million&quot;</span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The map contains &quot;</span> &lt;&lt; mapIntToStr.<span class="built_in">size</span>();</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot; key-value pairs. They are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(mapIntToStr);</span><br><span class="line"></span><br><span class="line">	<span class="function">MMAP_INT_STRING <span class="title">mmapIntToStr</span><span class="params">(mapIntToStr.cbegin(), mapIntToStr.cend())</span></span>;</span><br><span class="line">	mmapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">1000</span>, <span class="string">&quot;Thousand&quot;</span>));</span><br><span class="line">	cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;The multimap contains &quot;</span> &lt;&lt; mmapIntToStr.<span class="built_in">size</span>();</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot; key-value pair \. They are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The elements in the multimap are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(mmapIntToStr);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The number of pairs in the multimap with 1000 as their key: &quot;</span> &lt;&lt; mmapIntToStr.<span class="built_in">count</span>(<span class="number">1000</span>) &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>20.2.3   在STL map 或multimap 中查找元素</strong></p>
<p>​	<strong>诸如map和multimap 等关联容器都提供了成员函数find()，它让您能够根据给定的键查找值。 find( )总是返回一个迭代器</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单20.3  使用成员函数find()在map中查找键-值对</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; cont)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = cont.<span class="built_in">begin</span>(); elem != cont.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">	</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;elem-&gt;first = &quot;</span> &lt;&lt; elem-&gt;first &lt;&lt; <span class="string">&quot; elem-&gt;second = &quot;</span> &lt;&lt; elem-&gt;second &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	map&lt;<span class="type">int</span>, string&gt; mapIntToStr;</span><br><span class="line"></span><br><span class="line">	mapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">3</span>, <span class="string">&quot;Three&quot;</span>));</span><br><span class="line">	mapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">45</span>, <span class="string">&quot;Forty five&quot;</span>));</span><br><span class="line">	mapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">-1</span>, <span class="string">&quot;minus one&quot;</span>));</span><br><span class="line">	mapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">1000</span>, <span class="string">&quot;Thousand&quot;</span>));</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter the key you wish to find: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> key = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; key;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> pairFound = mapIntToStr.<span class="built_in">find</span>(key);</span><br><span class="line">	<span class="keyword">if</span> (pairFound != mapIntToStr.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Key &quot;</span> &lt;&lt; pairFound-&gt;first &lt;&lt; <span class="string">&quot; points to value: &quot;</span> &lt;&lt; pairFound-&gt;second &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Sorry,pair with key &quot;</span> &lt;&lt; key &lt;&lt; <span class="string">&quot; not in map&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>20.2.4   在STL multimap 中查找元素</strong></p>
<p>​	<strong>multimap，容器可能包含多个键相同的键-值对，因此需要找到与指定 键对应的所有值。为此，可使用multimap::count( )确定有多少个值与指定的键对应，再对迭代器递增， 以访问这些相邻的值</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> pairFound = mmapIntToStr.<span class="built_in">find</span>(key); </span><br><span class="line"><span class="comment">// Check if find() succeeded </span></span><br><span class="line"><span class="keyword">if</span>(pairFound != mmapIntToStr.<span class="built_in">end</span>()) </span><br><span class="line">&#123; </span><br><span class="line">    <span class="comment">// Find the number of pairs that have the same supplied key </span></span><br><span class="line">    <span class="type">size_t</span> numPairsInMap = mmapIntToStr.<span class="built_in">count</span>(<span class="number">1000</span>); </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">size_t</span> counter = <span class="number">0</span>; </span><br><span class="line">        counter &lt; numPairsInMap; <span class="comment">// stay within bounds </span></span><br><span class="line">        ++ counter ) </span><br><span class="line">    &#123; </span><br><span class="line">    &#125; </span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Key: &quot;</span> &lt;&lt; pairFound-&gt;first; <span class="comment">// key </span></span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;, Value [&quot;</span> &lt;&lt; counter &lt;&lt; <span class="string">&quot;] = &quot;</span>; </span><br><span class="line">        cout &lt;&lt; pairFound-&gt;second &lt;&lt; endl; <span class="comment">// value </span></span><br><span class="line">        ++ pairFound; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Element not found in the multimap&quot;</span>; </span><br></pre></td></tr></table></figure>

<p>**20.2.5   删除STL map或multimap 中的元素 **</p>
<ul>
<li><p>调用erase 函数时将键作为 参数，这将删除包含指定键的所有键-值对</p>
<p><code>mapObject.erase (key); </code></p>
</li>
<li><p>接受迭代器作为参数，并删除迭代器指向的元素</p>
<p><code>mapObject.erase(element);</code></p>
</li>
<li><p>可使用迭代器指定边界，从而将指定范围内的所有元素都从map或multimap中删除</p>
<p>&#96;mapObject.erase (lowerBound, upperBound);</p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单20.4  删除multimap中的元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; cont)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = cont.<span class="built_in">begin</span>(); elem != cont.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">	</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;elem-&gt;first = &quot;</span> &lt;&lt; elem-&gt;first &lt;&lt; <span class="string">&quot; elem-&gt;second = &quot;</span> &lt;&lt; elem-&gt;second &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	multimap&lt;<span class="type">int</span>, string&gt; mmapIntToStr;</span><br><span class="line"></span><br><span class="line">	mmapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">3</span>, <span class="string">&quot;Three&quot;</span>));</span><br><span class="line">	mmapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">45</span>, <span class="string">&quot;Forty five&quot;</span>));</span><br><span class="line">	mmapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">-1</span>, <span class="string">&quot;minus one&quot;</span>));</span><br><span class="line">	mmapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">1000</span>, <span class="string">&quot;Thousand&quot;</span>));</span><br><span class="line">	mmapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">-1</span>, <span class="string">&quot;minus one&quot;</span>));</span><br><span class="line">	mmapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">1000</span>, <span class="string">&quot;Thousand&quot;</span>));</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The multimap contains &quot;</span> &lt;&lt; mmapIntToStr.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot; key-value pairs. &quot;</span> &lt;&lt; <span class="string">&quot;They are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(mmapIntToStr);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> numPairErased = mmapIntToStr.<span class="built_in">erase</span>(<span class="number">-1</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Ereased &quot;</span> &lt;&lt; numPairErased &lt;&lt; <span class="string">&quot; pairs with -1 as key.&quot;</span> &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">auto</span> pair = mmapIntToStr.<span class="built_in">find</span>(<span class="number">45</span>);</span><br><span class="line">	<span class="keyword">if</span> (pair != mmapIntToStr.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		mmapIntToStr.<span class="built_in">erase</span>(<span class="number">45</span>);</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Erased a pair with 45 as key using an iterator&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Erasing the range of pair with 1000 as key.&quot;</span> &lt;&lt; endl;</span><br><span class="line">	mmapIntToStr.<span class="built_in">erase</span>(mmapIntToStr.<span class="built_in">lower_bound</span>(<span class="number">1000</span>), mmapIntToStr.<span class="built_in">upper_bound</span>(<span class="number">1000</span>));</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The multimap now contains &quot;</span> &lt;&lt; mmapIntToStr.<span class="built_in">size</span>();</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot; key-value pair(s).&quot;</span> &lt;&lt; <span class="string">&quot;They are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(mmapIntToStr);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="20-3-提供自定义的排序谓词"><a href="#20-3-提供自定义的排序谓词" class="headerlink" title="20.3   提供自定义的排序谓词"></a>20.3   提供自定义的排序谓词</h2><p>​	<strong>map 和multimap 的模板定义包含第3个参数，该参数是确保map能够正常工作的排序谓词。如果 没有指定这个参数，将使用std::less &lt;&gt;提供的默认排序标准，该谓词使用&lt;运算 符来比较两个对象。要提供不同的排序标准，可编写一个二元谓词—实现了operator( )的类或结构</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> keyType&gt; </span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Predicate</span> </span><br><span class="line">&#123; </span><br><span class="line">   <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> keyType&amp; key1, <span class="type">const</span> keyType&amp; key2)</span> </span></span><br><span class="line"><span class="function">   </span>&#123; </span><br><span class="line">      <span class="comment">// your sort priority logic here </span></span><br><span class="line">   &#125; </span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单20.5  提供自定义排序谓词—电话簿应用程序</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; cont)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = cont.<span class="built_in">begin</span>(); elem != cont.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">	</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;elem-&gt;first = &quot;</span> &lt;&lt; elem-&gt;first &lt;&lt; <span class="string">&quot; elem-&gt;second = &quot;</span> &lt;&lt; elem-&gt;second &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">PredIgnoreCase</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> string&amp; str1, <span class="type">const</span> string&amp; str2)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="function">string <span class="title">str1NoCase</span><span class="params">(str1)</span></span>;</span><br><span class="line">		<span class="function">string <span class="title">str2NoCase</span><span class="params">(str2)</span></span>;</span><br><span class="line">		<span class="built_in">transform</span>(str1NoCase.<span class="built_in">begin</span>(), str1NoCase.<span class="built_in">begin</span>(), str1NoCase.<span class="built_in">end</span>(), ::tolower);</span><br><span class="line">		<span class="built_in">transform</span>(str2NoCase.<span class="built_in">begin</span>(), str2NoCase.<span class="built_in">begin</span>(), str2NoCase.<span class="built_in">end</span>(), ::tolower);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> (str1NoCase &lt; str2NoCase);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> map&lt;string, string&gt; DIR_WITH_CASE;</span><br><span class="line"><span class="keyword">typedef</span> map&lt;string, string, PredIgnoreCase&gt; DIR_NOCASE;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	DIR_NOCASE dirWithCase;</span><br><span class="line"></span><br><span class="line">	dirWithCase.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="string">&quot;John&quot;</span>, <span class="string">&quot;2345764&quot;</span>));</span><br><span class="line">	dirWithCase.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="string">&quot;JOHN&quot;</span>, <span class="string">&quot;2345764&quot;</span>));</span><br><span class="line">	dirWithCase.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="string">&quot;Sara&quot;</span>, <span class="string">&quot;42367236&quot;</span>));</span><br><span class="line">	dirWithCase.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="string">&quot;Jack&quot;</span>, <span class="string">&quot;32435348&quot;</span>));</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Displaying contents of the case-sensitive map:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(dirWithCase);</span><br><span class="line"></span><br><span class="line">	<span class="function">DIR_NOCASE <span class="title">dirNoCase</span><span class="params">(dirWithCase.begin(), dirWithCase.end())</span></span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Displaying contents of the case-insensitive map:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(dirNoCase);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Please enter a name to search&quot;</span> &lt;&lt; <span class="string">&quot;&gt; &quot;</span>;</span><br><span class="line">	string name;</span><br><span class="line">	cin &gt;&gt; name;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> pairWithCase = dirWithCase.<span class="built_in">find</span>(name);</span><br><span class="line">	<span class="keyword">if</span> (pairWithCase != dirWithCase.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Num in case-sens. dir: &quot;</span> &lt;&lt; pairWithCase-&gt;second &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Num not found in case-sensitive dir&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> pairNoCase = dirNoCase.<span class="built_in">find</span>(name);</span><br><span class="line">	<span class="keyword">if</span> (pairNoCase != dirNoCase.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Num in case-sens. dir: &quot;</span> &lt;&lt; pairNoCase-&gt;second &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Num not found in case-sensitive dir&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="20-4-基于散列表的STL键-值对容器"><a href="#20-4-基于散列表的STL键-值对容器" class="headerlink" title="20.4   基于散列表的STL键-值对容器"></a>20.4   基于散列表的STL键-值对容器</h2><p><code>#include&lt;unordered_map&gt;</code></p>
<p>​	**unordered_map 的平均插入和删除时间是固定的，查找元素的时间也是固定的。 **</p>
<p>**20.4.2   使用unordered_map 和 unordered_multimap **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单 20.6  实例化 STL 散列表实现 unordered_map，并使用 insert( )、find( )、size( )、max_bucket_count( )、load_factor( )和 max_load_factor( )</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;unordered_map&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T1,<span class="keyword">typename</span> T2&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(unordered_map&lt;T1,T2&gt;&amp; cont)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Unordered Map contains: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem = cont.<span class="built_in">begin</span>(); elem != cont.<span class="built_in">end</span>(); elem++) &#123;</span><br><span class="line">	</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;elem-&gt;first = &quot;</span> &lt;&lt; elem-&gt;first &lt;&lt; <span class="string">&quot; elem-&gt;second = &quot;</span> &lt;&lt; elem-&gt;second &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Number of pairs, size(): &quot;</span> &lt;&lt; cont.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Bucket count = &quot;</span> &lt;&lt; cont.<span class="built_in">bucket_count</span>() &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Current load factor: &quot;</span> &lt;&lt; cont.<span class="built_in">load_factor</span>() &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Max load factor: &quot;</span> &lt;&lt; cont.<span class="built_in">max_load_factor</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	unordered_map&lt;<span class="type">int</span>, string&gt; umapIntToStr;</span><br><span class="line">	umapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">1</span>, <span class="string">&quot;One&quot;</span>));</span><br><span class="line">	umapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">45</span>, <span class="string">&quot;Forty Five&quot;</span>));</span><br><span class="line">	umapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">1001</span>, <span class="string">&quot;Thousand One&quot;</span>));</span><br><span class="line">	umapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">-2</span>, <span class="string">&quot;Minus Two&quot;</span>));</span><br><span class="line">	umapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">-1000</span>, <span class="string">&quot;Minus One Thousand&quot;</span>));</span><br><span class="line">	umapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">100</span>, <span class="string">&quot;One Hundred&quot;</span>));</span><br><span class="line">	umapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">12</span>, <span class="string">&quot;Twelve&quot;</span>));</span><br><span class="line">	umapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">-100</span>, <span class="string">&quot;Minus One Hundred&quot;</span>));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">Display</span>&lt;<span class="type">int</span>, string&gt;(umapIntToStr);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Inserting one more element&quot;</span> &lt;&lt; endl;</span><br><span class="line">	umapIntToStr.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">300</span>, <span class="string">&quot;Three Hundred&quot;</span>));</span><br><span class="line">	<span class="built_in">Display</span>&lt;<span class="type">int</span>, string&gt;(umapIntToStr);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter key to find for: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> key = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; key;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> element = umapIntToStr.<span class="built_in">find</span>(key);</span><br><span class="line">	<span class="keyword">if</span> (element != umapIntToStr.<span class="built_in">end</span>())&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Found Key pairs with value &quot;</span> &lt;&lt; element-&gt;second &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;key has no corresponding pair value!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="20-7-作业"><a href="#20-7-作业" class="headerlink" title="20.7   作业"></a>20.7   作业</h2><p>**20.7.1   测验 **</p>
<ol>
<li><p><strong>使用map 声明整型map时，排序标准将由哪个函数提供？</strong></p>
<p><strong>答</strong>：less&lt;&gt;</p>
</li>
<li><p><strong>在multimap 中，重复的值以什么方式出现？</strong></p>
<p><strong>答</strong>：彼此相邻</p>
</li>
<li><p><strong>map 和multimap 的哪个成员函数指出容器包含多少个元素？</strong></p>
<p><strong>答</strong>：size();</p>
</li>
<li><p><strong>在map中的什么地方可以找到重复的值？</strong></p>
<p><strong>答</strong>：map中找不到重复元素</p>
</li>
</ol>
<p><strong>20.7.2   练习</strong></p>
<ol>
<li><p><strong>编写一个应用程序来实现电话簿，它不要求人名是唯一的。应选择哪种容器？写出容器的定义。</strong></p>
<p>multimap</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mulitmap&lt;string,string&gt; telephoneDirectory;</span><br></pre></td></tr></table></figure>


</li>
<li><p><strong>下面是电话簿应用程序中一个map的定义。请定义二元谓词fPredicate，用于帮助该 map 根据WordProperty 键包含的 string 属性对元素 进行排序。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">map &lt;wordProperty, string, fPredicate&gt; mapWordDefinition;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">WordProperty</span> </span><br><span class="line">&#123; </span><br><span class="line">    string word; </span><br><span class="line">    <span class="type">bool</span> isLatinBase; </span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">fPredicate</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> wordProperty&amp; key1,<span class="type">const</span> wordProperty&amp; ket2)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> key<span class="number">1.</span>word &lt; key<span class="number">2.</span>word;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


</li>
<li><p><strong>map 不接受重复元素，而multimap接受；请编写一个简单程序来演示这一点。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;map&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	map&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mapIntToInt;</span><br><span class="line">	mapIntToInt.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">10</span>, <span class="number">10</span>));</span><br><span class="line">	mapIntToInt.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">10</span>, <span class="number">10</span>));</span><br><span class="line">	mapIntToInt.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">10</span>, <span class="number">10</span>));</span><br><span class="line">	mapIntToInt.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">10</span>, <span class="number">10</span>));</span><br><span class="line"></span><br><span class="line">	multimap&lt;<span class="type">int</span>, <span class="type">int</span>&gt; mmapIntToInt;</span><br><span class="line">	mmapIntToInt.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">10</span>, <span class="number">10</span>));</span><br><span class="line">	mmapIntToInt.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">10</span>, <span class="number">10</span>));</span><br><span class="line">	mmapIntToInt.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">10</span>, <span class="number">10</span>));</span><br><span class="line">	mmapIntToInt.<span class="built_in">insert</span>(<span class="built_in">make_pair</span>(<span class="number">10</span>, <span class="number">10</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第20章"><a href="#第20章" class="headerlink" title="第20章"></a>第20章</h1><h2 id="21-1-函数对象与谓词的概念"><a href="#21-1-函数对象与谓词的概念" class="headerlink" title="21.1   函数对象与谓词的概念"></a>21.1   函数对象与谓词的概念</h2><ol>
<li><strong>函数对象</strong>：是用作函数的对象；但从实现上说，函数对象是实现了operator()的类的对 象。虽然函数和函数指针也可归为函数对象，但实现了operator()的类的对象才能保存状态（即类的成 员属性的值），才能用于标准模板库（STL）算法。C++程序员常用于STL算法的函数对象可分为下列两种类型<ul>
<li>一元函数：接受一个参数的函数，如f(x)。如果一元函数返回一个布尔值，则该函数称为谓词</li>
<li>二元函数：接受两个参数的函数，如f(x, y)。如果二元函数返回一个布尔值，则该函数称为二元 谓词</li>
</ul>
</li>
<li><strong>谓词</strong>：返回布尔类型的函数对象通常用于需要进行判断的算法</li>
</ol>
<h2 id="21-2-函数对象的典型用途"><a href="#21-2-函数对象的典型用途" class="headerlink" title="21.2   函数对象的典型用途"></a>21.2   函数对象的典型用途</h2><p><strong>21.2.1   一元函数</strong></p>
<p>​	<strong>只对一个参数进行操作的函数称为一元函数。一元函数的功能可能很简单，如在屏幕上显示元素</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单21.1  使用一元函数将集合的内容显示在屏幕上</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Display</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="type">const</span> T&amp; element)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; element &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; numsInVec&#123; <span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">-1</span>,<span class="number">-9</span>,<span class="number">0</span>,<span class="number">-999</span> &#125;;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Vector of integers contains: &quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	for_each(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), <span class="built_in">Display</span>&lt;<span class="type">int</span>&gt;());</span><br><span class="line"></span><br><span class="line">	list&lt;<span class="type">char</span>&gt; charsInList&#123; <span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;d&#x27;</span> &#125;;</span><br><span class="line">	cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;List of characters contains: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	for_each(charsInList.<span class="built_in">begin</span>(), charsInList.<span class="built_in">end</span>(), <span class="built_in">Display</span>&lt;<span class="type">char</span>&gt;());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单21.2  存储状态的函数对象</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Display</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> count;</span><br><span class="line">	<span class="built_in">Display</span>() : count&#123; <span class="number">0</span> &#125; &#123;&#125;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">operator</span><span class="params">()</span> <span class="params">(<span class="type">const</span> T&amp; element)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		++count;</span><br><span class="line">		cout &lt;&lt; element &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; numsInVec&#123; <span class="number">22</span>,<span class="number">2017</span>,<span class="number">-1</span>,<span class="number">999</span>,<span class="number">43</span>,<span class="number">901</span>&#125;;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Vector of integers contains: &quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	Display&lt;<span class="type">int</span>&gt; result;</span><br><span class="line">	result = for_each(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), <span class="built_in">Display</span>&lt;<span class="type">int</span>&gt;());</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;Functor invoked &quot;</span> &lt;&lt; result.count &lt;&lt; <span class="string">&quot;times&quot;</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>21.2.2   一元谓词</strong></p>
<p>​	<strong>返回布尔值的一元函数是谓词</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单21.3  一个一元谓词，它判断一个数字是否为另一个数字的整数倍</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">IsMultiple</span></span><br><span class="line">&#123;</span><br><span class="line">	T Divisor;</span><br><span class="line">	<span class="built_in">IsMultiple</span>(<span class="type">const</span> T&amp; divisor)</span><br><span class="line">	&#123;</span><br><span class="line">		Divisor = divisor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; element)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (elemen % Divisor == <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单21.4  在std::find_if( )中使用一元谓词IsMutilple，在 vector 中查找一个能被用户提供的除数整除的元素 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">IsMultiple</span></span><br><span class="line">&#123;</span><br><span class="line">	T Divisor;</span><br><span class="line">	<span class="built_in">IsMultiple</span>(<span class="type">const</span> T&amp; divisor)</span><br><span class="line">	&#123;</span><br><span class="line">		Divisor = divisor;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; element)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (element % Divisor == <span class="number">0</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; numsInVec&#123; <span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span> &#125;;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter divisor (&gt;0): &quot;</span>;</span><br><span class="line">	<span class="type">int</span> divisor = <span class="number">2</span>;</span><br><span class="line">	cin &gt;&gt; divisor;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> element = <span class="built_in">find_if</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), <span class="built_in">IsMultiple</span>&lt;<span class="type">int</span>&gt;(divisor));</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (element != numsInVec.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;First element in vector divisible by &quot;</span> &lt;&lt; divisor &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; *element &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>21.2.3   二元函数</strong></p>
<p>​	<strong>如果函数 f(x, y)根据输入参数返回一个值，它将很有用。这种二元函数可用于对两个操作数执行 运算</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单21.5  使用二元函数将两个范围相乘</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Multiply</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">const</span> T&amp; <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; elem1, <span class="type">const</span> T&amp; elem2)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (elem1 * elem2);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; multiplicands&#123; <span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; multipliers&#123; <span class="number">100</span>,<span class="number">101</span>,<span class="number">102</span>,<span class="number">103</span>,<span class="number">104</span> &#125;;</span><br><span class="line"></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; vecResult;</span><br><span class="line"></span><br><span class="line">	vecResult.<span class="built_in">resize</span>(multiplicands.<span class="built_in">size</span>());</span><br><span class="line"></span><br><span class="line">	<span class="built_in">transform</span>(multiplicands.<span class="built_in">begin</span>(), multiplicands.<span class="built_in">end</span>(),</span><br><span class="line">			 multipliers.<span class="built_in">begin</span>(),</span><br><span class="line">			 vecResult.<span class="built_in">begin</span>(),</span><br><span class="line">			 <span class="built_in">Multiply</span>&lt;<span class="type">int</span>&gt;());</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of the first vector are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; multiplicands.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; multiplicands[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of the second vector are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; multipliers.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; multipliers[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The result of the multiplication is: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; vecResult.<span class="built_in">size</span>(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; vecResult[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>21.2.4   二元谓词</strong></p>
<p>​	<strong>接受两个参数并返回一个布尔值的函数是二元谓词。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单21.6  对字符串进行不区分大小写排序的二元谓词 </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CompareStringNoCase</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> string&amp; str1, <span class="type">const</span> string&amp; str2)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		string str1LowerCase&#123;str1&#125;;</span><br><span class="line">		string str2LowerCase&#123; str2 &#125;;</span><br><span class="line">		<span class="built_in">transform</span>(str<span class="number">1.</span><span class="built_in">begin</span>(), str<span class="number">1.</span><span class="built_in">end</span>(),str1LowerCase.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line">		<span class="built_in">transform</span>(str<span class="number">2.</span><span class="built_in">begin</span>(), str<span class="number">2.</span><span class="built_in">end</span>(), str2LowerCase.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> (str1LowerCase &lt; str2LowerCase);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单21.7  使用函数对象CompareStringNoCase对字符串vector进行不区分大小写的排序</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CompareStringNoCase</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> string&amp; str1, <span class="type">const</span> string&amp; str2)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		string str1LowerCase&#123;str1&#125;;</span><br><span class="line">		string str2LowerCase&#123; str2 &#125;;</span><br><span class="line">		<span class="built_in">transform</span>(str<span class="number">1.</span><span class="built_in">begin</span>(), str<span class="number">1.</span><span class="built_in">end</span>(),str1LowerCase.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line">		<span class="built_in">transform</span>(str<span class="number">2.</span><span class="built_in">begin</span>(), str<span class="number">2.</span><span class="built_in">end</span>(), str2LowerCase.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> (str1LowerCase &lt; str2LowerCase);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; container)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> iter = container.<span class="built_in">begin</span>(); iter != container.<span class="built_in">end</span>(); iter++)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; *iter &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;string&gt; names;</span><br><span class="line"></span><br><span class="line">	names.<span class="built_in">push_back</span>(<span class="string">&quot;jim&quot;</span>);</span><br><span class="line">	names.<span class="built_in">push_back</span>(<span class="string">&quot;jack&quot;</span>);</span><br><span class="line">	names.<span class="built_in">push_back</span>(<span class="string">&quot;Sam&quot;</span>);</span><br><span class="line">	names.<span class="built_in">push_back</span>(<span class="string">&quot;Anna&quot;</span>);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The names in vector in order of insertion: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(names);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Names after sorting using default std::less&lt;&gt;: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">sort</span>(names.<span class="built_in">begin</span>(), names.<span class="built_in">end</span>());</span><br><span class="line">	<span class="built_in">Display</span>(names);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Sorting using predicate that ignores case:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">sort</span>(names.<span class="built_in">begin</span>(), names.<span class="built_in">end</span>(), <span class="built_in">CompareStringNoCase</span>());</span><br><span class="line">	<span class="built_in">Display</span>(names);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="21-5-作业"><a href="#21-5-作业" class="headerlink" title="21.5   作业"></a>21.5   作业</h2><p><strong>21.5.1   测验</strong></p>
<ol>
<li><p><strong>返回布尔值的一元函数称为什么？</strong>  </p>
<p><strong>答</strong>：一元谓词</p>
</li>
<li><p><strong>不修改数据也不返回布尔值的函数对象有什么用？请通过示例阐述您的观点。</strong>  </p>
<p><strong>答</strong>：可以用来显示数据和计算</p>
</li>
<li><p><strong>函数对象这一术语的定义是什么？</strong></p>
<p><strong>答</strong>：在应用程序运行阶段的所有实体都是对象，因此结构体和类也可用作函数，这称为函数对象。函数对象也可通过函数指针来调用，它们也是函数对象</p>
</li>
</ol>
<p><strong>21.5.2   练习</strong></p>
<ol>
<li><p><strong>编写一个一元函数，它可供std::for_each()用来显示输入参数的两倍。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Display</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; elem)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		cout &lt;&lt; (elem * <span class="number">2</span>) &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>进一步扩展上述谓词，使其能够记录它被调用的次数。</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Display</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> count;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">Display</span>() : count&#123;<span class="number">0</span>&#125;&#123;&#125;</span><br><span class="line">    </span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; elem)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">        count++;</span><br><span class="line">		cout &lt;&lt; (elem * <span class="number">2</span>) &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写一个用于降序排序的二元谓词。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Ascending</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> T&amp; key1, <span class="type">const</span> T&amp; key2)</span> <span class="type">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> (ke1 &lt; key2);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第二十二章"><a href="#第二十二章" class="headerlink" title="第二十二章"></a>第二十二章</h1><h2 id="22-1-lambda-表达式是什么"><a href="#22-1-lambda-表达式是什么" class="headerlink" title="22.1  lambda 表达式是什么"></a>22.1  lambda 表达式是什么</h2><p>​	<strong>可将lambda表达式视为包含公有operator( )的匿名结构（或类），从这种意义上说，lambda表达式 属于函数对象</strong></p>
<h2 id="22-2-如何定义lambda表达式"><a href="#22-2-如何定义lambda表达式" class="headerlink" title="22.2   如何定义lambda表达式"></a>22.2   如何定义lambda表达式</h2><p>​	<strong>lambda 表达式的定义必须以方括号（[]）打头。这些括号告诉编译器，接下来是一个lambda表达 式。方括号的后面是一个参数列表，该参数列表与不使用lambda表达式时提供给operator( )的参数列 表相同</strong></p>
<h2 id="22-3-一元函数对应的lambda表达式"><a href="#22-3-一元函数对应的lambda表达式" class="headerlink" title="22.3   一元函数对应的lambda表达式"></a>22.3   一元函数对应的lambda表达式</h2><ul>
<li><p>与一元operator(Type)对应的 lambda 表达式接受一个参数，其定义如下</p>
<p><code>[](Type paramName) &#123;  // lambda expression code here; &#125; </code></p>
</li>
<li><p>如果您愿意，也可按引用传递参数</p>
<p><code>[](Type&amp; paramName) &#123;  // lambda expression code here; &#125;</code></p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单22.1  在算法for_each( )中使用lambda表达式而不是函数对象来显示容器中的元素 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; numsInVec&#123; <span class="number">104</span>,<span class="number">-4</span>,<span class="number">500</span>,<span class="number">21</span>,<span class="number">42</span>,<span class="number">-1</span> &#125;;</span><br><span class="line"></span><br><span class="line">	list&lt;<span class="type">char</span>&gt; charsInList&#123; <span class="string">&#x27;a&#x27;</span>,<span class="string">&#x27;h&#x27;</span>,<span class="string">&#x27;z&#x27;</span>,<span class="string">&#x27;k&#x27;</span>,<span class="string">&#x27;l&#x27;</span> &#125;;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Display elements in a vector using a lambda: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	for_each(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), [](<span class="keyword">auto</span>&amp; elem) &#123;cout &lt;&lt; elem &lt;&lt; <span class="string">&#x27; &#x27;</span>; &#125;);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;Display elements in a list using a lambda: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	for_each(charsInList.<span class="built_in">begin</span>(), charsInList.<span class="built_in">end</span>(), [](<span class="keyword">auto</span>&amp; elem) &#123;cout &lt;&lt; elem &lt;&lt; <span class="string">&#x27; &#x27;</span>; &#125;);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="22-4-一元谓词对应的lambda表达式"><a href="#22-4-一元谓词对应的lambda表达式" class="headerlink" title="22.4   一元谓词对应的lambda表达式"></a>22.4   一元谓词对应的lambda表达式</h2><p>​	<strong>谓词可帮助您做出决策。一元谓词是返回bool类型（true或false）的一元表达式。lambda表达式也可返回值，例如，下面的lambda表达式在num为偶数时返回true</strong></p>
<p><code>[](int&amp; num) &#123;return ((num % 2) == 0); &#125;</code></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单22.2  在算法std::find_if( )中，将 lambda 表达式用作一元谓词，以查找集合中的偶数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; numsInVec&#123; <span class="number">25</span>,<span class="number">101</span>,<span class="number">2017</span>,<span class="number">-50</span> &#125;;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> evenNum = <span class="built_in">find_if</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), [](<span class="keyword">auto</span>&amp; elem) &#123;<span class="keyword">return</span> !(elem % <span class="number">2</span>); &#125;);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (evenNum != numsInVec.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Even number in collection is:&quot;</span> &lt;&lt; *evenNum &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="22-5-通过捕获列表接受状态变量的lambda表达式"><a href="#22-5-通过捕获列表接受状态变量的lambda表达式" class="headerlink" title="22.5   通过捕获列表接受状态变量的lambda表达式"></a>22.5   通过捕获列表接受状态变量的lambda表达式</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单22.3  使用存储状态的lambda表达式来判断一个数字能否被另一个数字整除</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; numsInVec&#123; <span class="number">25</span>,<span class="number">26</span>,<span class="number">27</span>,<span class="number">28</span>,<span class="number">29</span>,<span class="number">30</span>,<span class="number">31</span> &#125;;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The vector contains: &quot;</span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;Enter divisor (&gt; 0): &quot;</span>;</span><br><span class="line">	<span class="type">int</span> divisor = <span class="number">2</span>;</span><br><span class="line">	cin &gt;&gt; divisor;</span><br><span class="line"></span><br><span class="line">	vector&lt;<span class="type">int</span>&gt;::iterator elem;</span><br><span class="line">	elem = <span class="built_in">find_if</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), [divisor](<span class="keyword">auto</span>&amp; element) &#123;<span class="keyword">return</span> !(element % divisor); &#125;);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> (elem != numsInVec.<span class="built_in">end</span>())</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;First element in vector idvisible by &quot;</span> &lt;&lt; divisor &lt;&lt; <span class="string">&quot;: &quot;</span> &lt;&lt; *elem &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="22-6-lambda-表达式的通用语法"><a href="#22-6-lambda-表达式的通用语法" class="headerlink" title="22.6  lambda 表达式的通用语法"></a>22.6  lambda 表达式的通用语法</h2><ul>
<li><p>lambda 表达式总是以方括号打头，并可接受多个状态变量，为此可在捕获列表（[…]）中指定这 些状态变量，并用逗号分隔</p>
<p><code>[stateVar1, stateVar2](Type&amp; param) &#123; // lambda code here; &#125;</code></p>
</li>
<li><p>如果要在lambda表达式中修改这些状态变量，可添加关键字multable</p>
<p><code>[stateVar1, stateVar2](Type&amp; param) mutable &#123; // lambda code here; &#125;</code></p>
</li>
<li><p>这样，便可在lambda表达式中修改捕获列表（[]）中指定的变量，但离开lambda表达式后，这些 修改将无效。要确保在lambda表达式内部对状态变量的修改在其外部也有效，应按引用传递它们</p>
<p><code>[&amp;stateVar1, &amp;stateVar2](Type&amp; param) &#123; // lambda code here; &#125; </code></p>
</li>
<li><p>如果要向编译器明确地指定返回类型，可使用-&gt;</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[stateVar1, stateVar2](Type1 var1, Type2 var2) -&gt; ReturnType </span><br><span class="line">&#123; <span class="keyword">return</span> (value <span class="keyword">or</span> expression ); &#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="22-7-二元函数对应的lambda表达式"><a href="#22-7-二元函数对应的lambda表达式" class="headerlink" title="22.7   二元函数对应的lambda表达式"></a>22.7   二元函数对应的lambda表达式</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单22.4  将lambda 表达式用作二元函数，以便将两个容器中的元素相乘，并将结果存储到第三个容器中</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; vecMultiplicand&#123; <span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span> &#125;;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; vecMultiplier&#123; <span class="number">100</span>,<span class="number">101</span>,<span class="number">102</span>,<span class="number">103</span>,<span class="number">104</span> &#125;;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; result;</span><br><span class="line"></span><br><span class="line">	result.<span class="built_in">resize</span>(vecMultiplicand.<span class="built_in">size</span>());</span><br><span class="line"></span><br><span class="line">	<span class="built_in">transform</span>(vecMultiplicand.<span class="built_in">begin</span>(), vecMultiplicand.<span class="built_in">end</span>(),</span><br><span class="line">		vecMultiplier.<span class="built_in">begin</span>(),</span><br><span class="line">		result.<span class="built_in">begin</span>(),</span><br><span class="line">		[](<span class="type">int</span> a, <span class="type">int</span> b) &#123;<span class="keyword">return</span> a * b; &#125;);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of the first vector are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; vecMultiplicand.<span class="built_in">size</span>(); i++) cout &lt;&lt; vecMultiplicand[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of the second vector are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; vecMultiplier.<span class="built_in">size</span>(); i++) cout &lt;&lt; vecMultiplier[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The result of the multiplication is: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; result.<span class="built_in">size</span>(); i++) cout &lt;&lt; result[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="22-8-二元谓词对应的lambda表达式"><a href="#22-8-二元谓词对应的lambda表达式" class="headerlink" title="22.8   二元谓词对应的lambda表达式"></a>22.8   二元谓词对应的lambda表达式</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单22.5  在std::sort( )中，将 lambda 表达式用作二元谓词，以便进行区分大小写的排序</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> elem : input)</span><br><span class="line">	&#123;</span><br><span class="line">		cout &lt;&lt; elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;string&gt; namesInVec&#123; <span class="string">&quot;jim&quot;</span>,<span class="string">&quot;Jack&quot;</span>,<span class="string">&quot;Sam&quot;</span>,<span class="string">&quot;Anna&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The names in vector in order of insertion: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(namesInVec);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Order after case sensitive sort: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">sort</span>(namesInVec.<span class="built_in">begin</span>(), namesInVec.<span class="built_in">end</span>());</span><br><span class="line">	<span class="built_in">Display</span>(namesInVec);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Order after sort ignoring case: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">sort</span>(namesInVec.<span class="built_in">begin</span>(), namesInVec.<span class="built_in">end</span>(),</span><br><span class="line">		[](<span class="type">const</span> string&amp; str1, <span class="type">const</span> string&amp; str2) &#123;</span><br><span class="line">			string str1LC;</span><br><span class="line">			string str2LC;</span><br><span class="line"></span><br><span class="line">			str1LC.<span class="built_in">resize</span>(str<span class="number">1.</span><span class="built_in">size</span>());</span><br><span class="line">			str2LC.<span class="built_in">resize</span>(str<span class="number">2.</span><span class="built_in">size</span>());</span><br><span class="line"></span><br><span class="line">			<span class="built_in">transform</span>(str<span class="number">1.</span><span class="built_in">begin</span>(), str<span class="number">1.</span><span class="built_in">end</span>(), str1LC.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line">			<span class="built_in">transform</span>(str<span class="number">2.</span><span class="built_in">begin</span>(), str<span class="number">2.</span><span class="built_in">end</span>(), str2LC.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line"></span><br><span class="line">			<span class="built_in">return</span> (str1LC &lt; str2LC);</span><br><span class="line">		&#125;);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">Display</span>(namesInVec);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="22-11-作业"><a href="#22-11-作业" class="headerlink" title="22.11  作业"></a>22.11  作业</h2><p><strong>22.11.1   测验</strong></p>
<ol>
<li><p><strong>编译器如何确定lambda表达式的起始位置？</strong></p>
<p><strong>答</strong>：总是以[]开头</p>
</li>
<li><p><strong>如何将状态变量传递给lambda表达式？</strong></p>
<p><strong>答</strong>：使用[]捕获列表</p>
</li>
<li><p><strong>如何指定lambda表达式的返回类型？</strong></p>
<p><strong>答</strong>：<code>[var1,var2,...](Type&amp; param)-&gt;ReturnType&#123;...;&#125;</code></p>
</li>
</ol>
<p><strong>22.11.2   练习</strong></p>
<ol>
<li><p><strong>编写一个可用作二元谓词的lambda表达式，帮助将元素按降序排列。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[](<span class="keyword">auto</span>&amp; key1, <span class="keyword">auto</span>&amp; key2)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> key1 &gt; key2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
<li><p><strong>编写一个这样的lambda表达式，即用于for_each()时，给vector等容器中的元素加上用户指定 的值。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">for_each(vec.<span class="built_in">begin</span>(),vec.<span class="built_in">end</span>(),[value](<span class="keyword">auto</span>&amp; val)&#123;<span class="built_in">return</span> (value + val);&#125;);</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第二十三章"><a href="#第二十三章" class="headerlink" title="第二十三章"></a>第二十三章</h1><h2 id="23-2-STL算法的分类"><a href="#23-2-STL算法的分类" class="headerlink" title="23.2  STL算法的分类"></a>23.2  STL算法的分类</h2><p><strong>23.2.1  非变序算法</strong></p>
<p>​	<strong>不改变容器中元素的顺序和内容的算法称为非变序算法</strong></p>
<p><img src="https://www.helloimg.com/i/2025/01/01/67751f54895d1.png"></p>
<p><strong>23.2.2  变序算法</strong></p>
<p>​	<strong>变序算法改变其操作的序列的元素顺序或内容</strong></p>
<p><img src="https://www.helloimg.com/i/2025/01/01/67751f57738f4.jpg"></p>
<h2 id="23-3-使用STL算法"><a href="#23-3-使用STL算法" class="headerlink" title="23.3   使用STL算法"></a>23.3   使用STL算法</h2><p><strong>23.3.1   根据值或条件查找元素</strong></p>
<p>​	STL 算法find( )和 find_if( )用于在 vector 等容器中查找与值匹配或满足条件的元素。find_if( )需要通过第三个参数提供一个一元谓词（返回true或false的一元 函数）.这两个函数都返回一个迭代器</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.1  使用find( )在vector中查找一个整数，并使用find_if以及一个用lambda表达式表示的一元谓词查找第一个偶数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; numsInVec&#123; <span class="number">2017</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">42</span>,<span class="number">10101</span>,<span class="number">25</span> &#125;;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter number to find in collection: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> numToFind = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; numToFind;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> elem = <span class="built_in">find</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), numToFind);</span><br><span class="line">	<span class="keyword">if</span> (elem != numsInVec.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Value &quot;</span> &lt;&lt; *elem &lt;&lt; <span class="string">&quot; found!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;No element contains value &quot;</span> &lt;&lt; numToFind &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">auto</span> evenNum = <span class="built_in">find_if</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), [](<span class="keyword">auto</span>&amp; val) &#123;<span class="keyword">return</span> !(val % <span class="number">2</span>); &#125;);</span><br><span class="line">	<span class="keyword">if</span> (evenNum != numsInVec.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Number &quot;</span> &lt;&lt; *evenNum &lt;&lt; <span class="string">&quot; Found at position [&quot;</span>;</span><br><span class="line">		cout &lt;&lt; <span class="built_in">distance</span>(numsInVec.<span class="built_in">begin</span>(), evenNum) &lt;&lt; <span class="string">&quot;]&quot;</span> &lt;&lt; endl;;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>23.3.2   计算包含给定值或满足给定条件的元素数</strong></p>
<p>​	算法std::count( )和 count_if( )计算给定范围内的元素数。std:: count( )计算包含给定值（使用相等运 算符&#x3D;&#x3D;进行测试）的元素数。std::count_if( )计算这样的元素数，即满足通过参数传递的一元谓词（可以是函数对象，也可以是 lambda 表达式）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.2  使用std::count( )和count_if( )分别计算有多少个元素包含指定值和满足指定条件</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isEven</span><span class="params">(<span class="type">const</span> T&amp; val)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> !(val % <span class="number">2</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; numsInVec&#123; <span class="number">2017</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">42</span>,<span class="number">10101</span>,<span class="number">25</span> &#125;;</span><br><span class="line">	</span><br><span class="line">	<span class="type">size_t</span> numZeros = <span class="built_in">count</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Number of instance of &#x27;0&#x27;: &quot;</span> &lt;&lt; numZeros &lt;&lt; endl &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="type">size_t</span> numEvenNums = <span class="built_in">count_if</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), isEven&lt;<span class="type">int</span>&gt;);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Number of even elements: &quot;</span> &lt;&lt; numEvenNums &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Number of odd elements:&quot;</span> &lt;&lt; numsInVec.<span class="built_in">size</span>() - numEvenNums &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>23.3.3   在集合中搜索元素或序列</strong></p>
<p>​	应使 用search( )或 search_n( )。search( )用于在一个序列中查找另一个序列。search_n( )用于在容器中查找n个相邻的指定值。这两个函数都返回一个迭代器</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.3  使用search和search_n在集合中查找序列</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; elem : input) &#123;</span><br><span class="line">		cout &lt;&lt; elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">int</span>&gt; numsInVec&#123; <span class="number">2017</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">42</span>,<span class="number">10101</span>,<span class="number">25</span>,<span class="number">9</span>,<span class="number">9</span>,<span class="number">9</span> &#125;;</span><br><span class="line">	list&lt;<span class="type">int</span>&gt; numsInList&#123; <span class="number">-1</span>,<span class="number">42</span>,<span class="number">10101</span> &#125;;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of the sample vector are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(numsInVec);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of the sample list are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="built_in">Display</span>(numsInList);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;search() for the contents of list in vector:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">auto</span> range = <span class="built_in">search</span>(numsInVec.<span class="built_in">cbegin</span>(), numsInVec.<span class="built_in">cend</span>(),</span><br><span class="line">						numsInList.<span class="built_in">begin</span>(),numsInList.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (range != numsInVec.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Sequence in list found in vector at position: &quot;</span>;</span><br><span class="line">		cout &lt;&lt; <span class="built_in">distance</span>(numsInVec.<span class="built_in">cbegin</span>(), range) &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Searching&#123;9,9,9&#125; in vector using search_n(): &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">auto</span> partialRange = <span class="built_in">search_n</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), <span class="number">3</span>, <span class="number">9</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (partialRange != numsInVec.<span class="built_in">end</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Sequence&#123;9,9,9&#125; found in vector at position: &quot;</span>;</span><br><span class="line">		cout &lt;&lt; <span class="built_in">distance</span>(numsInVec.<span class="built_in">begin</span>(), partialRange) &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>23.3.4   将容器中的元素初始化为指定值</strong></p>
<ul>
<li><p>fill( )将指定范围内的元素设置为 指定值</p>
<p><code>fill (numsInVec.begin (), numsInVec.end (), 9); </code></p>
</li>
<li><p>fill_n( )将 n 个元素设置为指定的值，接受的参数包括起始位置、元素数以及要设置 的值</p>
<p><code>fill_n (numsInVec.begin () + 3, /*count*/ 3, /*fill value*/ -9);</code></p>
</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.4  使用fill( )和 fill_n( )设置容器中元素的初始值</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">numsInVec</span><span class="params">(<span class="number">3</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">fill</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), <span class="number">9</span>);</span><br><span class="line"></span><br><span class="line">	numsInVec.<span class="built_in">resize</span>(<span class="number">6</span>);</span><br><span class="line">	<span class="built_in">fill_n</span>(numsInVec.<span class="built_in">begin</span>() + <span class="number">3</span>, <span class="number">3</span>, <span class="number">-9</span>);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Contents of the vector are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; numsInVec.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Element [&quot;</span> &lt;&lt; i &lt;&lt; <span class="string">&quot;] = &quot;</span> &lt;&lt; numsInVec[i] &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>23.3.5   使用std::generate( )将元素设置为运行阶段生成的值</strong></p>
<ul>
<li><p>可使用generate( )将指定范围内的元素设置为生成器函数返回的值</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">generate</span> (numsInVec.<span class="built_in">begin</span> (), numsInVec.<span class="built_in">end</span> (),   <span class="comment">// range </span></span><br><span class="line">          rand); <span class="comment">// generator function </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>generate_n( )与 generate( )类似，但您指定的是要设置的元素数，而不是闭区间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">generate_n (numsInList.begin (), 5, rand);</span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.5  使用generate( )和generate_n( )将集合设置为随机值</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;ctime&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span>&amp; elem : input) &#123;</span><br><span class="line">		cout &lt;&lt; elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">srand</span>(<span class="built_in">time</span>(<span class="literal">NULL</span>));</span><br><span class="line"></span><br><span class="line">	<span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">numsInVec</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line">	<span class="built_in">generate</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), rand);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Elements in the vector are: &quot;</span>;</span><br><span class="line">	<span class="built_in">Display</span>(numsInVec);</span><br><span class="line"></span><br><span class="line">	<span class="function">list&lt;<span class="type">int</span>&gt; <span class="title">numsInList</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line">	<span class="built_in">generate_n</span>(numsInList.<span class="built_in">begin</span>(), <span class="number">5</span>, rand);</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Elements int the list are: &quot;</span>;</span><br><span class="line">	<span class="built_in">Display</span>(numsInList);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>23.3.6   使用for_each( )处理指定范围内的元素</strong></p>
<p>​	算法for_each( )对指定范围内的每个元素执行指定的一元函数对象</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.6  使用for_each( )显示集合的内容</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> elementType&gt;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">DisplayElementKeepcount</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> count;</span><br><span class="line">    <span class="built_in">DisplayElementKeepcount</span>() : <span class="built_in">count</span>(<span class="number">0</span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> elementType&amp; element)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ++count;</span><br><span class="line">        cout &lt;&lt; element &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; numsInVec&#123; <span class="number">2017</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">42</span>, <span class="number">10101</span>, <span class="number">25</span> &#125;;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Elements in vector are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">    DisplayElementKeepcount&lt;<span class="type">int</span>&gt; functor =</span><br><span class="line">        for_each(numsInVec.<span class="built_in">cbegin</span>(),   <span class="comment">// Start of range</span></span><br><span class="line">            numsInVec.<span class="built_in">cend</span>(),     <span class="comment">// End of range</span></span><br><span class="line">            <span class="built_in">DisplayElementKeepcount</span>&lt;<span class="type">int</span>&gt;()); <span class="comment">// Functor</span></span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Use the state stored in the return value of for_each!</span></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; functor.count &lt;&lt; <span class="string">&quot;&#x27; elements displayed&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;for_each and strings!&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Sample string: &quot;</span> &lt;&lt; str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Characters displayed using lambda:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="type">int</span> numChars = <span class="number">0</span>;</span><br><span class="line">    for_each(str.<span class="built_in">cbegin</span>(),</span><br><span class="line">        str.<span class="built_in">cend</span>(),</span><br><span class="line">        [&amp;numChars](<span class="type">char</span> c) &#123; cout &lt;&lt; c &lt;&lt; <span class="string">&#x27; &#x27;</span>; ++numChars; &#125;);</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;&#x27;&quot;</span> &lt;&lt; numChars &lt;&lt; <span class="string">&quot;&#x27; characters displayed&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>23.3.7   使用std::transform( )对范围进行变换</strong></p>
<ul>
<li>第一个版本一个接受一元函数，常用于将字符串转换为大写或小写（使用 的一元函数分别是toupper( )和tolower( )</li>
<li>第二个版本接受一个二元函数，让transform( )能够处理一对来自两个不同范围的元素</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.7  使用一元函数和二元函数的std::transform( ) </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;deque&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;THIS ais a TEst string!&quot;</span>)</span></span>;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;The sample string is: &quot;</span> &lt;&lt; str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    string strLowerCaseCopy;</span><br><span class="line">    strLowerCaseCopy.<span class="built_in">resize</span>(str.<span class="built_in">size</span>());</span><br><span class="line"></span><br><span class="line">    <span class="built_in">transform</span>(str.<span class="built_in">cbegin</span>(), str.<span class="built_in">cend</span>(), strLowerCaseCopy.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Result of transform on the string with tolower: &quot;</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; strLowerCaseCopy &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; numsInVec1&#123; <span class="number">2017</span>, <span class="number">0</span>, <span class="number">-1</span>, <span class="number">42</span>, <span class="number">10101</span>, <span class="number">25</span> &#125;;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">numsInVec2</span><span class="params">(numsInVec<span class="number">1.</span>size(), <span class="number">-1</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function">deque&lt;<span class="type">int</span>&gt; <span class="title">sumInDeque</span><span class="params">(numsInVec<span class="number">1.</span>size())</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">transform</span>(numsInVec<span class="number">1.</span><span class="built_in">begin</span>(), numsInVec<span class="number">1.</span><span class="built_in">end</span>(), numsInVec<span class="number">2.</span><span class="built_in">begin</span>(), sumInDeque.<span class="built_in">begin</span>(), <span class="built_in">plus</span>&lt;<span class="type">int</span>&gt;());</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Result of transform using binary function plus: &quot;</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Index Vector1 + Vector2 = Result(in Deque)&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; numsInVec<span class="number">1.</span><span class="built_in">size</span>(); i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; i &lt;&lt; <span class="string">&quot; \t &quot;</span> &lt;&lt; numsInVec1[i] &lt;&lt; <span class="string">&quot;\t+&quot;</span>;</span><br><span class="line">        cout &lt;&lt; numsInVec2[i] &lt;&lt; <span class="string">&quot; \t= &quot;</span>;</span><br><span class="line">        cout &lt;&lt; sumInDeque[i] &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>23.3.8   复制和删除操作</strong></p>
<ul>
<li><p>copy 沿向前的方向将源范围的内容赋给目标范围</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> lastElement = <span class="built_in">copy</span> (numsInList.<span class="built_in">cbegin</span>(), <span class="comment">// start source range </span></span><br><span class="line">                         numsInList.<span class="built_in">cend</span>(),   <span class="comment">// end source range </span></span><br><span class="line">                         numsInVec.<span class="built_in">begin</span>());  <span class="comment">// start dest range </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>copy_if( )是 C++11 新增的，仅在指定的一元谓词返回true时才复制元素</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">copy_if</span> (numsInList.<span class="built_in">cbegin</span>(), numsInList.<span class="built_in">cend</span>(), </span><br><span class="line">         lastElement, <span class="comment">// copy position in dest range </span></span><br><span class="line">         [](<span class="type">int</span> element)&#123;<span class="built_in">return</span> ((element % <span class="number">2</span>) == <span class="number">1</span>);&#125;);</span><br></pre></td></tr></table></figure>
</li>
<li><p>copy_backward( )沿向后的方向将源范围的内容赋给目标范围</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">copy_backward</span> (numsInList.<span class="built_in">cbegin</span> (), </span><br><span class="line">               numsInList.<span class="built_in">cend</span> (), </span><br><span class="line">               numsInVec.<span class="built_in">end</span> ());</span><br></pre></td></tr></table></figure>
</li>
<li><p>remove( )将容器中与指定值匹配的元素删除</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">auto</span> newEnd = <span class="built_in">remove</span> (numsInVec.<span class="built_in">begin</span> (), numsInVec.<span class="built_in">end</span> (), <span class="number">0</span>); </span><br><span class="line">numsInVec.<span class="built_in">erase</span> (newEnd, numsInVec.<span class="built_in">end</span> ());</span><br></pre></td></tr></table></figure>
</li>
<li><p>remove_if( )使用一个一元谓词，并将容器中满足该谓词的元素删除</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">newEnd = <span class="built_in">remove_if</span> (numsInVec.<span class="built_in">begin</span> (), numsInVec.<span class="built_in">end</span> (), </span><br><span class="line">         [](<span class="type">int</span> num) &#123;<span class="built_in">return</span> ((num % <span class="number">2</span>) == <span class="number">1</span>);&#125; ); <span class="comment">//predicate </span></span><br><span class="line">numsInVec.<span class="built_in">erase</span> (newEnd, numsInVec.<span class="built_in">end</span> ()); <span class="comment">// resizing</span></span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.8  一个演示copy( )、copy_if( )、copy_backward( )、remove( )和 remove_if( )的示例，它将list的内容复制到vector中，并删除包含零或偶数的元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; elem : input) &#123;</span><br><span class="line">        cout &lt;&lt; elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;| Number of elements :&quot;</span> &lt;&lt; input.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    list&lt;<span class="type">int</span>&gt; numsInList&#123; <span class="number">2017</span>,<span class="number">0</span>,<span class="number">-1</span>,<span class="number">42</span>,<span class="number">10101</span>,<span class="number">25</span> &#125;;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Source(list) contains: &quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">Display</span>(numsInList);</span><br><span class="line"></span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">numsInVec</span><span class="params">(numsInList.size() * <span class="number">2</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> lastElement = <span class="built_in">copy</span>(numsInList.<span class="built_in">begin</span>(), numsInList.<span class="built_in">end</span>(),numsInVec.<span class="built_in">begin</span>());</span><br><span class="line">    <span class="built_in">copy_if</span>(numsInList.<span class="built_in">begin</span>(), numsInList.<span class="built_in">end</span>(), lastElement, [](<span class="keyword">auto</span>&amp; elem) &#123;<span class="built_in">return</span> (elem % <span class="number">2</span>); &#125;);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Destination(vector) after copy and copy_if:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">Display</span>(numsInVec);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> newEnd = <span class="built_in">remove</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), <span class="number">0</span>);</span><br><span class="line">    numsInVec.<span class="built_in">erase</span>(newEnd, numsInVec.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    newEnd = <span class="built_in">remove_if</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), [](<span class="keyword">auto</span>&amp; elem) &#123;<span class="built_in">return</span> (elem % <span class="number">2</span>); &#125;);</span><br><span class="line">    numsInVec.<span class="built_in">erase</span>(newEnd, numsInVec.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Destination(vector) after remove, remove_if,erase:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">Display</span>(numsInVec);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>23.3.9   替换值以及替换满足给定条件的元素</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.9  使用replace( )和replace_if( )在指定范围内替换值</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; elem : input) &#123;</span><br><span class="line">        cout &lt;&lt; elem &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;| Number of elements :&quot;</span> &lt;&lt; input.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">numsInVec</span><span class="params">(<span class="number">6</span>)</span></span>;</span><br><span class="line">    <span class="built_in">fill</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">begin</span>() + <span class="number">3</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="built_in">fill_n</span>(numsInVec.<span class="built_in">begin</span>() + <span class="number">3</span>, <span class="number">3</span>, <span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">random_shuffle</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;The initial contents of vector: &quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">Display</span>(numsInVec);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;std::replace value 5 by 8&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">replace</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), <span class="number">5</span>, <span class="number">8</span>);</span><br><span class="line">    <span class="built_in">replace_if</span>(numsInVec.<span class="built_in">begin</span>(), numsInVec.<span class="built_in">end</span>(), [](<span class="type">int</span>&amp; elem) &#123;<span class="keyword">return</span> !(elem % <span class="number">2</span>); &#125;,<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;Vector after replacements: &quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">Display</span>(numsInVec);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>23.3.10  排序、在有序集合中搜索以及删除重复元素</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.10  使用sort( )、binary_search( )和 unique( )</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; elem : input) &#123;</span><br><span class="line">        cout &lt;&lt; elem &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;| Number of elements :&quot;</span> &lt;&lt; input.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;string&gt; vecNames&#123; <span class="string">&quot;John&quot;</span>, <span class="string">&quot;jack&quot;</span>,<span class="string">&quot;sean&quot;</span>, <span class="string">&quot;Anna&quot;</span> &#125;;</span><br><span class="line">    vecNames.<span class="built_in">push_back</span>(<span class="string">&quot;jack&quot;</span>);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;The initial contents of the vector are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">Display</span>(vecNames);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;The sorted vector contains names in the order:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">sort</span>(vecNames.<span class="built_in">begin</span>(), vecNames.<span class="built_in">end</span>());</span><br><span class="line">    <span class="built_in">Display</span>(vecNames);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Searching for John using binary_search:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="type">bool</span> element = <span class="built_in">binary_search</span>(vecNames.<span class="built_in">begin</span>(), vecNames.<span class="built_in">end</span>(), <span class="string">&quot;John&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (element) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Result:John was found in the vector!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Element not found&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> newEnd = <span class="built_in">unique</span>(vecNames.<span class="built_in">begin</span>(), vecNames.<span class="built_in">end</span>());</span><br><span class="line">    vecNames.<span class="built_in">erase</span>(newEnd, vecNames.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;The contents of the vector after using unique:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">Display</span>(vecNames);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>23.3.11  将范围分区</strong></p>
<p>​	<strong>std::partition( )将输入范围分为两部分：一部分满足一元谓词；另一部分不满足。然而，std::partition( )不保证每个分区中元素的相对顺序不变。在相对顺序很重要，需要保持不变 时，应使用std::stable_partition( )</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.11  使用partition( )和stable_partition( )将整型范围分为偶数值和奇数值 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; elem : input) &#123;</span><br><span class="line">        cout &lt;&lt; elem &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;| Number of elements :&quot;</span> &lt;&lt; input.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vector&lt;string&gt; vecNames&#123; <span class="string">&quot;John&quot;</span>, <span class="string">&quot;jack&quot;</span>,<span class="string">&quot;sean&quot;</span>, <span class="string">&quot;Anna&quot;</span> &#125;;</span><br><span class="line">    vecNames.<span class="built_in">push_back</span>(<span class="string">&quot;jack&quot;</span>);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;The initial contents of the vector are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">Display</span>(vecNames);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;The sorted vector contains names in the order:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">sort</span>(vecNames.<span class="built_in">begin</span>(), vecNames.<span class="built_in">end</span>());</span><br><span class="line">    <span class="built_in">Display</span>(vecNames);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Searching for John using binary_search:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="type">bool</span> element = <span class="built_in">binary_search</span>(vecNames.<span class="built_in">begin</span>(), vecNames.<span class="built_in">end</span>(), <span class="string">&quot;John&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (element) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Result:John was found in the vector!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Element not found&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">auto</span> newEnd = <span class="built_in">unique</span>(vecNames.<span class="built_in">begin</span>(), vecNames.<span class="built_in">end</span>());</span><br><span class="line">    vecNames.<span class="built_in">erase</span>(newEnd, vecNames.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;The contents of the vector after using unique:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="built_in">Display</span>(vecNames);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>23.3.12  在有序集合中插入元素</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单23.12  使用lower_bound( )和 upper_bound( )在有序范围中插入元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Display</span><span class="params">(<span class="type">const</span> T&amp; input)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span>&amp; elem : input) &#123;</span><br><span class="line">        cout &lt;&lt; elem &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;| Number of elements :&quot;</span> &lt;&lt; input.<span class="built_in">size</span>() &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    list&lt;string&gt; names&#123; <span class="string">&quot;John&quot;</span>,<span class="string">&quot;Brad&quot;</span>,<span class="string">&quot;jack&quot;</span>,<span class="string">&quot;sean&quot;</span>,<span class="string">&quot;Anna&quot;</span> &#125;;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Sorted contents of the list are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">    names.<span class="built_in">sort</span>();</span><br><span class="line">    <span class="built_in">Display</span>(names);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Teh Lowest index where Brad can be inserted is: &quot;</span>;</span><br><span class="line">    <span class="keyword">auto</span> minPos = <span class="built_in">lower_bound</span>(names.<span class="built_in">begin</span>(), names.<span class="built_in">end</span>(), <span class="string">&quot;Brad&quot;</span>);</span><br><span class="line">    cout &lt;&lt; <span class="built_in">distance</span>(names.<span class="built_in">begin</span>(), minPos);</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Teh highest index where Brad can be inserted is: &quot;</span>;</span><br><span class="line">    <span class="keyword">auto</span> maxPos = <span class="built_in">upper_bound</span>(names.<span class="built_in">begin</span>(), names.<span class="built_in">end</span>(), <span class="string">&quot;Brad&quot;</span>);</span><br><span class="line">    cout &lt;&lt; <span class="built_in">distance</span>(names.<span class="built_in">begin</span>(), maxPos);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;List after inserting Brad in sorted order: &quot;</span> &lt;&lt; endl;</span><br><span class="line">    names.<span class="built_in">insert</span>(minPos, <span class="string">&quot;Brad&quot;</span>);</span><br><span class="line">    <span class="built_in">Display</span>(names);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="23-6-作业"><a href="#23-6-作业" class="headerlink" title="23.6   作业"></a>23.6   作业</h2><p><strong>23.6.1   测验</strong></p>
<ol>
<li><p><strong>要将list 中满足特定条件的元素删除，应使用std::remove_if( )还是list::remove_if( )？</strong></p>
<p><strong>答</strong>：list::remove_if()</p>
</li>
<li><p><strong>假设有一个包含ContactItem对象的list，在没有显式指定二元谓词时，函数list::sort( )将如何 对这些元素进行排序？</strong></p>
<p><strong>答</strong>：将调用less&lt;&gt;进行排序</p>
</li>
<li><p><strong>STL算法generate( )将调用函数generator( )多少次？</strong></p>
<p><strong>答</strong>：对每个元素调用一次</p>
</li>
<li><p><strong>std::transform( )与 std::for_each( )之间的区别何在？</strong></p>
<p><strong>答</strong>：for_each只能接受一元谓词，transform接受一元和二元谓词</p>
</li>
</ol>
<p><strong>23.6.2   练习</strong></p>
<ol>
<li><p><strong>编写一个二元谓词，它接受字符串作为输入参数，并根据不区分大小写的比较结果返回一个值。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">struct</span> <span class="title class_">Compare</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="type">const</span> string&amp; str1, <span class="type">const</span> string&amp; str2)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        string str1L;</span><br><span class="line">        string str2L;</span><br><span class="line"></span><br><span class="line">        str1L.<span class="built_in">resize</span>(str<span class="number">1.</span><span class="built_in">size</span>());</span><br><span class="line">        str2L.<span class="built_in">resize</span>(str<span class="number">2.</span><span class="built_in">size</span>());</span><br><span class="line"></span><br><span class="line">        <span class="built_in">transform</span>(str<span class="number">1.</span><span class="built_in">begin</span>(), str<span class="number">1.</span><span class="built_in">end</span>(), str1L.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line">        <span class="built_in">transform</span>(str<span class="number">2.</span><span class="built_in">begin</span>(), str<span class="number">2.</span><span class="built_in">end</span>(), str2L.<span class="built_in">begin</span>(), ::tolower);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> str1L &lt; str2L;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>演示 STL算法（如copy()）如何使用迭代器实现其功能—复制两个类型不同的容器存储的序 列，而无需知道目标集合的特征。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">list&lt;string&gt; names&#123; <span class="string">&quot;John&quot;</span>,<span class="string">&quot;Brad&quot;</span>,<span class="string">&quot;jack&quot;</span>,<span class="string">&quot;sean&quot;</span>,<span class="string">&quot;Anna&quot;</span> &#125;;</span><br><span class="line"><span class="function">vector&lt;string&gt; <span class="title">strs</span><span class="params">(names.size())</span></span>;</span><br><span class="line"><span class="built_in">copy</span>(names.<span class="built_in">begin</span>(), names.<span class="built_in">end</span>(), strs.<span class="built_in">begin</span>());</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>您正在编写一个应用程序，它按星星在地平线上升起的顺序记录它们的特点。在天文学中，星 球的大小很重要，其升起和落下的相对顺序亦如此。如果要根据星星的大小对这个集合进行排 序，应使用std::sort( )还是 std::stable_sort( )？</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">std::<span class="built_in">stable_sort</span>();</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第二十四章"><a href="#第二十四章" class="headerlink" title="第二十四章"></a>第二十四章</h1><h2 id="24-1-栈和队列的行为特征"><a href="#24-1-栈和队列的行为特征" class="headerlink" title="24.1  栈和队列的行为特征"></a>24.1  栈和队列的行为特征</h2><p>**24.1.1  栈 **</p>
<p>​	<strong>栈是LIFO（后进先出）系统，只能从栈顶插入或删除元素。</strong></p>
<p>**24.1.2   队列 **</p>
<p>​	<strong>队列是FIFO（先进先出）系统，元素被插入到队尾，最先插入的元素最先删除。</strong></p>
<h2 id="24-2-使用STL-stack-类"><a href="#24-2-使用STL-stack-类" class="headerlink" title="24.2   使用STL stack 类"></a>24.2   使用STL stack 类</h2><p><strong>24.2.1   实例化stack</strong></p>
<p>​	<strong>std::stack的定义如下</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt; </span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">elementType</span>, </span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">Container</span>=deque&lt;Type&gt; </span><br><span class="line">&gt; <span class="keyword">class</span> stack; </span><br></pre></td></tr></table></figure>

<p>参数elementType 是 stack 存储的对象类型。第二个模板参数Container是stack使用的默认底层容 器实现类。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单24.1  实例化STL stack</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; numsInStack;</span><br><span class="line">    stack&lt;<span class="type">double</span>&gt; dblsInStack;</span><br><span class="line">    stack&lt;<span class="type">double</span>, vector&lt;<span class="type">double</span>&gt;&gt; doublesStackedInVec;</span><br><span class="line">    <span class="function">stack&lt;<span class="type">int</span>&gt; <span class="title">numsInStackCopy</span><span class="params">(numsInStack)</span></span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>**24.2.3   使用push( )和 pop( )在栈顶插入和删除元素 **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单24.2  使用整型stack</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    stack&lt;<span class="type">int</span>&gt; numsInStack;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Pushing&#123;25,10,-1,5&#125; on stack in that order:&quot;</span> &lt;&lt; endl;</span><br><span class="line">    numsInStack.<span class="built_in">push</span>(<span class="number">25</span>);</span><br><span class="line">    numsInStack.<span class="built_in">push</span>(<span class="number">10</span>);</span><br><span class="line">    numsInStack.<span class="built_in">push</span>(<span class="number">-1</span>);</span><br><span class="line">    numsInStack.<span class="built_in">push</span>(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Stack contains &quot;</span> &lt;&lt; numsInStack.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; elements&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">while</span> (numsInStack.<span class="built_in">size</span>() != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Popping topmost element: &quot;</span> &lt;&lt; numsInStack.<span class="built_in">top</span>() &lt;&lt; endl;</span><br><span class="line">        numsInStack.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (numsInStack.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Popping all elements empties stack!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="24-3-使用STL-queue类"><a href="#24-3-使用STL-queue类" class="headerlink" title="24.3   使用STL queue类"></a>24.3   使用STL queue类</h2><p>**24.3.1   实例化queue **</p>
<p>​	<strong>std::queue 的定义如下</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt; </span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">elementType</span>, </span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">Container</span> = deque&lt;Type&gt; </span><br><span class="line">&gt; <span class="keyword">class</span> queue; </span><br></pre></td></tr></table></figure>

<p>其中elementType 是 queue 对象包含的元素的类型。Container是std::queue用于存储其数据的集合 类型</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单24.3  实例化STL queue</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;list&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; numsInQ;</span><br><span class="line">    queue&lt;<span class="type">double</span>&gt; dblsInQ;</span><br><span class="line">    queue&lt;<span class="type">double</span>, list&lt;<span class="type">double</span>&gt;&gt; dbsInQInList;</span><br><span class="line">    <span class="function">queue&lt;<span class="type">int</span>&gt; <span class="title">copyQ</span><span class="params">(numsInQ)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>24.3.3   使用push( )在队尾插入以及使用pop( )从队首删除</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单24.4  在整型queue中插入、删除和查看元素</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; numsInQ;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Inserting&#123;10,5,-1,20&#125; into queue&quot;</span> &lt;&lt; endl;</span><br><span class="line">    numsInQ.<span class="built_in">push</span>(<span class="number">10</span>);</span><br><span class="line">    numsInQ.<span class="built_in">push</span>(<span class="number">5</span>);</span><br><span class="line">    numsInQ.<span class="built_in">push</span>(<span class="number">-1</span>);</span><br><span class="line">    numsInQ.<span class="built_in">push</span>(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Queue contains &quot;</span> &lt;&lt; numsInQ.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; elements&quot;</span> &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Element at front: &quot;</span> &lt;&lt; numsInQ.<span class="built_in">front</span>() &lt;&lt; endl;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Element at back: &quot;</span> &lt;&lt; numsInQ.<span class="built_in">back</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (numsInQ.<span class="built_in">size</span>() != <span class="number">0</span>) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Deleting element: &quot;</span> &lt;&lt; numsInQ.<span class="built_in">front</span>() &lt;&lt; endl;</span><br><span class="line">        numsInQ.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (numsInQ.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;The queue is now empty!&quot;</span> &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="24-4-使用STL优先级队列"><a href="#24-4-使用STL优先级队列" class="headerlink" title="24.4   使用STL优先级队列"></a>24.4   使用STL优先级队列</h2><p>​	priority_queue与queue 的不同之处在于，包含最大值（或二元谓词认为是最大值）的元素位于队首，且只能在队首执行操作。</p>
<p><strong>24.4.1   实例化priority_queue 类</strong></p>
<p>​	<strong>std::priority_queue 类的定义如下</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt; </span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">elementType</span>, </span><br><span class="line">   <span class="keyword">class</span> <span class="title class_">Container</span>=vector&lt;Type&gt;, </span><br><span class="line">      <span class="keyword">class</span> Compare=less&lt;<span class="keyword">typename</span> Container::value_type&gt; </span><br><span class="line">&gt; </span><br><span class="line"><span class="keyword">class</span> priority_queue</span><br></pre></td></tr></table></figure>

<p>elementType 是一个模板参数，指定了优先级队列将包含的元素的类型。第二个模板参数指定 priority_queue 在内部将使用哪个集合类来存储数据，第三个参数让程序员能够指定一个二元谓词，以 帮助队列判断哪个元素应位于队首。如果没有指定二元谓词，priority_queue类将默认使用std::less，它 使用运算符&lt;比较对象。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单24.5  实例化STL priority_queue</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    priority_queue&lt;<span class="type">int</span>&gt; numsInPrioQ;</span><br><span class="line">    priority_queue&lt;<span class="type">double</span>&gt; dblsInPrioQ;</span><br><span class="line">    priority_queue&lt;<span class="type">int</span>,deque&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt;&gt; numsInDescendingQ;</span><br><span class="line">    <span class="function">priority_queue&lt;<span class="type">int</span>&gt; <span class="title">copyQ</span><span class="params">(numsInPrioQ)</span></span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>24.4.3   使用push( )在 priority_queue 末尾插入以及使用 pop( )在 priority_queue 开头删除</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单24.6  使用priority_queue 的成员函数push( )、top( )和 pop( )</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    priority_queue&lt;<span class="type">int</span>&gt; numsInPrioQ;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Inserting&#123;10,5,-1,20&#125; into the priority_queue&quot;</span> &lt;&lt; endl;</span><br><span class="line">    numsInPrioQ.<span class="built_in">push</span>(<span class="number">10</span>);</span><br><span class="line">    numsInPrioQ.<span class="built_in">push</span>(<span class="number">5</span>);</span><br><span class="line">    numsInPrioQ.<span class="built_in">push</span>(<span class="number">-1</span>);</span><br><span class="line">    numsInPrioQ.<span class="built_in">push</span>(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Deleting the &quot;</span> &lt;&lt; numsInPrioQ.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; elements&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">while</span> (!numsInPrioQ.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Deleting topmost element: &quot;</span> &lt;&lt; numsInPrioQ.<span class="built_in">top</span>() &lt;&lt; endl;</span><br><span class="line">        numsInPrioQ.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单24.7  通过使用谓词将值最小的元素放在priority_queue开头</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    priority_queue&lt;<span class="type">int</span>,vector&lt;<span class="type">int</span>&gt;, greater&lt;<span class="type">int</span>&gt;&gt; numsInPrioQ;</span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Inserting&#123;10,5,-1,20&#125; into the priority_queue&quot;</span> &lt;&lt; endl;</span><br><span class="line">    numsInPrioQ.<span class="built_in">push</span>(<span class="number">10</span>);</span><br><span class="line">    numsInPrioQ.<span class="built_in">push</span>(<span class="number">5</span>);</span><br><span class="line">    numsInPrioQ.<span class="built_in">push</span>(<span class="number">-1</span>);</span><br><span class="line">    numsInPrioQ.<span class="built_in">push</span>(<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; <span class="string">&quot;Deleting the &quot;</span> &lt;&lt; numsInPrioQ.<span class="built_in">size</span>() &lt;&lt; <span class="string">&quot; elements&quot;</span> &lt;&lt; endl;</span><br><span class="line">    <span class="keyword">while</span> (!numsInPrioQ.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;Deleting topmost element: &quot;</span> &lt;&lt; numsInPrioQ.<span class="built_in">top</span>() &lt;&lt; endl;</span><br><span class="line">        numsInPrioQ.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="24-7-作业"><a href="#24-7-作业" class="headerlink" title="24.7   作业"></a>24.7   作业</h2><p><strong>24.7.1   测验</strong></p>
<ol>
<li><p>**能否修改priority_queue 的行为，使得值最大的元素最后弹出?  **</p>
<p><strong>答</strong>：可以</p>
</li>
<li><p><strong>假设有一个包含Coin对象的priority_queue，要让priority_queue 将币值最大的硬币放在队首， 需要为Coin定义哪种成员运算符？</strong></p>
<p><strong>答</strong>：运算符&lt;</p>
</li>
<li><p><strong>假设有一个包含6个Coin对象的stack，能否访问或删除第一个插入的Coin对象？</strong></p>
<p><strong>答</strong>：不能</p>
</li>
</ol>
<p><strong>24.7.2   练习</strong></p>
<ol>
<li><p><strong>邮局有一个包含人（Person类）的队列。Person包含两个成员属性，分别用于存储年龄和性别， 其定义如下,请改进这个类，使得包含其对象的priority_queue优先向老人和妇女提供服务。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span> </span><br><span class="line">&#123; </span><br><span class="line"><span class="keyword">public</span>: </span><br><span class="line">	<span class="type">int</span> age; </span><br><span class="line">    <span class="type">bool</span> isFemale; </span><br><span class="line">&#125;; </span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">int</span> age;</span><br><span class="line">    <span class="type">bool</span> isFemale;</span><br><span class="line">    <span class="type">bool</span> <span class="keyword">operator</span>&lt;(<span class="type">const</span> Person&amp; psn)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (age &gt; psn.age) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(isFemale &amp;&amp; psn.isFemale)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>编写一个程序，使用stack类反转用户输入的字符串的排列顺序</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stack&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">string <span class="title">str</span><span class="params">(<span class="string">&quot;hello world&quot;</span>)</span></span>;</span><br><span class="line">    stack&lt;<span class="type">char</span>&gt; charInS;</span><br><span class="line"></span><br><span class="line">    cout &lt;&lt; str &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> ch : str) &#123;</span><br><span class="line">        charInS.<span class="built_in">push</span>(ch);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (!charInS.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">        cout &lt;&lt; charInS.<span class="built_in">top</span>();</span><br><span class="line">        charInS.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h1 id="第二十五章"><a href="#第二十五章" class="headerlink" title="第二十五章"></a>第二十五章</h1><h2 id="25-1-bitset类"><a href="#25-1-bitset类" class="headerlink" title="25.1  bitset类"></a>25.1  bitset类</h2><p>​	<strong>std::bitset是一个STL类，用于处理以位和位标志表示的信息</strong></p>
<p><strong>实例化std::bitset</strong></p>
<ul>
<li><p>实例化这个模板类时，必须通过一个模板参数指定实例需要管理的位数</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bitset &lt;4&gt; fourBits; <span class="comment">// 4 bits initialized to 0000 </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>还可将bitset初始化为一个用字符串字面量（char*）表示的位序列</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bitset &lt;5&gt; <span class="built_in">fiveBits</span>(<span class="string">&quot;10101&quot;</span>); <span class="comment">// 5 bits 10101 </span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用一个bitset来实例化另一个bitset非常简单</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bitset &lt;8&gt; <span class="built_in">fiveBitsCopy</span>(fiveBits); </span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单25.1  实例化std::bitset</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	bitset&lt;4&gt; fourBits;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Initial contents of fourBits: &quot;</span> &lt;&lt; fourBits &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="function">bitset&lt;5&gt; <span class="title">fiveBits</span><span class="params">(<span class="string">&quot;10101&quot;</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Initial contents of fiveBits: &quot;</span> &lt;&lt; fiveBits &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="function">bitset&lt;6&gt; <span class="title">sixBits</span><span class="params">(<span class="number">0b100001</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Initial contents of sixBits: &quot;</span> &lt;&lt; sixBits &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="function">bitset&lt;8&gt; <span class="title">eightBits</span><span class="params">(<span class="number">255</span>)</span></span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Initial contents of eightBits: &quot;</span> &lt;&lt; eightBits &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="function">bitset&lt;8&gt; <span class="title">eightBitsCopy</span><span class="params">(eightBits)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="25-2-使用std-bitset-及其成员"><a href="#25-2-使用std-bitset-及其成员" class="headerlink" title="25.2   使用std::bitset 及其成员"></a>25.2   使用std::bitset 及其成员</h2><p><strong>25.2.1  std:bitset 的运算符</strong></p>
<p><img src="https://www.helloimg.com/i/2025/01/02/677638a7b3925.png"></p>
<p><strong>25.2.2  std::bitset 的成员方法</strong></p>
<p><img src="https://www.helloimg.com/i/2025/01/02/677638a6c2051.png"></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单25.2  使用bitset执行逻辑运算</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	bitset&lt;8&gt; inputBits;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter a 8-bit sequence: &quot;</span>;</span><br><span class="line">	cin &gt;&gt; inputBits;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Num 1s you supplied: &quot;</span> &lt;&lt; inputBits.<span class="built_in">count</span>() &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Num 0s you supplied: &quot;</span> &lt;&lt; inputBits.<span class="built_in">size</span>() - inputBits.<span class="built_in">count</span>() &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="function">bitset&lt;8&gt; <span class="title">inputFlipped</span><span class="params">(inputBits)</span></span>;</span><br><span class="line">	inputFlipped.<span class="built_in">flip</span>();</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Flipped version is: &quot;</span> &lt;&lt; inputFlipped &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Result of AND, OR and XOR between the two:&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; inputBits &lt;&lt; <span class="string">&quot; &amp; &quot;</span> &lt;&lt; inputFlipped &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; (inputBits &amp; inputFlipped) &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; inputBits &lt;&lt; <span class="string">&quot; | &quot;</span> &lt;&lt; inputFlipped &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; (inputBits | inputFlipped) &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; inputBits &lt;&lt; <span class="string">&quot; ^ &quot;</span> &lt;&lt; inputFlipped &lt;&lt; <span class="string">&quot; = &quot;</span> &lt;&lt; (inputBits ^ inputFlipped) &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="25-3-vector"><a href="#25-3-vector" class="headerlink" title="25.3  vector&lt;bool&gt;"></a>25.3  <strong><code>vector&lt;bool&gt;</code></strong></h2><p>**25.3.1   实例化vector **</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单25.3  实例化vector&lt;bool&gt;</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	vector&lt;<span class="type">bool</span>&gt; boolFlags1;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">boolFlags2</span><span class="params">(<span class="number">10</span>,<span class="literal">true</span>)</span></span>;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">boolFlags2Copy</span><span class="params">(boolFlags2)</span></span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>25.3.2  vector的成员函数和运算符</strong></p>
<p>​	<strong>vector提供了函数 flip( )，用于将序列中的布尔值取反，这与函数bitset&lt;&gt;::flip( )很像</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单25.4  使用vector&lt;bool&gt;</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">vector&lt;<span class="type">bool</span>&gt; <span class="title">boolFlags</span><span class="params">(<span class="number">3</span>)</span></span>;</span><br><span class="line">	boolFlags[<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">	boolFlags[<span class="number">1</span>] = <span class="literal">true</span>;</span><br><span class="line">	boolFlags[<span class="number">2</span>] = !<span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">	boolFlags.<span class="built_in">push_back</span>(<span class="literal">true</span>);</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of the vector are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; boolFlags.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">		cout &lt;&lt; boolFlags[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl;</span><br><span class="line">	boolFlags.<span class="built_in">flip</span>();</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The contents of the vector are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; boolFlags.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">		cout &lt;&lt; boolFlags[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="25-6-作业"><a href="#25-6-作业" class="headerlink" title="25.6   作业"></a>25.6   作业</h2><p><strong>25.6.1   测验</strong></p>
<ol>
<li><p><strong>bitset 能否扩展其内部缓冲区以存储可变的元素数？</strong></p>
<p><strong>答</strong>:不能</p>
</li>
<li><p><strong>为什么bitset 不属于STL容器类？</strong></p>
<p><strong>答</strong>:不能动态调整长度，不支持迭代器</p>
</li>
<li><p><strong>您会使用std::vector 来存储位数在编译阶段就知道的固定位数吗？</strong></p>
<p><strong>答</strong>:不会</p>
</li>
</ol>
<p><strong>25.6.2   练习</strong></p>
<ol>
<li><p><strong>创建一个长4位的bitset对象，并使用一个数字来初始化它，然后显示结果并将其与另一个bitset 对象相加（注意：bitsets不支持语法bitsetA &#x3D; bitsetX + bitsetY）。</strong>  </p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">bitset&lt;4&gt; <span class="title">bit1</span><span class="params">(<span class="number">3</span>)</span></span>;</span><br><span class="line">	<span class="function">bitset&lt;4&gt; <span class="title">bit2</span><span class="params">(<span class="number">4</span>)</span></span>;</span><br><span class="line">	<span class="function">bitset&lt;4&gt; <span class="title">bit3</span><span class="params">(bit<span class="number">1.</span>to_ullong() + bit<span class="number">2.</span>to_ullong())</span></span>;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;bit1 = &quot;</span> &lt;&lt; bit1 &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;bit2 = &quot;</span> &lt;&lt; bit2 &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;bit3 = &quot;</span> &lt;&lt; bit3 &lt;&lt; endl;<span class="number">18214341174</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>请演示如何将bitset对象中的位取反。</strong></p>
<p><code>bit.flip();</code></p>
</li>
</ol>
<h1 id="第二十六章"><a href="#第二十六章" class="headerlink" title="第二十六章"></a>第二十六章</h1><h2 id="26-1-什么是智能指针"><a href="#26-1-什么是智能指针" class="headerlink" title="26.1   什么是智能指针"></a>26.1   什么是智能指针</h2><p>​	<strong>智能指针是包含重载运算符的类，其行为像常规指针，但智能指针能够及时、妥 善地销毁动态分配的数据，并实现了明确的对象生命周期，因此更有价值。</strong></p>
<h2 id="26-2-智能指针是如何实现的"><a href="#26-2-智能指针是如何实现的" class="headerlink" title="26.2   智能指针是如何实现的"></a>26.2   智能指针是如何实现的</h2><p>​	<strong>这个问题暂时可以简化为：“智能指针 spData 是如何做到像常规指针那样的？”答案如下：智能 指针类重载了解除引用运算符（*）和成员选择运算符（-&gt;），让程序员可以像使用常规指针那样使用 它们。</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单26.1  智能指针类最基本的组成部分</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SmartPointer</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">SmartPointer</span>(T* pData) : rawPtr&#123; pData &#125; &#123;&#125;</span><br><span class="line">	~<span class="built_in">SmartPointer</span>() &#123; <span class="keyword">delete</span> pDada; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">SmartPointer</span>(<span class="type">const</span> SmartPointer&amp; anotherSP);</span><br><span class="line">	SmartPointer&amp; <span class="keyword">operator</span>=(<span class="type">const</span> SmartPointer&amp; anotherSP);</span><br><span class="line"></span><br><span class="line">	T&amp; <span class="keyword">operator</span>*() <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> *(rawPtr);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	T* <span class="keyword">operator</span>-&gt;() <span class="type">const</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">return</span> rawPtr;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	T* rawPtr;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="26-3-智能指针类型"><a href="#26-3-智能指针类型" class="headerlink" title="26.3   智能指针类型"></a>26.3   智能指针类型</h2><p>​	<strong>内存资源管理（即实现的内存所有权模型）是智能指针类与众不同的地方。智能指针决定在复制 和赋值时如何处理内存资源。智能指针的分类实际上就是内存资源管理策略的分类，可分为如下几类</strong></p>
<ul>
<li>深复制</li>
<li>写时复制</li>
<li>引用计数</li>
<li>引用链接</li>
<li>破坏性复制</li>
</ul>
<p><strong>26.3.1   深复制</strong></p>
<p>​	<strong>在实现深复制的智能指针中，每个智能指针实例都保存一个它管理的对象的完整副本。每当智能 指针被复制时，将复制它指向的对象（因此称为深复制）</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单26.2  使用基于深复制的智能指针将多态对象作为基类对象进行传递</span></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DeepcopySmartPtr</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">DeepcopySmartPtr</span>(<span class="type">const</span> DeepcopySmartPtr&amp; source)</span><br><span class="line">	&#123;</span><br><span class="line">		object = source-&gt;<span class="built_in">Clone</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	DeepcopySmartPtr&amp; <span class="keyword">operator</span>=(<span class="type">const</span> DeepcopySmartPtr&amp; source)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (object) <span class="keyword">delete</span> object;</span><br><span class="line"></span><br><span class="line">		object = source-&gt;<span class="built_in">Clone</span>();</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	T* object;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>26.3.2   写时复制机制</strong></p>
<p>​	<strong>写时复制机制（Copy on Write，COW）试图对深复制智能指针的性能进行优化，它共享指针，直 到首次写入对象。首次调用非const函数时，COW指针通常为该非const函数操作的对象创建一个副 本，而其他指针实例仍共享源对象</strong></p>
<p><strong>26.3.3   引用计数智能指针</strong></p>
<p>​	<strong>引用计数是一种记录对象的用户数量的机制。当计数降低到零后，便将对象释放。因此，引用计 数提供了一种优良的机制，使得可共享对象而无法对其进行复制。这种智能指针被复制时，需要将对象的引用计数加1。至少有两种常用的方法来跟踪计数</strong></p>
<ul>
<li>在对象中维护引用计数</li>
<li>引用计数由共享对象中的指针类维护</li>
</ul>
<p><strong>26.3.4   引用链接智能指针</strong></p>
<p>​	<strong>引用链接智能指针不主动维护对象的引用计数，而只需知道计数什么时候变为零，以便能够释放 对象</strong></p>
<p><strong>26.3.5   破坏性复制</strong></p>
<p>​	<strong>破坏性复制是这样一种机制，即在智能指针被复制时，将对象的所有权转交给目标指针并重置原 来的指针</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单26.3  一个破坏性复制智能指针</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bitset&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> T&gt;</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DestructivecopyPtr</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">DestructivecopyPtr</span>(T* input) : <span class="built_in">object</span>(input) &#123;&#125;</span><br><span class="line">	~<span class="built_in">DestructivecopyPtr</span>() &#123; <span class="keyword">delete</span> object; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">DestructivecopyPtr</span>(DestructivecopyPtr&amp; source)</span><br><span class="line">	&#123;</span><br><span class="line">		object = source.object;</span><br><span class="line">		source.object = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	DestructivecopyPtr&amp; <span class="keyword">operator</span>=(DestructivecopyPtr&amp; source)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (object != source.object) &#123;</span><br><span class="line">			<span class="keyword">if</span> (object) <span class="keyword">delete</span> object;</span><br><span class="line">			object = source.object;</span><br><span class="line">			source.object = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	T* object;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">DestructivecopyPtr&lt;<span class="type">int</span>&gt; <span class="title">num</span><span class="params">(<span class="keyword">new</span> <span class="type">int</span>)</span></span>;</span><br><span class="line">	DestructivecopyPtr&lt;<span class="type">int</span>&gt; copy = num;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>26.3.6   使用std::unique_ptr</strong></p>
<p>​	<strong>unique_ptr 是一种简单的智能指针，其复制构造函数和 赋值运算符被声明为私有的，因此不能复制它，即不能将其按值传递给函数，也不能将其赋给其他指 针</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单26.4  使用std::unique_ptr</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Fish</span>() &#123; cout &lt;&lt; <span class="string">&quot;Fish: Constructed!&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">	~<span class="built_in">Fish</span>() &#123; cout &lt;&lt; <span class="string">&quot;Fish: Destructed!&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span> <span class="type">const</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;Fish swims in water&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MakeFishSwim</span><span class="params">(<span class="type">const</span> unique_ptr&lt;Fish&gt;&amp; inFish)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	inFish-&gt;<span class="built_in">Swim</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">unique_ptr&lt;Fish&gt; <span class="title">smartFish</span><span class="params">(<span class="keyword">new</span> Fish)</span></span>;</span><br><span class="line">	smartFish-&gt;<span class="built_in">Swim</span>();</span><br><span class="line">	<span class="built_in">MakeFishSwim</span>(smartFish);</span><br><span class="line"></span><br><span class="line">	unique_ptr&lt;Fish&gt; copy;</span><br><span class="line">	<span class="comment">//copy = smartFish; //error: operator= is private</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="26-7-作业"><a href="#26-7-作业" class="headerlink" title="26.7   作业"></a>26.7   作业</h1><p><strong>26.7.1   测试</strong></p>
<ol>
<li><p><strong>为应用程序编写自己的智能指针前应查看什么地方？</strong></p>
<p><strong>答</strong>：<a target="_blank" rel="noopener" href="http://www.boost.org/">www.boost.org</a></p>
</li>
<li><p><strong>智能指针是否会严重降低应用程序的性能？</strong></p>
<p><strong>答</strong>：不会</p>
</li>
<li><p><strong>引用计数智能指针在什么地方存储引用计数？</strong></p>
<p><strong>答</strong>：</p>
<ul>
<li>在对象中维护引用计数</li>
<li>引用计数由共享对象中的指针类维护</li>
</ul>
</li>
<li><p><strong>引用链接指针使用的链表机制是单向链表还是双向链表？</strong></p>
<p><strong>答</strong>：双向链表</p>
</li>
</ol>
<p><strong>26.7.2   练习</strong></p>
<ol>
<li><p><strong>查错：指出下述代码中的错误</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::auto_ptr&lt;SampleClass&gt; <span class="title">object</span> <span class="params">(<span class="keyword">new</span> SampleClass ())</span></span>; </span><br><span class="line"><span class="function">std::auto_ptr&lt;SampleClass&gt; <span class="title">anotherObject</span> <span class="params">(object)</span></span>; </span><br><span class="line">object-&gt;<span class="built_in">DoSomething</span> (); </span><br><span class="line">anotherObject-&gt;<span class="built_in">DoSomething</span>();</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：auto_ptr会在复制时使其失去所有权，object-&gt;DoSomething (); 无效</p>
</li>
<li><p><strong>使用 unique_ptr 类实例化一个Carp对象，而Carp类继承了Fish类。将该对象作为Fish指针传 递时是否会出现切除问题</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;memory&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Fish</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Fish</span>() &#123; cout &lt;&lt; <span class="string">&quot;Fish: Constructed!&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">	~<span class="built_in">Fish</span>() &#123; cout &lt;&lt; <span class="string">&quot;Fish: Destructed!&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Swim</span><span class="params">()</span> <span class="type">const</span> </span>&#123; cout &lt;&lt; <span class="string">&quot;Fish swims in water&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Carp</span> : <span class="keyword">public</span> Fish</span><br><span class="line">&#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">MakeFishSwim</span><span class="params">(<span class="type">const</span> unique_ptr&lt;Fish&gt;&amp; inFish)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	inFish-&gt;<span class="built_in">Swim</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">unique_ptr&lt;Fish&gt; <span class="title">smartFish</span><span class="params">(<span class="keyword">new</span> Carp)</span></span>;</span><br><span class="line">	smartFish-&gt;<span class="built_in">Swim</span>();</span><br><span class="line">	<span class="built_in">MakeFishSwim</span>(smartFish);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：使用引用传递，不是值传递，不会切除问题</p>
</li>
<li><p><strong>查错：指出下述代码中的错误</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::unique_ptr&lt;Tuna&gt; <span class="title">myTuna</span> <span class="params">(<span class="keyword">new</span> Tuna)</span></span>; </span><br><span class="line">unique_ptr&lt;Tuna&gt; copyTuna; </span><br><span class="line">copyTuna = myTuna; </span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：unique_ptr不允许复制</p>
</li>
</ol>
<h1 id="第二十七章"><a href="#第二十七章" class="headerlink" title="第二十七章"></a>第二十七章</h1><h2 id="27-2-重要的C-流类和流对象"><a href="#27-2-重要的C-流类和流对象" class="headerlink" title="27.2  重要的C++流类和流对象"></a>27.2  重要的C++流类和流对象</h2><p><img src="https://www.helloimg.com/i/2025/01/02/677680403d02e.png"></p>
<h2 id="27-3-使用std-cout-将指定格式的数据写入控制台"><a href="#27-3-使用std-cout-将指定格式的数据写入控制台" class="headerlink" title="27.3   使用std::cout 将指定格式的数据写入控制台"></a>27.3   使用std::cout 将指定格式的数据写入控制台</h2><p><strong>27.3.1   使用std::cout 修改数字的显示格式</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单27.1  使用cout和&lt;iomanip&gt;控制符以十进制、十六进制和八进制格式显示整数</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter an integer: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> input = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; input;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Integer in octal: &quot;</span> &lt;&lt; oct &lt;&lt; input &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Integer in hexadecimal: &quot;</span> &lt;&lt; hex &lt;&lt; input &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Integer in hex using base notations: &quot;</span>;</span><br><span class="line">	cout &lt;&lt; <span class="built_in">setiosflags</span>(ios_base::hex | ios_base::showbase | ios_base::uppercase);</span><br><span class="line">	cout &lt;&lt; input &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Integer after resetting I/O flags: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="built_in">resetiosflags</span>(ios_base::hex | ios_base::showbase | ios_base::uppercase);</span><br><span class="line">	cout &lt;&lt; input &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单27.2  使用cout以定点表示法和科学表示法显示Pi和圆面积</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">const</span> <span class="type">double</span> Pi = (<span class="type">double</span>)<span class="number">22.0</span> / <span class="number">7</span>;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Pi = &quot;</span> &lt;&lt; Pi &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;Setting precision to: 7&quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">7</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Pi = &quot;</span> &lt;&lt; Pi &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; fixed &lt;&lt; <span class="string">&quot;Fixed Pi = &quot;</span> &lt;&lt; Pi &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; scientific &lt;&lt; <span class="string">&quot;Scientific Pi = &quot;</span> &lt;&lt; Pi &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;Setting precision to 10: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="built_in">setprecision</span>(<span class="number">10</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Pi = &quot;</span> &lt;&lt; Pi &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; fixed &lt;&lt; <span class="string">&quot;Fixed Pi = &quot;</span> &lt;&lt; Pi &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; scientific &lt;&lt; <span class="string">&quot;Scientific Pi = &quot;</span> &lt;&lt; Pi &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; endl &lt;&lt; <span class="string">&quot;Enter a radius: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> radius = <span class="number">0.0</span>;</span><br><span class="line">	cin &gt;&gt; radius;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Area of circle: &quot;</span> &lt;&lt; <span class="number">2</span> * Pi * radius &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>27.3.2   使用std::cout 对齐文本和设置字段宽度</strong></p>
<p>​	<strong>可使用setw( )控制符来设置字段宽度，插入到流中的内容将在指定宽度内右对齐。在这种情况下， 还可使用setfill( )指定使用什么字符来填充空白区域</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单27.3  使用控制符setw( )设置字段宽度，并使用setfill( )指定填充字符</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Hey - default!&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="built_in">setw</span>(<span class="number">35</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Hey - right aligned!&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="built_in">setw</span>(<span class="number">35</span>) &lt;&lt; <span class="built_in">setfill</span>(<span class="string">&#x27;*&#x27;</span>) &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Hey - right aligned!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Hey - back to default!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="27-4-使用std-cin-进行输入"><a href="#27-4-使用std-cin-进行输入" class="headerlink" title="27.4   使用std::cin 进行输入"></a>27.4   使用std::cin 进行输入</h2><p><strong>27.4.1   使用std::cin 将输入读取到基本类型变量中</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单27.4  使用cin将输入读取到int变量中，将使用科学表示法的浮点数读取到double变量中，将三个字符分别读取到char变量中 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter an integer: &quot;</span>;</span><br><span class="line">	<span class="type">int</span> inputNum = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; inputNum;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter the value of Pi: &quot;</span>;</span><br><span class="line">	<span class="type">double</span>  Pi = <span class="number">0.0</span>;</span><br><span class="line">	cin &gt;&gt; Pi;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter three characters separated by space: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="type">char</span> char1, char2, char3;</span><br><span class="line">	cin &gt;&gt; char1 &gt;&gt; char2 &gt;&gt; char3;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The recorded variable values are: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;inputNum: &quot;</span> &lt;&lt; inputNum &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Pi: &quot;</span> &lt;&lt; Pi &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;The three characters: &quot;</span> &lt;&lt; char1 &lt;&lt; char2 &lt;&lt; char3 &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>27.4.2   使用std::cin:get 将输入读取到char*缓冲区中</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单27.5  插入到char缓冲区中时不超越其边界</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter a line: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="type">char</span> charBuf[<span class="number">10</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	cin.<span class="built_in">get</span>(charBuf, <span class="number">9</span>);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;charBuf: &quot;</span> &lt;&lt; charBuf &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>27.4.3   使用std::cin 将输入读取到std::string 中</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单27.6  使用cin将文本插入到std::string中</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter your name: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	string name;</span><br><span class="line">	cin &gt;&gt; name;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Hi &quot;</span> &lt;&lt; name &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单27.7  使用getline( )和 cin 读取整行用户输入</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter your name: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	string name;</span><br><span class="line">	<span class="built_in">getline</span>(cin,name);</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Hi &quot;</span> &lt;&lt; name &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="27-5-使用std-fstream-处理文件"><a href="#27-5-使用std-fstream-处理文件" class="headerlink" title="27.5   使用std::fstream 处理文件"></a>27.5   使用std::fstream 处理文件</h2><p>​	<strong>C++提供了std::fstream，旨在以独立于平台的方式访问文件。std::fstream从std::ofstream那里继承 了写入文件的功能，并从std::ifstream那里继承了读取文件的功能。</strong></p>
<p><strong>27.5.1   使用open( )和 close( )打开和关闭文件</strong></p>
<ul>
<li>要使用fstream、ofstream 或 ifstream 类，需要使用方法open( )打开文件。open( )接受两个参数：第一个是要打开的文件的路径和名称（如果没有提供路径，将假定为应用 程序的当前目录设置）；第二个是文件的打开模式</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">fstream myFile; </span><br><span class="line">myFile.<span class="built_in">open</span>(<span class="string">&quot;HelloFile.txt&quot;</span>,ios_base::in|ios_base::out|ios_base::trunc); </span><br><span class="line"><span class="keyword">if</span> (myFile.<span class="built_in">is_open</span>()) <span class="comment">// check if open() succeeded </span></span><br><span class="line">&#123; </span><br><span class="line">   <span class="comment">// do reading or writing here </span></span><br><span class="line">   myFile.<span class="built_in">close</span>(); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>还有另一种打开文件流的方式，那就是使用构造函数</p>
<p><code> fstream myFile(&quot;HelloFile.txt&quot;,ios_base::in|ios_base::out|ios_base::trunc);</code></p>
</li>
<li><p>如果只想打开文件进行写入，可使用如下代码</p>
<p><code>ofstream myFile(&quot;HelloFile.txt&quot;, ios_base::out);</code></p>
</li>
<li><p>如果只想打开文件进行读取，可使用如下代码</p>
<p><code>ifstream myFile(&quot;HelloFile.txt&quot;, ios_base::in);</code></p>
</li>
</ul>
<p>可在下述各种模式下打开文件流</p>
<ul>
<li>ios_base::app：附加到现有文件末尾，而不是覆盖它</li>
<li>ios_base::ate：切换到文件末尾，但可在文件的任何地方写入数据</li>
<li>ios_base::trunc：导致现有文件被覆盖，这是默认设置</li>
<li>ios_base::binary：创建二进制文件（默认为文本文件）</li>
<li>ios_base::in：以只读方式打开文件</li>
<li>ios_base::out：以只写方式打开文件</li>
</ul>
<p><strong>27.5.2   使用open( )创建文本文件并使用运算符&lt;&lt;写入文本</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单27.8  使用ofstream新建一个文本文件并向其中写入文本</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ofstream myFile;</span><br><span class="line">	myFile.<span class="built_in">open</span>(<span class="string">&quot;./test.txt&quot;</span>, ios_base::out);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (myFile.<span class="built_in">is_open</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;File open successful&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">		myFile &lt;&lt; <span class="string">&quot;My first text file!&quot;</span> &lt;&lt; endl;</span><br><span class="line">		myFile &lt;&lt; <span class="string">&quot;Hello file&quot;</span>;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Finished writing to file, will close now&quot;</span> &lt;&lt; endl;</span><br><span class="line">		myFile.<span class="built_in">close</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>27.5.3   使用open( )和运算符&gt;&gt;读取文本文件</strong></p>
<p>​	要读取文件，可使用fstream或ifstream，并使用标志ios_base::in打开它</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单27.9  从程序清单27.8创建的文件HelloFile.txt中读取文本</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ifstream myFile;</span><br><span class="line">	myFile.<span class="built_in">open</span>(<span class="string">&quot;./test.txt&quot;</span>, ios_base::in);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (myFile.<span class="built_in">is_open</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;File open successful. It contains: &quot;</span> &lt;&lt; endl;</span><br><span class="line">		string fileContents;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (myFile.<span class="built_in">good</span>()) &#123;</span><br><span class="line">			<span class="built_in">getline</span>(myFile, fileContents);</span><br><span class="line">			cout &lt;&lt; fileContents &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Finished reading file, will close now&quot;</span> &lt;&lt; endl;</span><br><span class="line">		myFile.<span class="built_in">close</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;open() failed: check if file is in right folder&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;<span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	ifstream myFile;</span><br><span class="line">	myFile.<span class="built_in">open</span>(<span class="string">&quot;./test.txt&quot;</span>, ios_base::in);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (myFile.<span class="built_in">is_open</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;File open successful. It contains: &quot;</span> &lt;&lt; endl;</span><br><span class="line">		string fileContents;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">while</span> (myFile.<span class="built_in">good</span>()) &#123;</span><br><span class="line">			<span class="built_in">getline</span>(myFile, fileContents);</span><br><span class="line">			cout &lt;&lt; fileContents &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Finished reading file, will close now&quot;</span> &lt;&lt; endl;</span><br><span class="line">		myFile.<span class="built_in">close</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;open() failed: check if file is in right folder&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="27-5-4-读写二进制文件"><a href="#27-5-4-读写二进制文件" class="headerlink" title="27.5.4   读写二进制文件"></a>27.5.4   读写二进制文件</h2><p>​	写入二进制文件的流程与前面介绍的流程差别不大，重要的是在打开文件时使用 ios_base::binary 标志。通常使用ofstream::write 和ifstream::read 来读写二进制文件</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单27.10  将一个结构写入二进制文件并使用该文件的内容创建一个结构</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Human</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">char</span> name[<span class="number">30</span>];</span><br><span class="line">	<span class="type">int</span> age;</span><br><span class="line">	<span class="type">char</span> DOB[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line">	<span class="built_in">Human</span>() &#123;&#125;;</span><br><span class="line">	<span class="built_in">Human</span>(<span class="type">const</span> <span class="type">char</span>* inName, <span class="type">int</span> inAge, <span class="type">const</span> <span class="type">char</span>* inDOB) : <span class="built_in">age</span>(inAge)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">strcpy</span>(name, inName);</span><br><span class="line">		<span class="built_in">strcpy</span>(DOB, inDOB);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Human <span class="title">Input</span><span class="params">(<span class="string">&quot;Siddhartha Rao&quot;</span>, <span class="number">101</span>, <span class="string">&quot;May 1916&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">ofstream <span class="title">fsOut</span><span class="params">(<span class="string">&quot;./MyBinary.bin&quot;</span>, ios_base::out | ios_base::binary)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (fsOut.<span class="built_in">is_open</span>()) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Writing one object of Human to a binary file&quot;</span> &lt;&lt; endl;</span><br><span class="line">		fsOut.<span class="built_in">write</span>(<span class="built_in">reinterpret_cast</span>&lt;<span class="type">const</span> <span class="type">char</span>*&gt;(&amp;Input), <span class="built_in">sizeof</span>(Input));</span><br><span class="line">		fsOut.<span class="built_in">close</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function">ifstream <span class="title">fsIn</span><span class="params">(<span class="string">&quot;./MyBinary.bin&quot;</span>, ios_base::in | ios_base::binary)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (fsIn.<span class="built_in">is_open</span>()) &#123;</span><br><span class="line">		Human somePerson;</span><br><span class="line">		fsIn.<span class="built_in">read</span>((<span class="type">char</span>*)&amp;somePerson, <span class="built_in">sizeof</span>(somePerson));</span><br><span class="line"></span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Reading information from binary file: &quot;</span> &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Name = &quot;</span> &lt;&lt; somePerson.name &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Age = &quot;</span> &lt;&lt; somePerson.age &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Date of Birth = &quot;</span> &lt;&lt; somePerson.DOB &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="27-6-使用std-stringstream-对字符串进行转换"><a href="#27-6-使用std-stringstream-对字符串进行转换" class="headerlink" title="27.6   使用std::stringstream 对字符串进行转换"></a>27.6   使用std::stringstream 对字符串进行转换</h2><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单27.11  使用std::stringstream 在整型和字符串之间进行转换 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter an integer: &quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="type">int</span> input = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; input;</span><br><span class="line"></span><br><span class="line">	stringstream converterStream;</span><br><span class="line">	converterStream &lt;&lt; input;</span><br><span class="line">	string inputAsStr;</span><br><span class="line">	converterStream &gt;&gt; inputAsStr;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Integer Input = &quot;</span> &lt;&lt; input &lt;&lt; endl;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;String gained from integer = &quot;</span> &lt;&lt; inputAsStr &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	stringstream anotherStream;</span><br><span class="line">	anotherStream &lt;&lt; inputAsStr;</span><br><span class="line">	<span class="type">int</span> Copy = <span class="number">0</span>;</span><br><span class="line">	anotherStream &gt;&gt; Copy;</span><br><span class="line"></span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Integer gained from string, Copy = &quot;</span> &lt;&lt; Copy &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="27-9-作业"><a href="#27-9-作业" class="headerlink" title="27.9   作业"></a>27.9   作业</h2><p><strong>27.9.1   测验</strong></p>
<ol>
<li><p><strong>在只需写入文件的情况下，应使用哪种流?</strong></p>
<p><strong>答</strong>：ofstream</p>
</li>
<li><p><strong>如何使用cin从输入流中获取一整行?</strong>  </p>
<p><strong>答</strong>：使用cin.getline;</p>
</li>
<li><p><strong>在需要将std::string 对象写入文件时，应使用ios_base::binary 模式吗？</strong> </p>
<p><strong>答</strong>： 不应该，string包含文本信息，</p>
</li>
<li><p><strong>使用open( )打开流后，为何还要使用is_open( )进行检查？</strong></p>
<p><strong>答</strong>：检测文件是否正确打开</p>
</li>
</ol>
<p><strong>27.9.2   练习</strong></p>
<ol>
<li><p><strong>查错：找出下述代码中的错误</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">fstream myFile; </span><br><span class="line">myFile.<span class="built_in">open</span>(<span class="string">&quot;HelloFile.txt&quot;</span>, ios_base::out); </span><br><span class="line">myFile &lt;&lt; <span class="string">&quot;Hello file!&quot;</span>; </span><br><span class="line">myFile.<span class="built_in">close</span>();</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：没有检测文件是否正确打开</p>
</li>
<li><p><strong>查错：找出下述代码中的错误</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ifstream <span class="title">myFile</span><span class="params">(<span class="string">&quot;SomeFile.txt&quot;</span>)</span></span>; </span><br><span class="line"><span class="keyword">if</span>(myFile.<span class="built_in">is_open</span>()) </span><br><span class="line">&#123; </span><br><span class="line">   myFile &lt;&lt; <span class="string">&quot;This is some text&quot;</span> &lt;&lt; endl; </span><br><span class="line">   myFile.<span class="built_in">close</span>(); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>：写入应该使用ofstream</p>
</li>
</ol>
<h1 id="第二十八章"><a href="#第二十八章" class="headerlink" title="第二十八章"></a>第二十八章</h1><h2 id="28-2-导致异常的原因"><a href="#28-2-导致异常的原因" class="headerlink" title="28.2   导致异常的原因"></a>28.2   导致异常的原因</h2><p>​	<strong>异常可能是外部因素导致的，如系统没有足够的内存；也可能是应用程序内部因素导致的，如使 用的指针包含无效值或除数为零。为了向调用者指出错误，有些模块引发异常。</strong></p>
<h2 id="28-3-使用try和catch捕获异常"><a href="#28-3-使用try和catch捕获异常" class="headerlink" title="28.3   使用try和catch捕获异常"></a>28.3   使用try和catch捕获异常</h2><p><strong>28.3.1   使用catch(…)处理所有异常</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单28.1  使用try和catch捕获并处理内存分配异常</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter number of integers you wish to reserve: &quot;</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="type">int</span> input = <span class="number">0</span>;</span><br><span class="line">		cin &gt;&gt; input;</span><br><span class="line"></span><br><span class="line">		<span class="type">int</span>* numArray = <span class="keyword">new</span> <span class="type">int</span>[input];</span><br><span class="line">		<span class="keyword">delete</span>[] numArray;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (...) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Exception occurred. Got to end, sorry!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>28.3.2   捕获特定类型的异常</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单28.2  使用try和catch捕获并处理内存分配异常 </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;exception&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter number of integers you wish to reserve: &quot;</span>;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="type">int</span> input = <span class="number">0</span>;</span><br><span class="line">		cin &gt;&gt; input;</span><br><span class="line"></span><br><span class="line">		<span class="type">int</span>* numArray = <span class="keyword">new</span> <span class="type">int</span>[input];</span><br><span class="line">		<span class="keyword">delete</span>[] numArray;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (bad_alloc&amp; exp) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Exception occurred.: &quot;</span> &lt;&lt; exp.<span class="built_in">what</span>() &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Got to end, sorry!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>28.3.3   使用throw引发特定类型的异常</strong></p>
<p>​	<strong>程序清单28.2捕获std::bad_alloc 时，实际上是捕获new引发的std::bad_alloc类对象。您可以引发 自己选择的异常，为此只需使用关键字throw</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单28.3  在试图除以零时引发一种自定义异常</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;exception&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Divide</span><span class="params">(<span class="type">double</span> dividend, <span class="type">double</span> divisor)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (divisor == <span class="number">0</span>) <span class="keyword">throw</span> <span class="string">&quot;Dividing by 0 is a cirme&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> (dividend / divisor);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter dividend: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> dividend = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; dividend;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter divisor: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> divisor = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; divisor;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Result is: &quot;</span> &lt;&lt; <span class="built_in">Divide</span>(dividend, divisor) &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (<span class="type">const</span> <span class="type">char</span>* exp) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Exception: &quot;</span> &lt;&lt; exp &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Sorry, can&#x27;t continue!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="28-4-异常处理的工作原理"><a href="#28-4-异常处理的工作原理" class="headerlink" title="28.4   异常处理的工作原理"></a>28.4   异常处理的工作原理</h2><p>​	<em><em>理程序catch(char</em>)捕获它。  每当您使用throw 引发异常时，编译器都将查找能够处理该异常的 catch(Type)。异常处理逻辑首 先检查引发异常的代码是否包含在try块中，如果是，则查找可处理这种异常的catch(Type)。如果throw 语句不在try块内，或者没有与引发的异常兼容的catch( )，异常处理逻辑将继续在调用函数中寻找。 因此，异常处理逻辑沿调用栈向上逐个地在调用函数中寻找，直到找到可处理异常的 catch(Type)。在 退栈过程的每一步中，都将销毁当前函数的局部变量，因此这些局部变量的销毁顺序与创建顺序相反</em>*</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;exception&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">StructA</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">StructA</span>() &#123; cout &lt;&lt; <span class="string">&quot;StructA constructor&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">	~<span class="built_in">StructA</span>() &#123; cout &lt;&lt; <span class="string">&quot;StructA destructor&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">StructB</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">StructB</span>() &#123; cout &lt;&lt; <span class="string">&quot;StructB constructor&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">	~<span class="built_in">StructB</span>() &#123; cout &lt;&lt; <span class="string">&quot;StructB destructor&quot;</span> &lt;&lt; endl; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FuncB</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;In Func B&quot;</span> &lt;&lt; endl;</span><br><span class="line">	StructA objA;</span><br><span class="line">	StructB objB;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;FuncA: returning to caller&quot;</span> &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">throw</span> <span class="string">&quot;Throwing for the heck of it&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">FuncA</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;In Func A&quot;</span> &lt;&lt; endl;</span><br><span class="line">		StructA objA;</span><br><span class="line">		StructB objB;</span><br><span class="line">		<span class="built_in">FuncB</span>();</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;FuncA: returning to caller&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (<span class="type">const</span> <span class="type">char</span>* exp) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;FuncA: Caught exception: &quot;</span> &lt;&lt; exp &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Handled it, will not throw to caller&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;main() : Started execution &quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="built_in">FuncA</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (<span class="type">const</span> <span class="type">char</span>* exp) &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Exception: &quot;</span> &lt;&lt; exp &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;main(): exiting gracefully&quot;</span> &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>28.4.1  std::exception 类</strong></p>
<p>​	<strong>下述重要异常类都是从std::exception派生而来的</strong></p>
<ul>
<li>bad_alloc：使用 new 请求内存失败时引发</li>
<li>bad_cast：试图使用 dynamic_cast 转换错误类型（没有继承关系的类型）时引发</li>
<li>ios_base::failure：由 iostream 库中的函数和方法引发</li>
</ul>
<p>std::exception 类是异常基类，它定义了虚方法what( )；这个方法很有用且非常重要，详细地描述 了导致异常的原因</p>
<p><strong>28.4.2   从std::exception 派生出自定义异常类</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//程序清单28.5  继承std::exception 的 CustomException 类</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;exception&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CustomException</span> : <span class="keyword">public</span> exception</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">CustomException</span>(<span class="type">const</span> <span class="type">char</span>* why) :reason&#123; why &#125; &#123;&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="type">const</span> <span class="type">char</span>* <span class="title">what</span><span class="params">()</span> <span class="type">const</span> </span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> reason.<span class="built_in">c_str</span>();</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	string reason;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">double</span> <span class="title">Divide</span><span class="params">(<span class="type">double</span> dividend, <span class="type">double</span> divisor)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (divisor == <span class="number">0</span>) <span class="keyword">throw</span> <span class="built_in">CustomException</span>(<span class="string">&quot;CustomException: Dividing by 0 is a crime&quot;</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> (dividend / divisor);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter dividend: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> dividend = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; dividend;</span><br><span class="line">	cout &lt;&lt; <span class="string">&quot;Enter divisor: &quot;</span>;</span><br><span class="line">	<span class="type">double</span> divisor = <span class="number">0</span>;</span><br><span class="line">	cin &gt;&gt; divisor;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Result is: &quot;</span> &lt;&lt; <span class="built_in">Divide</span>(dividend, divisor) &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (exception&amp; exp) &#123;</span><br><span class="line">		cout &lt;&lt; exp.<span class="built_in">what</span>() &lt;&lt; endl;</span><br><span class="line">		cout &lt;&lt; <span class="string">&quot;Sorry, can&#x27;t continue!&quot;</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="28-7-作业"><a href="#28-7-作业" class="headerlink" title="28.7   作业"></a>28.7   作业</h2><p>**28.7.2   练习 **</p>
<ol>
<li><p><strong>std::exception 是什么?</strong></p>
<p><strong>答</strong>：是所有异常类的基类</p>
</li>
<li><p><strong>使用new分配内存失败时，将引发哪种异常?</strong></p>
<p><strong>答</strong>：bad_alloc</p>
</li>
<li><p><strong>在异常处理程序（catch块）中，为大量int变量分配内存以便备份数据合适吗？</strong>  </p>
<p><strong>答</strong>：不合适,避免资源消耗或复杂操作</p>
</li>
<li><p><strong>假设有一个异常类MyException，它继承了std::exception，您将如何捕获这种异常对象？</strong></p>
<p><strong>答</strong>：使用catch(exception &amp;exp)进行捕获</p>
</li>
</ol>
<p>**28.7.2   练习 **</p>
<ol>
<li><p><strong>查错：下述代码有何错误</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">SomeIntelligentStuff</span> </span><br><span class="line">&#123; </span><br><span class="line">   <span class="type">bool</span> isStuffGoneBad; </span><br><span class="line"><span class="keyword">public</span>: </span><br><span class="line">   ~<span class="built_in">SomeIntelligentStuff</span>() </span><br><span class="line">   &#123; </span><br><span class="line">      <span class="keyword">if</span>(isStuffGoneBad) </span><br><span class="line">         <span class="keyword">throw</span> <span class="string">&quot;Big problem in this class, just FYI&quot;</span>; </span><br><span class="line">   &#125; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>:不要在析构函数中引发异常</p>
</li>
<li><p><strong>查错：下述代码有何错误</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">   <span class="type">int</span>* millionNums = <span class="keyword">new</span> <span class="type">int</span> [<span class="number">1000000</span>]; </span><br><span class="line">   <span class="comment">// do something with the million integers </span></span><br><span class="line">   <span class="keyword">delete</span> []millionNums; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>:没有处理可能引发异常的代码</p>
</li>
<li><p><strong>查错：下述代码有何错误</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">   <span class="keyword">try</span> </span><br><span class="line">   &#123; </span><br><span class="line">      <span class="type">int</span>* millionNums = <span class="keyword">new</span> <span class="type">int</span> [<span class="number">1000000</span>]; </span><br><span class="line">      <span class="comment">// do something with the million integers </span></span><br><span class="line">      <span class="keyword">delete</span> []millionNums; </span><br><span class="line">   &#125; </span><br><span class="line">   <span class="built_in">catch</span>(exception&amp; exp) </span><br><span class="line">   &#123; </span><br><span class="line">      <span class="type">int</span>* anotherMillion = <span class="keyword">new</span> <span class="type">int</span> [<span class="number">1000000</span>]; </span><br><span class="line">      <span class="comment">// take back up of millionNums and save it to disk </span></span><br><span class="line">   &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>答</strong>:不要在catch中分配内存，如果try块内的代码分配内存失败将导致恶性循环</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/12/22/21%E5%A4%A9%E5%AD%A6%E9%80%9AC-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" data-id="cm662pqka0001ague4uz3fsmz" data-title="21天学通C++学习笔记" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/C/" rel="tag">C++</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-QT" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/12/05/QT/" class="article-date">
  <time class="dt-published" datetime="2024-12-04T16:08:37.000Z" itemprop="datePublished">2024-12-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/12/05/QT/">QT</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="知识点1：-Qt概述"><a href="#知识点1：-Qt概述" class="headerlink" title="知识点1： Qt概述"></a>知识点1： Qt概述</h1><p><strong>1.概念</strong></p>
<p>Qt是一个跨平台的C++图形用户界面应用程序框架。</p>
<p>常见GUI:</p>
<pre><code>Qt: 支持多平台开发；支持CSS；面向对象特性突出；发展趋势良好。

MFC: 仅在windows平台开发；程序运行效率高；库安全性好
</code></pre>
<p><strong>2.支持平台</strong></p>
<pre><code>unix/linux

macos

windows

嵌入式平台
</code></pre>
<p><strong>3.优点</strong></p>
<ul>
<li>跨平台，几乎支持所有平台</li>
<li>接口简单，容易上手，</li>
<li>一定程度上简化了内存回收机制</li>
<li>开发效率高</li>
<li>有很好的社区氛围</li>
<li>可以进行嵌入式开发</li>
</ul>
<h1 id="知识点2：了解QtCreator"><a href="#知识点2：了解QtCreator" class="headerlink" title="知识点2：了解QtCreator"></a>知识点2：了解QtCreator</h1><p><strong>1.Qt和QtCreator的区别</strong></p>
<pre><code>Qt:通俗来说，开发工具包。

QtCreator:集成的编译器，Qt的桌面环境。
</code></pre>
<p><strong>2.QtCreator主界面：</strong></p>
<ul>
<li>欢迎选项：<ul>
<li>工程：创建工程 + 工程打开</li>
<li>示例：demo程序，下载运行研读程序</li>
<li>教程：需要连接外网查看</li>
</ul>
</li>
<li>编辑选项：<ul>
<li>编辑项目文件</li>
</ul>
</li>
<li>设计选项：<ul>
<li>设计ui</li>
</ul>
</li>
<li>debug选项：<ul>
<li>调试</li>
</ul>
</li>
<li>帮助选项：<ul>
<li>查看官方文档</li>
</ul>
</li>
</ul>
<p><img src="https://www.helloimg.com/i/2024/12/04/674fb9cb46a85.png"></p>
<h1 id="知识点3：创建第一个Qt项目"><a href="#知识点3：创建第一个Qt项目" class="headerlink" title="知识点3：创建第一个Qt项目"></a>知识点3：创建第一个Qt项目</h1><p><strong>1.创建项目</strong></p>
<ul>
<li>方式1：欢迎  —&gt; project —&gt; new project。</li>
<li>方式2：菜单栏 —&gt;  文件 —&gt; 新建文件或项目</li>
</ul>
<p><strong>2. 打开工程</strong></p>
<ul>
<li>方式1：欢迎  —&gt; project —&gt; open project。</li>
<li>方式2：菜单栏 —&gt;  文件 —&gt; 打开文件或项目</li>
</ul>
<p><strong>3.注意事项</strong></p>
<ol>
<li>项目名称不要有中文和特殊符号</li>
<li>项目路径不要出现中文</li>
</ol>
<h1 id="知识点4：Qt项目框架及文件介绍"><a href="#知识点4：Qt项目框架及文件介绍" class="headerlink" title="知识点4：Qt项目框架及文件介绍"></a>知识点4：Qt项目框架及文件介绍</h1><p><img src="https://www.helloimg.com/i/2024/12/04/674fc0f9058ce.png"></p>
<p><strong>QT_review.pro</strong></p>
<pre><code>工程文件，是qmake自动生成的用于生成makefile文件的配置
</code></pre>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">QT       += core gui <span class="comment">//包含的模块</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">greaterThan</span>(QT_MAJOR_VERSION, <span class="number">4</span>): QT += widgets <span class="comment">//大于QT4版本才包含此模块</span></span><br><span class="line"></span><br><span class="line">CONFIG += c+<span class="number">+11</span></span><br><span class="line"></span><br><span class="line">DEFINES += QT_DEPRECATED_WARNINGS</span><br><span class="line"> </span><br><span class="line">SOURCES += \ <span class="comment">//源文件</span></span><br><span class="line">    main.cpp \</span><br><span class="line">    widget.cpp</span><br><span class="line"></span><br><span class="line">HEADERS += \ <span class="comment">//头文件</span></span><br><span class="line">    widget.h</span><br><span class="line"></span><br><span class="line">qnx: target.path = /tmp/$$&#123;TARGET&#125;/bin</span><br><span class="line"><span class="keyword">else</span>: unix:!android: target.path = /opt/$$&#123;TARGET&#125;/bin</span><br><span class="line">!<span class="built_in">isEmpty</span>(target.path): INSTALLS += target</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>widget.h</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">ifndef</span> WIDGET_H</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> WIDGET_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QWidget&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Widget</span> : <span class="keyword">public</span> QWidget</span><br><span class="line">&#123;</span><br><span class="line">    Q_OBJECT</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">Widget</span>(QWidget *parent = <span class="literal">nullptr</span>);</span><br><span class="line">    ~<span class="built_in">Widget</span>();</span><br><span class="line">&#125;;</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// WIDGET_H</span></span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>main.cpp</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span> <span class="comment">//Qt中的一个类对应一个头文件，类名就是头文件名</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;QApplication&gt;</span> <span class="comment">//Qt系统提供的标准头文件</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> *argv[])</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="function">QApplication <span class="title">a</span><span class="params">(argc, argv)</span></span>; <span class="comment">//应用程序类（整个后台管理的命脉，处理应用程序的初始化和结束，事件处理调度，不管有多少个窗口，一个QApplication类就可）</span></span><br><span class="line">    Widget w; <span class="comment">//实例化对象，调用构造函数</span></span><br><span class="line">    w.<span class="built_in">show</span>(); <span class="comment">//显示图形界面</span></span><br><span class="line">    <span class="keyword">return</span> a.<span class="built_in">exec</span>();<span class="comment">//主事件循环，在exec函数中，Qt接受并处理用户和系统的时间并且将他们传递给合适的窗口控件</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<p><strong>widget.cpp</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;widget.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">Widget::<span class="built_in">Widget</span>(QWidget *parent)</span><br><span class="line">    : <span class="built_in">QWidget</span>(parent)</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Widget::~<span class="built_in">Widget</span>()</span><br><span class="line">&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="知识点5：确定代码书写的位置"><a href="#知识点5：确定代码书写的位置" class="headerlink" title="知识点5：确定代码书写的位置"></a>知识点5：确定代码书写的位置</h1><p><strong>.pro</strong>：文件用于生成可执行文件</p>
<p><strong>main.cpp</strong>：主函数</p>
<p><strong>widget.cpp</strong>：类的函数</p>
<ul>
<li>一般情况，窗口的属性和添加控件的操作都会在类的构造函数中书写</li>
<li>优点：可以让主程序中无多余的代码，程序阅读也方便</li>
</ul>
<p><strong>widget.h</strong>：类和头文件</p>
<h1 id="知识点6：设置窗口属性"><a href="#知识点6：设置窗口属性" class="headerlink" title="知识点6：设置窗口属性"></a>知识点6：设置窗口属性</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//修改窗口标题</span></span><br><span class="line">   <span class="keyword">this</span>-&gt;<span class="built_in">setWindowTitle</span>(<span class="string">&quot;第一个窗口&quot;</span>);</span><br><span class="line">   <span class="comment">//设置窗口大小，可拉伸</span></span><br><span class="line">   <span class="comment">//this-&gt;resize(800,600);</span></span><br><span class="line">   <span class="comment">//设置窗口大小，不可拉伸</span></span><br><span class="line">   <span class="keyword">this</span>-&gt;<span class="built_in">setFixedSize</span>(<span class="number">800</span>,<span class="number">600</span>);</span><br></pre></td></tr></table></figure>

<h1 id="知识点7：创建第一个按钮"><a href="#知识点7：创建第一个按钮" class="headerlink" title="知识点7：创建第一个按钮"></a>知识点7：创建第一个按钮</h1><p><strong>步骤1</strong>：包含头文件<code>#include&lt;QPushButton&gt;</code></p>
<p><strong>步骤2</strong>：调用构造函数创建按钮</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//方式一</span></span><br><span class="line">QPushButton *btn1 = <span class="keyword">new</span> QPushButton;</span><br><span class="line"><span class="comment">//方式二，直接在创建时绑定父类</span></span><br><span class="line">QPushButton *btn = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;按钮&quot;</span>，<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure>

<p><strong>步骤3</strong>：显示按钮</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">//方法一，显示方式是另一个窗口显示按钮</span></span><br><span class="line">btn-&gt;<span class="built_in">show</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法2，设置按钮的父对象为窗口，这样按钮就在窗口上显示了</span></span><br><span class="line">btn-&gt;<span class="built_in">setParent</span>(<span class="keyword">this</span>);</span><br></pre></td></tr></table></figure>

<h1 id="知识点8：按钮的属性"><a href="#知识点8：按钮的属性" class="headerlink" title="知识点8：按钮的属性"></a>知识点8：按钮的属性</h1><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//设置按钮内容</span></span><br><span class="line">   btn-&gt;<span class="built_in">setText</span>(<span class="string">&quot;按钮1&quot;</span>);</span><br><span class="line">   <span class="comment">//设置按钮位置</span></span><br><span class="line">   btn-&gt;<span class="built_in">move</span>(<span class="number">100</span>,<span class="number">100</span>);</span><br><span class="line">   <span class="comment">//设置按钮大小</span></span><br><span class="line">   btn-&gt;<span class="built_in">resize</span>(<span class="number">100</span>,<span class="number">50</span>);</span><br></pre></td></tr></table></figure>

<h1 id="知识点9：对象数（对象模型）"><a href="#知识点9：对象数（对象模型）" class="headerlink" title="知识点9：对象数（对象模型）"></a>知识点9：对象数（对象模型）</h1><p><strong>概念</strong>：Qt对象间的父子关系</p>
<p><strong>解决问题</strong>：在一定程度上解决了内存问题，简化了回收机制</p>
<h1 id="知识点10：信号和槽"><a href="#知识点10：信号和槽" class="headerlink" title="知识点10：信号和槽"></a>知识点10：信号和槽</h1><p><img src="https://www.helloimg.com/i/2024/12/04/674fef3e2988b.png"></p>
<p><strong>优点</strong>：松散耦合，信号发出端和接收端可以毫无关联，如果关联就用connect函数</p>
<h1 id="知识点11：connect函数的使用"><a href="#知识点11：connect函数的使用" class="headerlink" title="知识点11：connect函数的使用"></a>知识点11：connect函数的使用</h1> <figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">connect</span>(sender,signal,receiver,slot);</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>函数参数</strong></p>
<ol>
<li>sender：信号发出者</li>
<li>signal：信号</li>
<li>receiver：信号接收者</li>
<li>slot：接收到信号执行任务（槽函数）</li>
</ol>
<p><strong>举例</strong></p>
<pre><code>点击窗口按钮关闭窗口
</code></pre>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">QPushButton *btn = <span class="keyword">new</span> <span class="built_in">QPushButton</span>(<span class="string">&quot;关闭窗口&quot;</span>,<span class="keyword">this</span>); <span class="comment">//创建按钮</span></span><br><span class="line">   btn-&gt;<span class="built_in">move</span>(<span class="number">100</span>,<span class="number">100</span>); <span class="comment">//设置按钮位置</span></span><br><span class="line">   btn-&gt;<span class="built_in">resize</span>(<span class="number">100</span>,<span class="number">100</span>); <span class="comment">//设置按钮大小</span></span><br><span class="line">   <span class="built_in">connect</span>(btn,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;Widget::close);</span><br></pre></td></tr></table></figure>

<h1 id="知识点12：自定义信号槽"><a href="#知识点12：自定义信号槽" class="headerlink" title="知识点12：自定义信号槽"></a>知识点12：自定义信号槽</h1><p><strong>步骤1</strong>：确定场景</p>
<pre><code>交通灯绿，汽车启动
</code></pre>
<p><strong>步骤2</strong>：添加交通灯类和汽车类</p>
<p><strong>步骤3</strong>：在交通灯类中声明信号，在汽车类中声明并实现槽函数</p>
<p><strong>Lamp.h</strong>(信号：一般在signals里面写，返回值为void,参数可以存在，仅需要声明不要实现，可以重载)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">signals:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">TurnGrenn</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>Car.h</strong>(槽函数：一般在public slots里面写，对于一些高版本的Qt来说，也可以写道public或者全局；返回值为void,参数可以存在需要声明和实现，可以重载)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">	<span class="function"><span class="type">void</span> <span class="title">Driving</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>

<p><strong>Car.cpp</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Car::Driving</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">qDebug</span>() &lt;&lt; <span class="string">&quot;启动&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>步骤4</strong>：连接</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">connect</span>(lamp,&amp;Lamp::TurnGreen,car,&amp;Car::Driving);	</span><br></pre></td></tr></table></figure>



<p><strong>步骤5</strong>：触发信号</p>
<p><strong>widget.h</strong>(声明触发信号的成员函数)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">void Observer();</span><br></pre></td></tr></table></figure>

<p><strong>widget.cpp</strong>(定义触发信号的成员函数+调用该成员函数)</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">Widget::Observer</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    emit car-&gt;<span class="built_in">Driving</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="知识点13：用信号连接信号"><a href="#知识点13：用信号连接信号" class="headerlink" title="知识点13：用信号连接信号"></a>知识点13：用信号连接信号</h1><p><strong>用按钮触发Observer来触发lamp的TurnGreen</strong></p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">connect</span>(btn,&amp;QPushButton::clicked,<span class="keyword">this</span>,&amp;Widget::Observer);</span><br><span class="line"><span class="built_in">connect</span>(lamp,&amp;Lamp::TurnGreen,car,&amp;Car::Driving);	</span><br></pre></td></tr></table></figure>

<h1 id="知识点14：重载自定义信号与槽"><a href="#知识点14：重载自定义信号与槽" class="headerlink" title="知识点14：重载自定义信号与槽"></a>知识点14：重载自定义信号与槽</h1><p><strong>步骤1</strong>：重新写信号声明（带参数）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">signals:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">TurnGreen</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">TurnGreen</span><span class="params">(QString)</span></span>;</span><br></pre></td></tr></table></figure>



<p><strong>步骤2</strong>：重新写槽函数声明及定义（带参数）</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> slots:</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Driving</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">Driving</span><span class="params">(QString str)</span></span>;</span><br></pre></td></tr></table></figure>



<p><strong>步骤3</strong>：由于函数被重载，需要使用函数指针绑定在连接</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">void</span> (Lamp::*ptr1)(QString) = &amp;Lamp::TurnGreen;</span><br><span class="line">   <span class="built_in">void</span> (Car::*ptr2)(QString) = &amp;Car::Driving;</span><br><span class="line">   <span class="built_in">connect</span>(lamp,ptr1,car,ptr2);</span><br></pre></td></tr></table></figure>

<h1 id="知识点15：lambda表达式"><a href="#知识点15：lambda表达式" class="headerlink" title="知识点15：lambda表达式"></a>知识点15：lambda表达式</h1><p><strong>概念</strong>：c++11中的lambda表达式用于定义并创建匿名的函数对象。</p>
<p><strong>语法</strong>：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[capture](parameters)<span class="keyword">mutable</span> -&gt; <span class="keyword">return</span>-type</span><br><span class="line">&#123;</span><br><span class="line">    statement</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/12/05/QT/" data-id="cm662pqk40000ague9xhc6dg9" data-title="QT" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-hello-world" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/12/04/hello-world/" class="article-date">
  <time class="dt-published" datetime="2024-12-04T15:39:25.786Z" itemprop="datePublished">2024-12-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/12/04/hello-world/">Hello World</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Welcome to <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a target="_blank" rel="noopener" href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a target="_blank" rel="noopener" href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a target="_blank" rel="noopener" href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a target="_blank" rel="noopener" href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/12/04/hello-world/" data-id="cm662pqkd0002ague8k9mey3g" data-title="Hello World" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
    </footer>
  </div>
  
</article>



  


</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C/" rel="tag">C++</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/C/" style="font-size: 10px;">C++</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/12/">December 2024</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/12/22/21%E5%A4%A9%E5%AD%A6%E9%80%9AC-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">21天学通C++学习笔记</a>
          </li>
        
          <li>
            <a href="/2024/12/05/QT/">QT</a>
          </li>
        
          <li>
            <a href="/2024/12/04/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2025 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>